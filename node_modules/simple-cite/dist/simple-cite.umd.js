!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t["simple-cite"]=e()}(this,function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var u,d=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),i={}.hasOwnProperty,l=function(t,e){return i.call(t,e)},e={}.toString,o=function(t){return e.call(t).slice(8,-1)},p=function(t){return"object"==typeof t?null!==t:"function"==typeof t},a=function(t){if(!p(t))throw TypeError(t+" is not an object!");return t},g=function(s,r,t){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(s),void 0===r)return s;switch(t){case 1:return function(t){return s.call(r,t)};case 2:return function(t,e){return s.call(r,t,e)};case 3:return function(t,e,i){return s.call(r,t,e,i)}}return function(){return s.apply(r,arguments)}},c={f:{}.propertyIsEnumerable},I=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},f=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==o(t)?t.split(""):Object(t)},h=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},m=function(t){return f(h(t))},b=function(t,e){if(!p(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!p(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!p(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!p(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")},_=function(t){try{return!!t()}catch(t){return!0}},s=!_(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),r=d.document,n=p(r)&&p(r.createElement),v=function(t){return n?r.createElement(t):{}},y=!s&&!_(function(){return 7!=Object.defineProperty(v("div"),"a",{get:function(){return 7}}).a}),x=Object.getOwnPropertyDescriptor,O={f:s?x:function(t,e){if(t=m(t),e=b(e,!0),y)try{return x(t,e)}catch(t){}if(l(t,e))return I(!c.f.call(t,e),t[e])}},S=function(t,e){if(a(t),!p(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},A={set:Object.setPrototypeOf||("__proto__"in{}?function(t,i,s){try{(s=g(Function.call,O.f(Object.prototype,"__proto__").set,2))(t,[]),i=!(t instanceof Array)}catch(t){i=!0}return function(t,e){return S(t,e),i?t.__proto__=e:s(t,e),t}}({},!1):void 0),check:S}.set,T=Math.ceil,N=Math.floor,E=function(t){return isNaN(t=+t)?0:(0<t?N:T)(t)},k=Math.min,w=function(t){return 0<t?k(E(t),9007199254740991):0},R=Math.max,L=Math.min,j=t(function(t){var e=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e)}),C=(j.version,t(function(t){var e="__core-js_shared__",i=d[e]||(d[e]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:j.version,mode:"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})})),P=0,D=Math.random(),U=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++P+D).toString(36))},M=C("keys"),B=function(t){return M[t]||(M[t]=U(t))},X=(u=!1,function(t,e,i){var s,r,n,a=m(t),o=w(a.length),l=(r=o,(s=E(s=i))<0?R(s+r,0):L(s,r));if(u&&e!=e){for(;l<o;)if((n=a[l++])!=n)return!0}else for(;l<o;l++)if((u||l in a)&&a[l]===e)return u||l||0;return!u&&-1}),F=B("IE_PROTO"),z=function(t,e){var i,s=m(t),r=0,n=[];for(i in s)i!=F&&l(s,i)&&n.push(i);for(;e.length>r;)l(s,i=e[r++])&&(~X(n,i)||n.push(i));return n},V="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),q=V.concat("length","prototype"),G={f:Object.getOwnPropertyNames||function(t){return z(t,q)}},$=Object.defineProperty,W={f:s?Object.defineProperty:function(t,e,i){if(a(t),e=b(e,!0),a(i),y)try{return $(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},K=s?function(t,e,i){return W.f(t,e,I(1,i))}:function(t,e,i){return t[e]=i,t},H=t(function(t){var n=U("src"),e="toString",i=Function[e],a=(""+i).split(e);j.inspectSource=function(t){return i.call(t)},(t.exports=function(t,e,i,s){var r="function"==typeof i;r&&(l(i,"name")||K(i,"name",e)),t[e]!==i&&(r&&(l(i,n)||K(i,n,t[e]?""+t[e]:a.join(String(e)))),t===d?t[e]=i:s?t[e]?t[e]=i:K(t,e,i):(delete t[e],K(t,e,i)))})(Function.prototype,e,function(){return"function"==typeof this&&this[n]||i.call(this)})}),Q="prototype",J=function(t,e,i){var s,r,n,a,o=t&J.F,l=t&J.G,u=t&J.S,p=t&J.P,h=t&J.B,c=l?d:u?d[e]||(d[e]={}):(d[e]||{})[Q],f=l?j:j[e]||(j[e]={}),m=f[Q]||(f[Q]={});for(s in l&&(i=e),i)n=((r=!o&&c&&void 0!==c[s])?c:i)[s],a=h&&r?g(n,d):p&&"function"==typeof n?g(Function.call,n):n,c&&H(c,s,n,t&J.U),f[s]!=n&&K(f,s,a),p&&m[s]!=n&&(m[s]=n)};d.core=j,J.F=1,J.G=2,J.S=4,J.P=8,J.B=16,J.W=32,J.U=64,J.R=128;var Y=J,Z="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",tt="["+Z+"]",et=RegExp("^"+tt+tt+"*"),it=RegExp(tt+tt+"*$"),st=function(t,e,i){var s={},r=_(function(){return!!Z[t]()||"​"!="​"[t]()}),n=s[t]=r?e(rt):Z[t];i&&(s[i]=n),Y(Y.P+Y.F*r,"String",s)},rt=st.trim=function(t,e){return t=String(h(t)),1&e&&(t=t.replace(et,"")),2&e&&(t=t.replace(it,"")),t},nt=st,at=Object.keys||function(t){return z(t,V)},ot=s?Object.defineProperties:function(t,e){a(t);for(var i,s=at(e),r=s.length,n=0;n<r;)W.f(t,i=s[n++],e[i]);return t},lt=d.document,ut=lt&&lt.documentElement,pt=B("IE_PROTO"),ht=function(){},ct="prototype",ft=function(){var t,e=v("iframe"),i=V.length;for(e.style.display="none",ut.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ft=t.F;i--;)delete ft[ct][V[i]];return ft()},mt=Object.create||function(t,e){var i;return null!==t?(ht[ct]=a(t),i=new ht,ht[ct]=null,i[pt]=t):i=ft(),void 0===e?i:ot(i,e)},dt=G.f,gt=O.f,bt=W.f,_t=nt.trim,vt="Number",yt=d[vt],xt=yt,It=yt.prototype,Ot=o(mt(It))==vt,St="trim"in String.prototype,At=function(t){var e=b(t,!1);if("string"==typeof e&&2<e.length){var i,s,r,n=(e=St?e.trim():_t(e,3)).charCodeAt(0);if(43===n||45===n){if(88===(i=e.charCodeAt(2))||120===i)return NaN}else if(48===n){switch(e.charCodeAt(1)){case 66:case 98:s=2,r=49;break;case 79:case 111:s=8,r=55;break;default:return+e}for(var a,o=e.slice(2),l=0,u=o.length;l<u;l++)if((a=o.charCodeAt(l))<48||r<a)return NaN;return parseInt(o,s)}}return+e};if(!yt(" 0o1")||!yt("0b1")||yt("+0x1")){yt=function(t){var e,i,s,r,n=arguments.length<1?0:t,a=this;return a instanceof yt&&(Ot?_(function(){It.valueOf.call(a)}):o(a)!=vt)?(e=new xt(At(n)),i=yt,(r=a.constructor)!==i&&"function"==typeof r&&(s=r.prototype)!==i.prototype&&p(s)&&A&&A(e,s),e):At(n)};for(var Tt,Nt=s?dt(xt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),Et=0;Nt.length>Et;Et++)l(xt,Tt=Nt[Et])&&!l(yt,Tt)&&bt(yt,Tt,gt(xt,Tt));(yt.prototype=It).constructor=yt,H(d,vt,yt)}var kt=W.f,wt=Function.prototype,Rt=/^\s*function ([^ (]*)/;"name"in wt||s&&kt(wt,"name",{configurable:!0,get:function(){try{return(""+this).match(Rt)[1]}catch(t){return""}}});var Lt=function(t){return Object(h(t))},jt=Array.isArray||function(t){return"Array"==o(t)},Ct=t(function(t){var e=C("wks"),i=d.Symbol,s="function"==typeof i;(t.exports=function(t){return e[t]||(e[t]=s&&i[t]||(s?i:U)("Symbol."+t))}).store=e}),Pt=Ct("species"),Dt=function(t,e){return jt(i=t)&&("function"!=typeof(s=i.constructor)||s!==Array&&!jt(s.prototype)||(s=void 0),p(s)&&null===(s=s[Pt])&&(s=void 0)),new(void 0===s?Array:s)(e);var i,s},Ut=Ct("unscopables"),Mt=Array.prototype;null==Mt[Ut]&&K(Mt,Ut,{});var Bt,Xt,Ft,zt,Vt,qt,Gt,$t,Wt,Kt=function(t){Mt[Ut][t]=!0},Ht=(Ft=1==(Bt=6),zt=2==Bt,Vt=3==Bt,qt=4==Bt,Gt=6==Bt,$t=5==Bt||Gt,Wt=Xt||Dt,function(t,e,i){for(var s,r,n=Lt(t),a=f(n),o=g(e,i,3),l=w(a.length),u=0,p=Ft?Wt(t,l):zt?Wt(t,0):void 0;u<l;u++)if(($t||u in a)&&(r=o(s=a[u],u,n),Bt))if(Ft)p[u]=r;else if(r)switch(Bt){case 3:return!0;case 5:return s;case 6:return u;case 2:p.push(s)}else if(qt)return!1;return Gt?-1:Vt||qt?qt:p}),Qt="findIndex",Jt=!0;Qt in[]&&Array(1)[Qt](function(){Jt=!1}),Y(Y.P+Y.F*Jt,"Array",{findIndex:function(t){return Ht(this,t,1<arguments.length?arguments[1]:void 0)}}),Kt(Qt);var Yt=function(t,e){return{value:e,done:!!t}},Zt={},te=W.f,ee=Ct("toStringTag"),ie=function(t,e,i){t&&!l(t=i?t:t.prototype,ee)&&te(t,ee,{configurable:!0,value:e})},se={};K(se,Ct("iterator"),function(){return this});var re=B("IE_PROTO"),ne=Object.prototype,ae=Object.getPrototypeOf||function(t){return t=Lt(t),l(t,re)?t[re]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ne:null},oe=Ct("iterator"),le=!([].keys&&"next"in[].keys()),ue="values",pe=function(){return this},he=function(t,e,i,s,r,n,a){var o,l,u;l=e,u=s,(o=i).prototype=mt(se,{next:I(1,u)}),ie(o,l+" Iterator");var p,h,c,f=function(t){if(!le&&t in b)return b[t];switch(t){case"keys":case ue:return function(){return new i(this,t)}}return function(){return new i(this,t)}},m=e+" Iterator",d=r==ue,g=!1,b=t.prototype,_=b[oe]||b["@@iterator"]||r&&b[r],v=_||f(r),y=r?d?f("entries"):v:void 0,x="Array"==e&&b.entries||_;if(x&&(c=ae(x.call(new t)))!==Object.prototype&&c.next&&(ie(c,m,!0),"function"!=typeof c[oe]&&K(c,oe,pe)),d&&_&&_.name!==ue&&(g=!0,v=function(){return _.call(this)}),(le||g||!b[oe])&&K(b,oe,v),Zt[e]=v,Zt[m]=pe,r)if(p={values:d?v:f(ue),keys:n?v:f("keys"),entries:y},a)for(h in p)h in b||H(b,h,p[h]);else Y(Y.P+Y.F*(le||g),e,p);return p}(Array,"Array",function(t,e){this._t=m(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,Yt(1)):Yt(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])},"values");Zt.Arguments=Zt.Array,Kt("keys"),Kt("values"),Kt("entries");for(var ce=Ct("iterator"),fe=Ct("toStringTag"),me=Zt.Array,de={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},ge=at(de),be=0;be<ge.length;be++){var _e,ve=ge[be],ye=de[ve],xe=d[ve],Ie=xe&&xe.prototype;if(Ie&&(Ie[ce]||K(Ie,ce,me),Ie[fe]||K(Ie,fe,ve),Zt[ve]=me,ye))for(_e in he)Ie[_e]||H(Ie,_e,he[_e],!0)}function Oe(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var Se=function(t,e,i){return e&&Oe(t.prototype,e),i&&Oe(t,i),t},Ae=t(function(t,e){var i,s,r,n,a,o,l,u,p,xt={PROCESSOR_VERSION:"1.1.210",CONDITION_LEVEL_TOP:1,CONDITION_LEVEL_BOTTOM:2,PLAIN_HYPHEN_REGEX:/(?:[^\\]-|\u2013)/,LOCATOR_LABELS_REGEXP:new RegExp("^((art|ch|subch|col|fig|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\\.)\\s+(.*)"),STATUTE_SUBDIV_GROUPED_REGEX:/((?:^| )(?:art|bk|ch|subch|col|fig|fol|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\. *)/g,STATUTE_SUBDIV_PLAIN_REGEX:/(?:(?:^| )(?:art|bk|ch|subch|col|fig|fol|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\. *)/,STATUTE_SUBDIV_PLAIN_REGEX_FRONT:/(?:^\s*[.,;]*\s*(?:art|bk|ch|subch|col|fig|fol|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\. *)/,STATUTE_SUBDIV_STRINGS:{"art.":"article","bk.":"book","ch.":"chapter","subch.":"subchapter","p.":"page","pp.":"page","para.":"paragraph","subpara.":"subparagraph","pt.":"part","r.":"rule","sec.":"section","subsec.":"subsection","sch.":"schedule","tit.":"title","col.":"column","fig.":"figure","fol.":"folio","l.":"line","n.":"note","no.":"issue","op.":"opus","sv.":"sub-verbo","vrs.":"verse","vol.":"volume"},STATUTE_SUBDIV_STRINGS_REVERSE:{article:"art.",book:"bk.",chapter:"ch.",subchapter:"subch.",page:"p.",paragraph:"para.",subparagraph:"subpara.",part:"pt.",rule:"r.",section:"sec.",subsection:"subsec.",schedule:"sch.",title:"tit.",column:"col.",figure:"fig.",folio:"fol.",line:"l.",note:"n.",issue:"no.",opus:"op.","sub-verbo":"sv.","sub verbo":"sv.",verse:"vrs.",volume:"vol."},LOCATOR_LABELS_MAP:{art:"article",bk:"book",ch:"chapter",subch:"subchapter",col:"column",fig:"figure",fol:"folio",l:"line",n:"note",no:"issue",op:"opus",p:"page",pp:"page",para:"paragraph",subpara:"subparagraph",pt:"part",r:"rule",sec:"section",subsec:"subsection",sv:"sub-verbo",sch:"schedule",tit:"title",vrs:"verse",vol:"volume"},MODULE_MACROS:{"juris-pretitle":!0,"juris-title":!0,"juris-pretitle-short":!0,"juris-title-short":!0,"juris-main":!0,"juris-main-short":!0,"juris-tail":!0,"juris-tail-short":!0,"juris-locator":!0},MODULE_TYPES:{legal_case:!0,legislation:!0,bill:!0,hearing:!0,gazette:!0,report:!0,regulation:!0,standard:!0},NestedBraces:[["(","["],[")","]"]],checkNestedBrace:function(t){"note"===t.opt.xclass?(this.depth=0,this.update=function(t){for(var e=(t=t||"").split(/([\(\)])/),i=1,s=e.length;i<s;i+=2)"("===e[i]?(1==this.depth%2&&(e[i]="["),this.depth+=1):")"===e[i]&&(0==this.depth%2&&(e[i]="]"),this.depth-=1);return e.join("")}):this.update=function(t){return t}},MULTI_FIELDS:["event","publisher","publisher-place","event-place","title","container-title","collection-title","authority","genre","title-short","medium","country","jurisdiction","archive","archive-place"],LangPrefsMap:{title:"titles","title-short":"titles",event:"titles",genre:"titles",medium:"titles","container-title":"journals","collection-title":"journals",archive:"journals",publisher:"publishers",authority:"publishers","publisher-place":"places","event-place":"places","archive-place":"places",jurisdiction:"places",number:"number",edition:"number",issue:"number",volume:"number"},AbbreviationSegments:function(){this["container-title"]={},this["collection-title"]={},this["institution-entire"]={},this["institution-part"]={},this.nickname={},this.number={},this.title={},this.place={},this.hereinafter={},this.classic={},this["container-phrase"]={},this["title-phrase"]={}},FIELD_CATEGORY_REMAP:{title:"title","container-title":"container-title","collection-title":"collection-title",country:"place",number:"number",place:"place",archive:"collection-title","title-short":"title",genre:"title",event:"title",medium:"title","archive-place":"place","publisher-place":"place","event-place":"place",jurisdiction:"place","language-name":"place","language-name-original":"place","call-number":"number","chapter-number":"number","collection-number":"number",edition:"number",page:"number",issue:"number",locator:"number","number-of-pages":"number","number-of-volumes":"number",volume:"number","citation-number":"number",publisher:"institution-part"},parseLocator:function(t){if(this.opt.development_extensions.locator_date_and_revision&&t.locator){t.locator=""+t.locator;var e=t.locator.indexOf("|");if(-1<e){var i=t.locator;t.locator=i.slice(0,e);var s=(i=i.slice(e+1)).match(/^([0-9]{4}-[0-9]{2}-[0-9]{2}).*/);s&&(t["locator-date"]=this.fun.dateparser.parseDateToObject(s[1]),i=i.slice(s[1].length)),t["locator-extra"]=i.replace(/^\s+/,"").replace(/\s+$/,"")}}return t.locator&&(t.locator=(""+t.locator).replace(/\s+$/,"")),t},normalizeLocaleStr:function(t){if(t){var e=t.split("-");return e[0]=e[0].toLowerCase(),e[1]&&(e[1]=e[1].toUpperCase()),e.join("-")}},isDatePart:function(t,e,i){return!!(t.length>e&&t.length<i&&parseInt(t))},isDateString:function(t){if(!t)return!1;var e=t.split("-");return!(0<e.length&&!this.isDatePart(e[0],3,5))&&(!(1<e.length&&!this.isDatePart(e[1],0,3))&&(!(2<e.length&&!this.isDatePart(e[2],0,3))&&!(3<e.length)))},parseNoteFieldHacks:function(t,e,i){if("string"==typeof t.note){for(var s=[],r=t.note.split("\n"),n=0,a=r.length;n<a;n++){s=[];var o=(f=r[n]).match(xt.NOTE_FIELDS_REGEXP);if(o){for(var l=f.split(xt.NOTE_FIELDS_REGEXP),u=0,p=l.length-1;u<p;u++)s.push(l[u]),s.push(o[u]);s.push(l[l.length-1]);for(u=1,p=s.length;u<p&&(!s[u-1].trim()||!(0<n||1<u)||s[u-1].match(xt.NOTE_FIELD_REGEXP));u+=2)s[u]="\n"+s[u].slice(2,-1).trim()+"\n";r[n]=s.join("")}}var h=0,c={};for(n=0,a=(r=r.join("\n").split("\n")).length;n<a;n++){var f,m=(f=r[n]).match(xt.NOTE_FIELD_REGEXP);if(f.trim()){if(!m){if(0===n)continue;h=n;break}var d=m[1],g=m[2].replace(/^\s+/,"").replace(/\s+$/,"");if("type"===d)t.type=g,r[n]="";else if(-1<xt.DATE_VARIABLES.indexOf(d))i&&(t[d]={raw:g},(!e||e[d]&&this.isDateString(g))&&(r[n]=""));else if(!t[d]){if(-1<xt.NAME_VARIABLES.indexOf(d)){c[d]||(c[d]=[]);var b=g.split(/\s*\|\|\s*/);if(1===b.length)c[d].push({literal:b[0]});else if(2===b.length){var _={family:b[0],given:b[1]};xt.parseParticles(_),c[d].push(_)}}else t[d]=g;e&&!e[d]||(r[n]="")}}}for(var d in c)t[d]=c[d];if(e){r[h].trim()&&(r[h]="\n"+r[h]);for(n=h-1;-1<n;n--)r[n].trim()||(r=r.slice(0,n).concat(r.slice(n+1)))}t.note=r.join("\n").trim()}},GENDERS:["masculine","feminine"],ERROR_NO_RENDERED_FORM:1,PREVIEW:"Just for laughs.",ASSUME_ALL_ITEMS_REGISTERED:2,START:0,END:1,SINGLETON:2,SEEN:6,SUCCESSOR:3,SUCCESSOR_OF_SUCCESSOR:4,SUPPRESS:5,SINGULAR:0,PLURAL:1,LITERAL:!0,BEFORE:1,AFTER:2,DESCENDING:1,ASCENDING:2,ONLY_FIRST:1,ALWAYS:2,ONLY_LAST:3,FINISH:1,POSITION_FIRST:0,POSITION_SUBSEQUENT:1,POSITION_IBID:2,POSITION_IBID_WITH_LOCATOR:3,MARK_TRAILING_NAMES:!0,POSITION_TEST_VARS:["position","first-reference-note-number","near-note"],AREAS:["citation","citation_sort","bibliography","bibliography_sort"],CITE_FIELDS:["first-reference-note-number","locator","locator-extra"],MINIMAL_NAME_FIELDS:["literal","family"],SWAPPING_PUNCTUATION:[".","!","?",":",","],TERMINAL_PUNCTUATION:[":",".",";","!","?"," "],NONE:0,NUMERIC:1,POSITION:2,COLLAPSE_VALUES:["citation-number","year","year-suffix"],DATE_PARTS:["year","month","day"],DATE_PARTS_ALL:["year","month","day","season"],DATE_PARTS_INTERNAL:["year","month","day","year_end","month_end","day_end"],NAME_PARTS:["non-dropping-particle","family","given","dropping-particle","suffix","literal"],DECORABLE_NAME_PARTS:["given","family","suffix"],DISAMBIGUATE_OPTIONS:["disambiguate-add-names","disambiguate-add-givenname","disambiguate-add-year-suffix"],GIVENNAME_DISAMBIGUATION_RULES:["all-names","all-names-with-initials","primary-name","primary-name-with-initials","by-cite"],NAME_ATTRIBUTES:["and","delimiter-precedes-last","delimiter-precedes-et-al","initialize-with","initialize","name-as-sort-order","sort-separator","et-al-min","et-al-use-first","et-al-subsequent-min","et-al-subsequent-use-first","form","prefix","suffix","delimiter"],PARALLEL_MATCH_VARS:["container-title"],PARALLEL_TYPES:["bill","gazette","regulation","legislation","legal_case","treaty","article-magazine","article-journal"],PARALLEL_COLLAPSING_MID_VARSET:["volume","issue","container-title","section","collection-number"],LOOSE:0,STRICT:1,TOLERANT:2,PREFIX_PUNCTUATION:/[.;:]\s*$/,SUFFIX_PUNCTUATION:/^\s*[.;:,\(\)]/,NUMBER_REGEXP:/(?:^\d+|\d+$)/,NAME_INITIAL_REGEXP:/^([A-Z\u0e01-\u0e5b\u00c0-\u017f\u0400-\u042f\u0590-\u05d4\u05d6-\u05ff\u0600-\u06ff\u0370\u0372\u0376\u0386\u0388-\u03ab\u03e2\u03e4\u03e6\u03e8\u03ea\u03ec\u03ee\u03f4\u03f7\u03fd-\u03ff])([a-zA-Z\u0e01-\u0e5b\u00c0-\u017f\u0400-\u052f\u0600-\u06ff\u0370-\u03ff\u1f00-\u1fff]*|)/,ROMANESQUE_REGEXP:/[-0-9a-zA-Z\u0e01-\u0e5b\u00c0-\u017f\u0370-\u03ff\u0400-\u052f\u0590-\u05d4\u05d6-\u05ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]/,ROMANESQUE_NOT_REGEXP:/[^a-zA-Z\u0e01-\u0e5b\u00c0-\u017f\u0370-\u03ff\u0400-\u052f\u0590-\u05d4\u05d6-\u05ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]/g,STARTSWITH_ROMANESQUE_REGEXP:/^[&a-zA-Z\u0e01-\u0e5b\u00c0-\u017f\u0370-\u03ff\u0400-\u052f\u0590-\u05d4\u05d6-\u05ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]/,ENDSWITH_ROMANESQUE_REGEXP:/[.;:&a-zA-Z\u0e01-\u0e5b\u00c0-\u017f\u0370-\u03ff\u0400-\u052f\u0590-\u05d4\u05d6-\u05ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]$/,ALL_ROMANESQUE_REGEXP:/^[a-zA-Z\u0e01-\u0e5b\u00c0-\u017f\u0370-\u03ff\u0400-\u052f\u0590-\u05d4\u05d6-\u05ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]+$/,VIETNAMESE_SPECIALS:/[\u00c0-\u00c3\u00c8-\u00ca\u00cc\u00cd\u00d2-\u00d5\u00d9\u00da\u00dd\u00e0-\u00e3\u00e8-\u00ea\u00ec\u00ed\u00f2-\u00f5\u00f9\u00fa\u00fd\u0101\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0-\u1ef9]/,VIETNAMESE_NAMES:/^(?:(?:[.AaBbCcDdEeGgHhIiKkLlMmNnOoPpQqRrSsTtUuVvXxYy \u00c0-\u00c3\u00c8-\u00ca\u00cc\u00cd\u00d2-\u00d5\u00d9\u00da\u00dd\u00e0-\u00e3\u00e8-\u00ea\u00ec\u00ed\u00f2-\u00f5\u00f9\u00fa\u00fd\u0101\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0-\u1ef9]{2,6})(\s+|$))+$/,NOTE_FIELDS_REGEXP:/\{:(?:[\-_a-z]+|[A-Z]+):[^\}]+\}/g,NOTE_FIELD_REGEXP:/^([\-_a-z]+|[A-Z]+):\s*([^\}]+)$/,PARTICLE_GIVEN_REGEXP:/^([^ ]+(?:\u02bb |\u2019 | |\' ) *)(.+)$/,PARTICLE_FAMILY_REGEXP:/^([^ ]+(?:\-|\u02bb|\u2019| |\') *)(.+)$/,DISPLAY_CLASSES:["block","left-margin","right-inline","indent"],NAME_VARIABLES:["author","collection-editor","composer","container-author","director","editor","editorial-director","illustrator","interviewer","original-author","recipient","reviewed-author","translator"],NUMERIC_VARIABLES:["call-number","chapter-number","collection-number","edition","page","issue","locator","number","number-of-pages","number-of-volumes","volume","citation-number"],DATE_VARIABLES:["locator-date","issued","event-date","accessed","container","original-date","publication-date","original-date","available-date","submitted"],TITLE_FIELD_SPLITS:function(t){for(var e=["title","short","main","sub"],i={},s=0,r=e.length;s<r;s++)i[e[s]]=t+"title"+("title"===e[s]?"":"-"+e[s]);return i},TAG_USEALL:function(t){var e,i,s,r;for(e=[""],i=t.indexOf("<"),s=t.indexOf(">");-1<i&&-1<s;)r=s<i?i+1:s+1,i=(t=(i<s&&-1===t.slice(i+1,s).indexOf("<")?(e[e.length-1]+=t.slice(0,i),e.push(t.slice(i,s+1)),e.push("")):e[e.length-1]+=t.slice(0,s+1),t.slice(r))).indexOf("<"),s=t.indexOf(">");return e[e.length-1]+=t,e},demoteNoiseWords:function(t,e,i){var s=t.locale[t.opt.lang].opts["leading-noise-words"];if(e&&i){(e=e.split(/\s+/)).reverse();for(var r=[],n=e.length-1;-1<n&&-1<s.indexOf(e[n].toLowerCase());n+=-1)r.push(e.pop());e.reverse();var a=e.join(" "),o=r.join(" ");"drop"!==i&&o?"demote"===i&&(e=[a,o].join(", ")):e=a}return e},extractTitleAndSubtitle:function(t){for(var e=["","container-"],i=0,s=e.length;i<s;i++){var r=e[i],n=xt.TITLE_FIELD_SPLITS(r),a=[!1];if(t.multi)for(var o in t.multi._keys[n.short])a.push(o);for(var l=0;l<s;l++){var u={};if((o=a[l])?(t.multi._keys[n.title]&&(u[n.title]=t.multi._keys[n.title][o]),t.multi._keys[n.short]&&(u[n.short]=t.multi._keys[n.short][o])):(u[n.title]=t[n.title],u[n.short]=t[n.short]),u[n.main]=u[n.title],u[n.sub]=!1,u[n.title]&&u[n.short]){var p=u[n.short],h=p.length;u[n.title].slice(0,h)===p&&u[n.title].slice(h).match(/^\s*:/)&&(u[n.main]=u[n.title].slice(0,h).replace(/\s+$/,""),u[n.sub]=u[n.title].slice(h).replace(/^\s*:\s*/,""))}if(o)for(var c in u)t.multi._keys[c]||(t.multi._keys[c]={}),t.multi._keys[c][o]=u[c];else for(var c in u)t[c]=u[c]}}},titlecaseSentenceOrNormal:function(t,e,i,s,r){var n=xt.TITLE_FIELD_SPLITS(i),a={};if(s&&e.multi?(e.multi._keys[n.title]&&(a[n.title]=e.multi._keys[n.title][s]),e.multi._keys[n.main]&&(a[n.main]=e.multi._keys[n.main][s]),e.multi._keys[n.sub]&&(a[n.sub]=e.multi._keys[n.sub][s])):(a[n.title]=e[n.title],a[n.main]=e[n.main],a[n.sub]=e[n.sub]),a[n.main]&&a[n.sub]){var o=a[n.main],l=a[n.sub];return l=r?(o=xt.Output.Formatters.sentence(t,o),xt.Output.Formatters.sentence(t,l)):xt.Output.Formatters["capitalize-first"](t,l),[o,l].join(a[n.title].slice(o.length,-1*l.length))}return r?xt.Output.Formatters.sentence(t,a[n.title]):a[n.title]},getSafeEscape:function(s){if(-1<["bibliography","citation"].indexOf(s.tmp.area)){var r=[];return s.opt.development_extensions.thin_non_breaking_space_html_hack&&"html"===s.opt.mode&&r.push(function(t){return t.replace(/\u202f/g,'<span style="white-space:nowrap">&thinsp;</span>')}),r.length?function(t){for(var e=0,i=r.length;e<i;e+=1)t=r[e](t);return xt.Output.Formats[s.opt.mode].text_escape(t)}:xt.Output.Formats[s.opt.mode].text_escape}return function(t){return t}},SKIP_WORDS:["about","above","across","afore","after","against","along","alongside","amid","amidst","among","amongst","anenst","apropos","apud","around","as","aside","astride","at","athwart","atop","barring","before","behind","below","beneath","beside","besides","between","beyond","but","by","circa","despite","down","during","except","for","forenenst","from","given","in","inside","into","lest","like","modulo","near","next","notwithstanding","of","off","on","onto","out","over","per","plus","pro","qua","sans","since","than","through"," thru","throughout","thruout","till","to","toward","towards","under","underneath","until","unto","up","upon","versus","vs.","v.","vs","v","via","vis-à-vis","with","within","without","according to","ahead of","apart from","as for","as of","as per","as regards","aside from","back to","because of","close to","due to","except for","far from","inside of","instead of","near to","next to","on to","out from","out of","outside of","prior to","pursuant to","rather than","regardless of","such as","that of","up to","where as","or","yet","so","for","and","nor","a","an","the","de","d'","von","van","c","et","ca"],FORMAT_KEY_SEQUENCE:["@strip-periods","@font-style","@font-variant","@font-weight","@text-decoration","@vertical-align","@quotes"],INSTITUTION_KEYS:["font-style","font-variant","font-weight","text-decoration","text-case"],SUFFIX_CHARS:"a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z",ROMAN_NUMERALS:[["","i","ii","iii","iv","v","vi","vii","viii","ix"],["","x","xx","xxx","xl","l","lx","lxx","lxxx","xc"],["","c","cc","ccc","cd","d","dc","dcc","dccc","cm"],["","m","mm","mmm","mmmm","mmmmm"]],LANGS:{"af-ZA":"Afrikaans",ar:"Arabic","bg-BG":"Bulgarian","ca-AD":"Catalan","cs-CZ":"Czech","da-DK":"Danish","de-AT":"Austrian","de-CH":"German (CH)","de-DE":"German (DE)","el-GR":"Greek","en-GB":"English (GB)","en-US":"English (US)","es-ES":"Spanish","et-EE":"Estonian",eu:"European","fa-IR":"Persian","fi-FI":"Finnish","fr-CA":"French (CA)","fr-FR":"French (FR)","he-IL":"Hebrew","hr-HR":"Croatian","hu-HU":"Hungarian","is-IS":"Icelandic","it-IT":"Italian","ja-JP":"Japanese","km-KH":"Khmer","ko-KR":"Korean","lt-LT":"Lithuanian","lv-LV":"Latvian","mn-MN":"Mongolian","nb-NO":"Norwegian (Bokmål)","nl-NL":"Dutch","nn-NO":"Norwegian (Nynorsk)","pl-PL":"Polish","pt-BR":"Portuguese (BR)","pt-PT":"Portuguese (PT)","ro-RO":"Romanian","ru-RU":"Russian","sk-SK":"Slovak","sl-SI":"Slovenian","sr-RS":"Serbian","sv-SE":"Swedish","th-TH":"Thai","tr-TR":"Turkish","uk-UA":"Ukranian","vi-VN":"Vietnamese","zh-CN":"Chinese (CN)","zh-TW":"Chinese (TW)"},LANG_BASES:{af:"af_ZA",ar:"ar",bg:"bg_BG",ca:"ca_AD",cs:"cs_CZ",da:"da_DK",de:"de_DE",el:"el_GR",en:"en_US",es:"es_ES",et:"et_EE",eu:"eu",fa:"fa_IR",fi:"fi_FI",fr:"fr_FR",he:"he_IL",hr:"hr-HR",hu:"hu_HU",is:"is_IS",it:"it_IT",ja:"ja_JP",km:"km_KH",ko:"ko_KR",lt:"lt_LT",lv:"lv-LV",mn:"mn_MN",nb:"nb_NO",nl:"nl_NL",nn:"nn-NO",pl:"pl_PL",pt:"pt_PT",ro:"ro_RO",ru:"ru_RU",sk:"sk_SK",sl:"sl_SI",sr:"sr_RS",sv:"sv_SE",th:"th_TH",tr:"tr_TR",uk:"uk_UA",vi:"vi_VN",zh:"zh_CN"},SUPERSCRIPTS:{"ª":"a","²":"2","³":"3","¹":"1","º":"o","ʰ":"h","ʱ":"ɦ","ʲ":"j","ʳ":"r","ʴ":"ɹ","ʵ":"ɻ","ʶ":"ʁ","ʷ":"w","ʸ":"y","ˠ":"ɣ","ˡ":"l","ˢ":"s","ˣ":"x","ˤ":"ʕ","ᴬ":"A","ᴭ":"Æ","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴲ":"Ǝ","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴽ":"Ȣ","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ᵂ":"W","ᵃ":"a","ᵄ":"ɐ","ᵅ":"ɑ","ᵆ":"ᴂ","ᵇ":"b","ᵈ":"d","ᵉ":"e","ᵊ":"ə","ᵋ":"ɛ","ᵌ":"ɜ","ᵍ":"g","ᵏ":"k","ᵐ":"m","ᵑ":"ŋ","ᵒ":"o","ᵓ":"ɔ","ᵔ":"ᴖ","ᵕ":"ᴗ","ᵖ":"p","ᵗ":"t","ᵘ":"u","ᵙ":"ᴝ","ᵚ":"ɯ","ᵛ":"v","ᵜ":"ᴥ","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"φ","ᵡ":"χ","⁰":"0","ⁱ":"i","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","⁺":"+","⁻":"−","⁼":"=","⁽":"(","⁾":")","ⁿ":"n","℠":"SM","™":"TM","㆒":"一","㆓":"二","㆔":"三","㆕":"四","㆖":"上","㆗":"中","㆘":"下","㆙":"甲","㆚":"乙","㆛":"丙","㆜":"丁","㆝":"天","㆞":"地","㆟":"人","ˀ":"ʔ","ˁ":"ʕ","ۥ":"و","ۦ":"ي"},SUPERSCRIPTS_REGEXP:new RegExp("[ª²³¹ºʰʱʲʳʴʵʶʷʸˠˡˢˣˤᴬᴭᴮᴰᴱᴲᴳᴴᴵᴶᴷᴸᴹᴺᴼᴽᴾᴿᵀᵁᵂᵃᵄᵅᵆᵇᵈᵉᵊᵋᵌᵍᵏᵐᵑᵒᵓᵔᵕᵖᵗᵘᵙᵚᵛᵜᵝᵞᵟᵠᵡ⁰ⁱ⁴⁵⁶⁷⁸⁹⁺⁻⁼⁽⁾ⁿ℠™㆒㆓㆔㆕㆖㆗㆘㆙㆚㆛㆜㆝㆞㆟ˀˁۥۦ]","g"),UPDATE_GROUP_CONTEXT_CONDITION:function(t,e,i){if(t.tmp.group_context.tip.condition){if(t.tmp.group_context.tip.condition.test){var s;if("empty-label"===t.tmp.group_context.tip.condition.test)s=!e;else if("empty-label-no-decor"===t.tmp.group_context.tip.condition.test)s=!e||-1<e.indexOf("%s");else if("comma-safe"===t.tmp.group_context.tip.condition.test){var r=!e,n=e.slice(0,1).match(xt.ALL_ROMANESQUE_REGEXP);t.tmp.just_did_number;s=!!r||!(!n||i)}t.tmp.group_context.tip.force_suppress=!s,t.tmp.group_context.tip.condition.not&&(t.tmp.group_context.tip.force_suppress=!t.tmp.group_context.tip.force_suppress)}}else e.slice(-1).match(/[0-9]/)?t.tmp.just_did_number=!0:t.tmp.just_did_number=!1},locale:{},locale_opts:{},locale_dates:{}};"exports"in t&&(e.CSL=xt),xt.TERMINAL_PUNCTUATION_REGEXP=new RegExp("^(["+xt.TERMINAL_PUNCTUATION.slice(0,-1).join("")+"])(.*)"),xt.CLOSURES=new RegExp(".*[\\]\\)]"),t.exports=xt,"undefined"==typeof console?(xt.debug=function(t){dump("CSL: "+t+"\n")},xt.error=function(t){dump("CSL error: "+t+"\n")}):(xt.debug=function(t){console.log("CSL: "+t)},xt.error=function(t){console.log("CSL error: "+t)}),(t.exports=xt).XmlJSON=function(t){this.dataObj=t,this.institution={name:"institution",attrs:{"institution-parts":"long",delimiter:", ","substitute-use-first":"1","use-last":"1"},children:[{name:"institution-part",attrs:{name:"long"},children:[]}]}},xt.XmlJSON.prototype.clean=function(t){return t},xt.XmlJSON.prototype.getStyleId=function(t,e){var i="id";e&&(i="title");for(var s="",r=t.children,n=0,a=r.length;n<a;n++)if("info"===r[n].name)for(var o=r[n].children,l=0,u=o.length;l<u;l++)o[l].name===i&&(s=o[l].children[0]);return s},xt.XmlJSON.prototype.children=function(t){return!(!t||!t.children.length)&&t.children.slice()},xt.XmlJSON.prototype.nodename=function(t){return t?t.name:null},xt.XmlJSON.prototype.attributes=function(t){var e={};for(var i in t.attrs)e["@"+i]=t.attrs[i];return e},xt.XmlJSON.prototype.content=function(t){var e="";if(!t||!t.children)return e;for(var i=0,s=t.children.length;i<s;i+=1)"string"==typeof t.children[i]&&(e+=t.children[i]);return e},xt.XmlJSON.prototype.namespace={},xt.XmlJSON.prototype.numberofnodes=function(t){return t&&"number"==typeof t.length?t.length:0},xt.XmlJSON.prototype.getAttributeValue=function(t,e,i){var s="";return i&&(e=i+":"+e),t&&t.attrs&&(s=t.attrs[e]?t.attrs[e]:""),s},xt.XmlJSON.prototype.getNodeValue=function(t,e){var i="";if(e)for(var s=0,r=t.children.length;s<r;s+=1)t.children[s].name===e&&(i=t.children[s].children.length?t.children[s]:"");else t&&(i=t);return i&&i.children&&1==i.children.length&&"string"==typeof i.children[0]&&(i=i.children[0]),i},xt.XmlJSON.prototype.setAttributeOnNodeIdentifiedByNameAttribute=function(t,e,i,s,r){"@"===s.slice(0,1)&&(s=s.slice(1));for(var n=0,a=t.children.length;n<a;n+=1)t.children[n].name===e&&t.children[n].attrs.name===i&&(t.children[n].attrs[s]=r)},xt.XmlJSON.prototype.deleteNodeByNameAttribute=function(t,e){var i,s;for(i=0,s=t.children.length;i<s;i+=1)t.children[i]&&"string"!=typeof t.children[i]&&t.children[i].attrs.name==e&&(t.children=t.children.slice(0,i).concat(t.children.slice(i+1)))},xt.XmlJSON.prototype.deleteAttribute=function(t,e){void 0!==t.attrs[e]&&t.attrs.pop(e)},xt.XmlJSON.prototype.setAttribute=function(t,e,i){return t.attrs[e]=i,!1},xt.XmlJSON.prototype.nodeCopy=function(t,e){if(!e)e={};if("object"==typeof e&&void 0===e.length)for(var i in t)"string"==typeof t[i]?e[i]=t[i]:"object"==typeof t[i]&&(void 0===t[i].length?e[i]=this.nodeCopy(t[i],{}):e[i]=this.nodeCopy(t[i],[]));else for(var s=0,r=t.length;s<r;s+=1)"string"==typeof t[s]?e[s]=t[s]:e[s]=this.nodeCopy(t[s],{});return e},xt.XmlJSON.prototype.getNodesByName=function(t,e,i,s){if(!s)s=[];if(!t||!t.children)return s;e===t.name&&(i?i===t.attrs.name&&s.push(t):s.push(t));for(var r=0,n=t.children.length;r<n;r+=1)"object"==typeof t.children[r]&&this.getNodesByName(t.children[r],e,i,s);return s},xt.XmlJSON.prototype.nodeNameIs=function(t,e){return void 0!==t&&e==t.name},xt.XmlJSON.prototype.makeXml=function(t){return"string"==typeof t&&(t="<"===t.slice(0,1)?this.jsonStringWalker.walkToObject(t):JSON.parse(t)),t},xt.XmlJSON.prototype.insertChildNodeAfter=function(t,e,i,s){for(var r=0,n=t.children.length;r<n;r+=1)if(e===t.children[r]){t.children=t.children.slice(0,r).concat([s]).concat(t.children.slice(r+1));break}return t},xt.XmlJSON.prototype.insertPublisherAndPlace=function(t){if("group"===t.name){for(var e=!0,i=["publisher","publisher-place"],s=0,r=t.children.length;s<r;s+=1){var n=i.indexOf(t.children[s].attrs.variable);if(!("text"===t.children[s].name&&-1<n)||t.children[s].attrs.prefix||t.children[s].attrs.suffix){e=!1;break}i=i.slice(0,n).concat(i.slice(n+1))}e&&!i.length&&(t.attrs["has-publisher-and-publisher-place"]=!0)}for(s=0,r=t.children.length;s<r;s+=1)"object"==typeof t.children[s]&&this.insertPublisherAndPlace(t.children[s])},xt.XmlJSON.prototype.isChildOfSubstitute=function(t){if(0<t.length){var e=t.slice();return"substitute"===e.pop()||this.isChildOfSubstitute(e)}return!1},xt.XmlJSON.prototype.addMissingNameNodes=function(t,e){if(e||(e=[]),"names"===t.name&&!this.isChildOfSubstitute(e)){for(var i=!0,s=0,r=t.children.length;s<r;s++)if("name"===t.children[s].name){i=!1;break}i&&(t.children=[{name:"name",attrs:{},children:[]}].concat(t.children))}e.push(t.name);for(s=0,r=t.children.length;s<r;s+=1)"object"==typeof t.children[s]&&this.addMissingNameNodes(t.children[s],e);e.pop()},xt.XmlJSON.prototype.addInstitutionNodes=function(t){if("names"===t.name){for(var e={},i=-1,s=0,r=t.children.length;s<r;s+=1){if("name"==t.children[s].name){for(var n in t.children[s].attrs)e[n]=t.children[s].attrs[n];e.delimiter=t.children[s].attrs.delimiter,e.and=t.children[s].attrs.and,i=s;for(var a=0,o=t.children[s].children.length;a<o;a+=1)if("family"===t.children[s].children[a].attrs.name)for(var n in t.children[s].children[a].attrs)e[n]=t.children[s].children[a].attrs[n]}if("institution"==t.children[s].name){i=-1;break}}if(-1<i){var l=this.nodeCopy(this.institution);for(s=0,r=xt.INSTITUTION_KEYS.length;s<r;s+=1){var u=xt.INSTITUTION_KEYS[s];void 0!==e[u]&&(l.children[0].attrs[u]=e[u]),e.delimiter&&(l.attrs.delimiter=e.delimiter),e.and&&(l.attrs.and="text")}t.children=t.children.slice(0,i+1).concat([l]).concat(t.children.slice(i+1))}}for(s=0,r=t.children.length;s<r;s+=1)"string"!=typeof t.children[s]&&this.addInstitutionNodes(t.children[s])},xt.XmlJSON.prototype.flagDateMacros=function(t){for(var e=0,i=t.children.length;e<i;e+=1)"macro"===t.children[e].name&&this.inspectDateMacros(t.children[e])&&(t.children[e].attrs["macro-has-date"]="true")},xt.XmlJSON.prototype.inspectDateMacros=function(t){if(!t||!t.children)return!1;if("date"===t.name)return!0;for(var e=0,i=t.children.length;e<i;e+=1)if(this.inspectDateMacros(t.children[e]))return!0;return!1},xt.stripXmlProcessingInstruction=function(t){return t?t=(t=(t=(t=t.replace(/^<\?[^?]+\?>/,"")).replace(/<!--[^>]+-->/g,"")).replace(/^\s+/g,"")).replace(/\s+$/g,""):t},xt.parseXml=function(t){var e={children:[]},r=[e.children];function p(t){return t.split("&amp;").join("&").split("&quot;").join('"').split("&gt;").join(">").split("&lt;").join("<").replace(/&#([0-9]{1,6});/gi,function(t,e){var i=parseInt(e,10);return String.fromCharCode(i)}).replace(/&#x([a-f0-9]{1,6});/gi,function(t,e){var i=parseInt(e,16);return String.fromCharCode(i)})}function h(t){var e=RegExp("^<([^\t />]+)"),i=t.match(e);return i?i[1]:null}function n(t){var e={};e.name=h(t),e.attrs={};var i,s,r,n,a=function(t){var e=t.match(/([^\'\"=	 ]+)=(?:\"[^\"]*\"|\'[^\']*\')/g);if(e)for(var i=0,s=e.length;i<s;i++)e[i]=e[i].replace(/=.*/,"");return e}(t);if(a)for(var o=0,l=a.length;o<l;o++){var u={name:a[o],value:(i=t,s=a[o],void 0,n=void 0,r=RegExp("^.*[\t ]+"+s+"=(\"(?:[^\"]*)\"|'(?:[^']*)').*$"),n=i.match(r),n?n[1].slice(1,-1):null)};e.attrs[u.name]=p(u.value)}return e.children=[],e}function a(t){r.slice(-1)[0].push(t)}function i(t){var e,i,s;-1<t.slice(1).indexOf("<")?((e=n(t.slice(0,t.indexOf(">")+1))).children=[(s=t,p(s.match(/^.*>([^<]*)<.*$/)[1]))],a(e)):"/>"===t.slice(-2)?(e=n(t),"term"===h(t)&&e.children.push(""),a(e)):"</"===t.slice(0,2)?r.pop():(a(e=n(t)),i=e,r.push(i.children))}for(var s=function(t){for(var e=(t=t.split(/(?:\r\n|\n|\r)/).join(" ").replace(/>[	 ]+</g,"><").replace(/<\!--.*?-->/g,"")).split("><"),i=null,s=0,r=e.length;s<r;s++)0<s&&(e[s]="<"+e[s]),s<e.length-1&&(e[s]=e[s]+">"),"number"!=typeof i&&("<style "!==e[s].slice(0,7)&&"<locale "!=e[s].slice(0,8)||(i=s));for(s=(e=e.slice(i)).length-2;-1<s;s--)if(-1===e[s].slice(1).indexOf("<")){var n=e[s].slice(0,5);"/>"!==e[s].slice(-2)&&("<term"===n?"</term"===e[s+1].slice(0,6)&&(e[s]=e[s]+e[s+1],e=e.slice(0,s+1).concat(e.slice(s+2))):-1<["<sing","<mult"].indexOf(n)&&"/>"!==e[s].slice(-2)&&"<"===e[s+1].slice(0,1)&&(e[s]=e[s]+e[s+1],e=e.slice(0,s+1).concat(e.slice(s+2))))}return e}(t),o=0,l=s.length;o<l;o++){i(s[o])}return e.children[0]},(t.exports=xt).XmlDOM=function(t){this.dataObj=t,"undefined"==typeof DOMParser?(DOMParser=function(){},DOMParser.prototype.parseFromString=function(t,e){var i;return"undefined"!=typeof ActiveXObject?((i=new ActiveXObject("MSXML.DomDocument")).async=!1,i.loadXML(t),i):"undefined"!=typeof XMLHttpRequest?(e||(e="text/xml"),(i=new XMLHttpRequest).open("GET","data:"+e+";charset=utf-8,"+encodeURIComponent(t),!1),i.overrideMimeType&&i.overrideMimeType(e),i.send(null),i.responseXML):"undefined"!=typeof marknote?(new marknote.Parser).parse(t):void 0},this.hasAttributes=function(t){return!(!t.attributes||!t.attributes.length)}):this.hasAttributes=function(t){return!(!t.attributes||!t.attributes.length)},this.importNode=function(t,e){return void 0===t.importNode?this._importNode(t,e,!0):t.importNode(e,!0)},this._importNode=function(t,e,i){switch(e.nodeType){case 1:var s=t.createElement(e.nodeName);if(e.attributes&&0<e.attributes.length)for(var r=0,n=e.attributes.length;r<n;)s.setAttribute(e.attributes[r].nodeName,e.getAttribute(e.attributes[r++].nodeName));if(i&&e.childNodes&&0<e.childNodes.length)for(r=0,n=e.childNodes.length;r<n;)s.appendChild(this._importNode(t,e.childNodes[r++],i));return s}},this.parser=new DOMParser;var e=this.parser.parseFromString('<docco><institution institution-parts="long" delimiter=", " substitute-use-first="1" use-last="1"><institution-part name="long"/></institution></docco>',"text/xml"),i=e.getElementsByTagName("institution");this.institution=i.item(0);var s=e.getElementsByTagName("institution-part");this.institutionpart=s.item(0),this.ns="http://purl.org/net/xbiblio/csl"},xt.XmlDOM.prototype.clean=function(t){return t=(t=(t=(t=(t=t.replace(/<\?[^?]+\?>/g,"")).replace(/<![^>]+>/g,"")).replace(/^\s+/,"")).replace(/\s+$/,"")).replace(/^\n*/,"")},xt.XmlDOM.prototype.getStyleId=function(t,e){var i="",s="id";e&&(s="title");var r=t.getElementsByTagName(s);return r&&r.length&&(r=r.item(0)),r&&(i=r.textContent),i||(i=r.innerText),i||(i=r.innerHTML),i},xt.XmlDOM.prototype.children=function(t){var e,i,s,r;if(t){for(r=[],i=0,s=(e=t.childNodes).length;i<s;i+=1)"#text"!=e[i].nodeName&&r.push(e[i]);return r}return[]},xt.XmlDOM.prototype.nodename=function(t){return t.nodeName},xt.XmlDOM.prototype.attributes=function(t){var e,i,s,r,n;if(e=new Object,t&&this.hasAttributes(t))for(r=0,n=(i=t.attributes).length;r<n;r+=1)e["@"+(s=i[r]).name]=s.value;return e},xt.XmlDOM.prototype.content=function(t){return void 0!==t.textContent?t.textContent:void 0!==t.innerText?t.innerText:t.txt},xt.XmlDOM.prototype.namespace={xml:"http://www.w3.org/XML/1998/namespace"},xt.XmlDOM.prototype.numberofnodes=function(t){return t?t.length:0},xt.XmlDOM.prototype.getAttributeName=function(t){return t.name},xt.XmlDOM.prototype.getAttributeValue=function(t,e,i){var s="";return i&&(e=i+":"+e),t&&this.hasAttributes(t)&&t.getAttribute(e)&&(s=t.getAttribute(e)),s},xt.XmlDOM.prototype.getNodeValue=function(t,e){var i=null;if(e){var s=t.getElementsByTagName(e);0<s.length&&(i=void 0!==s[0].textContent?s[0].textContent:void 0!==s[0].innerText?s[0].innerText:s[0].text)}return null===i&&t&&t.childNodes&&(0==t.childNodes.length||1==t.childNodes.length&&"#text"==t.firstChild.nodeName)&&(i=void 0!==t.textContent?t.textContent:void 0!==t.innerText?t.innerText:t.text),null===i&&(i=t),i},xt.XmlDOM.prototype.setAttributeOnNodeIdentifiedByNameAttribute=function(t,e,i,s,r){var n,a,o,l;for("@"===s.slice(0,1)&&(s=s.slice(1)),n=0,a=(o=t.getElementsByTagName(e)).length;n<a;n+=1)(l=o[n]).getAttribute("name")==i&&l.setAttribute(s,r)},xt.XmlDOM.prototype.deleteNodeByNameAttribute=function(t,e){var i,s,r,n;for(i=0,s=(n=t.childNodes).length;i<s;i+=1)(r=n[i])&&r.nodeType!=r.TEXT_NODE&&this.hasAttributes(r)&&r.getAttribute("name")==e&&t.removeChild(n[i])},xt.XmlDOM.prototype.deleteAttribute=function(t,e){t.removeAttribute(e)},xt.XmlDOM.prototype.setAttribute=function(t,e,i){return t.ownerDocument||(t=t.firstChild),-1<["function","unknown"].indexOf(typeof t.setAttribute)&&t.setAttribute(e,i),!1},xt.XmlDOM.prototype.nodeCopy=function(t){return t.cloneNode(!0)},xt.XmlDOM.prototype.getNodesByName=function(t,e,i){var s,r,n,a,o;for(s=[],a=0,o=(r=t.getElementsByTagName(e)).length;a<o;a+=1)n=r.item(a),(!i||this.hasAttributes(n)&&n.getAttribute("name")==i)&&s.push(n);return s},xt.XmlDOM.prototype.nodeNameIs=function(t,e){return e==t.nodeName},xt.XmlDOM.prototype.makeXml=function(t){return t||(t="<docco><bogus/></docco>"),t=t.replace(/\s*<\?[^>]*\?>\s*\n*/g,""),this.parser.parseFromString(t,"application/xml").firstChild},xt.XmlDOM.prototype.insertChildNodeAfter=function(t,e,i,s){var r;return r=this.importNode(e.ownerDocument,s),t.replaceChild(r,e),t},xt.XmlDOM.prototype.insertPublisherAndPlace=function(t){for(var e=t.getElementsByTagName("group"),i=0,s=e.length;i<s;i+=1){for(var r=e.item(i),n=[],a=0,o=r.childNodes.length;a<o;a+=1)1!==r.childNodes.item(a).nodeType&&n.push(a);if(r.childNodes.length-n.length==2){var l=[];for(a=0,o=2;a<o;a+=1)if(!(-1<n.indexOf(a))){for(var u=r.childNodes.item(a),p=[],h=0,c=u.childNodes.length;h<c;h+=1)1!==u.childNodes.item(h).nodeType&&p.push(h);if(u.childNodes.length-p.length==0&&(l.push(u.getAttribute("variable")),u.getAttribute("suffix")||u.getAttribute("prefix"))){l=[];break}}-1<l.indexOf("publisher")&&-1<l.indexOf("publisher-place")&&r.setAttribute("has-publisher-and-publisher-place",!0)}}},xt.XmlDOM.prototype.isChildOfSubstitute=function(t){return!!t.parentNode&&("substitute"===t.parentNode.tagName.toLowerCase()||this.isChildOfSubstitute(t.parentNode))},xt.XmlDOM.prototype.addMissingNameNodes=function(t){for(var e=t.getElementsByTagName("names"),i=0,s=e.length;i<s;i+=1){var r=e.item(i),n=r.getElementsByTagName("name");if(!(n&&0!==n.length||this.isChildOfSubstitute(r))){var a=r.ownerDocument.createElement("name");r.appendChild(a)}}},xt.XmlDOM.prototype.addInstitutionNodes=function(t){var e,i,s,r,n,a,o;for(a=0,o=(e=t.getElementsByTagName("names")).length;a<o;a+=1)if(0!=(r=(i=e.item(a)).getElementsByTagName("name")).length&&0==i.getElementsByTagName("institution").length){s=this.importNode(t.ownerDocument,this.institution),theinstitutionpart=s.getElementsByTagName("institution-part").item(0),n=r.item(0),i.insertBefore(s,n.nextSibling);for(var l=0,u=xt.INSTITUTION_KEYS.length;l<u;l+=1){var p=xt.INSTITUTION_KEYS[l];(m=n.getAttribute(p))&&theinstitutionpart.setAttribute(p,m)}var h=n.getElementsByTagName("name-part");for(l=0,u=h.length;l<u;l+=1)if("family"===h[l].getAttribute("name"))for(var c=0,f=xt.INSTITUTION_KEYS.length;c<f;c+=1){var m;p=xt.INSTITUTION_KEYS[c];(m=h[l].getAttribute(p))&&theinstitutionpart.setAttribute(p,m)}}},xt.XmlDOM.prototype.flagDateMacros=function(t){var e,i,s;for(nodes=t.getElementsByTagName("macro"),e=0,i=nodes.length;e<i;e+=1)(s=nodes.item(e)).getElementsByTagName("date").length&&s.setAttribute("macro-has-date","true")},t.exports=xt,(t.exports=xt).setupXml=function(t){var e={},i=null;if(void 0!==t?i="string"==typeof t?(e="<"===(t=t.replace("^\ufeff","").replace(/^\s+/,"")).slice(0,1)?xt.parseXml(t):JSON.parse(t),new xt.XmlJSON(e)):void 0!==t.getAttribute?new xt.XmlDOM(t):void 0!==t.toXMLString?new xt.XmlE4X(t):new xt.XmlJSON(t):xt.error("unable to parse XML input"),!i)throw"citeproc-js error: unable to parse CSL style or locale object";return i},(t.exports=xt).getSortCompare=function(i){if(xt.stringCompare)return xt.stringCompare;var s,r={sensitivity:"base",ignorePunctuation:!0,numeric:!0};i||(i="en-US");var n=function(t){return t.replace(/^[\[\]\'\"]*/g,"")},a=!!(s=function(t,e){return t.toLocaleLowerCase().localeCompare(e.toLocaleLowerCase(),i,r)})("[x","x")&&function(t,e){return s(n(t),n(e))};return function(t,e){return a?a(t,e):s(t,e)}},(t.exports=xt).ambigConfigDiff=function(t,e){var i,s,r,n;if(t.names.length!==e.names.length)return 1;for(i=0,s=t.names.length;i<s;i+=1){if(t.names[i]!==e.names[i])return 1;for(r=0,n=t.givens[i];r<n;r+=1)if(t.givens[i][r]!==e.givens[i][r])return 1}return t.disambiguate!=e.disambiguate?1:t.year_suffix!==e.year_suffix?1:0},xt.cloneAmbigConfig=function(t,e,i){var s,r,n,a,o,l={names:[],givens:[],year_suffix:!1,disambiguate:!1};for(s=0,r=t.names.length;s<r;s+=1)o=t.names[s],l.names[s]=o;for(s=0,r=t.givens.length;s<r;s+=1){for(o=[],n=0,a=t.givens[s].length;n<a;n+=1)o.push(t.givens[s][n]);l.givens.push(o)}return l.disambiguate=e?(l.year_suffix=e.year_suffix,e.disambiguate):(l.year_suffix=t.year_suffix,t.disambiguate),l},xt.getAmbigConfig=function(){var t;return(t=this.tmp.disambig_request)||(t=this.tmp.disambig_settings),xt.cloneAmbigConfig(t)},xt.getMaxVals=function(){return this.tmp.names_max.mystack.slice()},xt.getMinVal=function(){return this.tmp["et-al-min"]},(t.exports=xt).tokenExec=function(e,t,i){var s,r;s=e.next,r=!1;e.test&&(s=function(t){return t?(this.tmp.jump.replace("succeed"),e.succeed):(this.tmp.jump.replace("fail"),e.fail)}.call(this,e.test(t,i)));for(var n=0,a=e.execs.length;n<a;n++)(r=e.execs[n].call(e,this,t,i))&&(s=r);return s},xt.expandMacro=function(t,e){var i,s,r;i=t.postponed_macro,t=new xt.Token("group",xt.START);var n=!1,a=!1;if((s=this.cslXml.getNodesByName(this.cslXml.dataObj,"macro",i)).length&&(a=this.cslXml.getAttributeValue(s[0],"cslid"),n=this.cslXml.getAttributeValue(s[0],"macro-has-date")),n&&(i=i+"@"+this.build.current_default_locale,u=function(t,e){t.tmp.extension&&(t.tmp["doing-macro-with-date"]=!0)},t.execs.push(u)),-1<this.build.macro_stack.indexOf(i))throw'CSL processor error: call to macro "'+i+'" would cause an infinite loop';if(this.build.macro_stack.push(i),t.cslid=a,xt.MODULE_MACROS[i]&&(t.juris=i,this.opt.update_mode=xt.POSITION),xt.Node.group.build.call(t,this,e,!0),!this.cslXml.getNodeValue(s))throw'CSL style error: undefined macro "'+i+'"';var o,l=xt.getMacroTarget.call(this,i);if(l&&(xt.buildMacro.call(this,l,s),xt.configureMacro.call(this,l)),!this.build.extension){var u=(o=i,function(t,e,i){for(var s=0;s<t.macros[o].length;)s=xt.tokenExec.call(t,t.macros[o][s],e,i)}),p=new xt.Token("text",xt.SINGLETON);p.execs.push(u),e.push(p)}r=new xt.Token("group",xt.END),n&&(u=function(t,e){t.tmp.extension&&(t.tmp["doing-macro-with-date"]=!1)},r.execs.push(u)),t.juris&&(r.juris=i),xt.Node.group.build.call(r,this,e,!0),this.build.macro_stack.pop()},xt.getMacroTarget=function(t){var e=!1;return this.build.extension?e=this[this.build.root+this.build.extension].tokens:this.macros[t]||(e=[],this.macros[t]=e),e},xt.buildMacro=function(t,e){xt.makeBuilder(this,t)(void 0===e.length?e:e[0])},xt.configureMacro=function(t){this.build.extension||this.configureTokenList(t)},xt.XmlToToken=function(t,e,i,s){var r,n,a,o,l,u;if(r=t.cslXml.nodename(this),!t.build.skip||t.build.skip===r)if(r){if(!xt.Node[t.cslXml.nodename(this)])throw'Undefined node name "'+r+'".';if(a=t.cslXml.attributes(this),o=xt.setDecorations.call(this,t,a),l=new xt.Token(r,e),e!==xt.END||"if"===r||"else-if"===r||"layout"===r){for(var p in a)if(a.hasOwnProperty(p)){if(e===xt.END&&"@language"!==p&&"@locale"!==p)continue;if(a.hasOwnProperty(p))if(xt.Attributes[p])try{xt.Attributes[p].call(l,t,""+a[p])}catch(t){throw xt.error(t),"CSL processor error, "+p+" attribute: "+t}else xt.debug('warning: undefined attribute "'+p+'" in style')}l.decorations=o,-1<xt.DATE_VARIABLES.indexOf(a["@variable"])&&s.push(l.variables)}else e===xt.END&&a["@variable"]&&(l.hasVariable=!0,-1<xt.DATE_VARIABLES.indexOf(a["@variable"])&&(l.variables=s.pop()));u=i||t[t.build.area].tokens,xt.Node[r].build.call(l,t,u,!0)}else(n=t.cslXml.content(this))&&(t.build.text=n)},(t.exports=xt).DateParser=new function(){for(var t=[["明治",1867],["大正",1911],["昭和",1925],["平成",1988]],e=0,i=t.length;e<i;e++){t[e][0];var s=t[e][1]}var r=[];for(e=0,i=t.length;e<i;e++){s=t[e][0];r.push(s)}var n=r.join("|"),j=new RegExp("(?:"+n+")(?:[0-9]+)"),C=new RegExp("(?:"+n+")(?:[0-9]+)","g"),P=/(\u6708|\u5E74)/g,D=/\u65E5/g,U=/\u301c/g,a="([?0-9]{4}(?:%%NUMD%%[?0-9]{1,2}){0,2}(?![0-9])|(?:[?0-9]{1,2}%%NUMD%%){0,2}[?0-9]{4}(?![0-9])|[?0-9]{1,3}|[%%DATED%%]|[?~]|[^-/~?0-9]+)",M=new RegExp(a.replace(/%%NUMD%%/g,"-").replace(/%%DATED%%/g,"-")),B=new RegExp(a.replace(/%%NUMD%%/g,"-").replace(/%%DATED%%/g,"/")),X=new RegExp(a.replace(/%%NUMD%%/g,"/").replace(/%%DATED%%/g,"-"));this.monthStrings="january february march april may june july august september october november december spring summer fall winter spring summer".split(" "),this.setOrderDayMonth=function(){this.monthGuess=1,this.dayGuess=0},this.setOrderMonthDay=function(){this.monthGuess=0,this.dayGuess=1},this.resetDateParserMonths=function(){this.monthSets=[];for(var t=0,e=this.monthStrings.length;t<e;t++)this.monthSets.push([this.monthStrings[t]]);this.monthAbbrevs=[];for(t=0,e=this.monthSets.length;t<e;t++){this.monthAbbrevs.push([]);for(var i=0,s=this.monthSets[t].length;i<s;i++)this.monthAbbrevs[t].push(this.monthSets[t][0].slice(0,3))}this.monthRexes=[];for(t=0,e=this.monthAbbrevs.length;t<e;t++)this.monthRexes.push(new RegExp("(?:"+this.monthAbbrevs[t].join("|")+")"))},this.addDateParserMonths=function(t){if("string"==typeof t&&(t=t.split(/\s+/)),12===t.length||16===t.length){for(var e=0,i=t.length;e<i;e++){for(var s=null,r=!1,n=3,a={},o=0,l=this.monthAbbrevs.length;o<l;o++){if(a[o]={},o===e){for(var u=0,p=this.monthAbbrevs[e].length;u<p;u++)if(this.monthAbbrevs[e][u]===t[e].slice(0,this.monthAbbrevs[e][u].length)){r=!0;break}}else for(u=0,p=this.monthAbbrevs[o].length;u<p;u++)if(s=this.monthAbbrevs[o][u].length,this.monthAbbrevs[o][u]===t[e].slice(0,s)){for(;this.monthSets[o][u].slice(0,s)===t[e].slice(0,s);){if(s>t[e].length||s>this.monthSets[o][u].length){xt.debug("unable to disambiguate month string in date parser: "+t[e]);break}s+=1}n=s,a[o][u]=s}for(var h in a)for(kKey in a[h])s=a[h][kKey],h=parseInt(h,10),kKey=parseInt(kKey,10),this.monthAbbrevs[h][kKey]=this.monthSets[h][kKey].slice(0,s)}r||(this.monthSets[e].push(t[e]),this.monthAbbrevs[e].push(t[e].slice(0,n)))}this.monthRexes=[],this.monthRexStrs=[];for(e=0,i=this.monthAbbrevs.length;e<i;e++)this.monthRexes.push(new RegExp("^(?:"+this.monthAbbrevs[e].join("|")+")")),this.monthRexStrs.push("^(?:"+this.monthAbbrevs[e].join("|")+")");if(18===this.monthAbbrevs.length)for(e=12,i=14;e<i;e++)this.monthRexes[e+4]=new RegExp("^(?:"+this.monthAbbrevs[e].join("|")+")"),this.monthRexStrs[e+4]="^(?:"+this.monthAbbrevs[e].join("|")+")"}else xt.debug("month [+season] list of "+t.length+", expected 12 or 16. Ignoring.")},this.convertDateObjectToArray=function(t){t["date-parts"]=[],t["date-parts"].push([]);for(var e,i=0,s=0,r=3;s<r&&t[e=["year","month","day"][s]];s++)i+=1,t["date-parts"][0].push(t[e]),delete t[e];t["date-parts"].push([]);for(s=0,r=i;s<r&&t[e=["year_end","month_end","day_end"][s]];s++)t["date-parts"][1].push(t[e]),delete t[e];return t["date-parts"][0].length!==t["date-parts"][1].length&&t["date-parts"].pop(),t},this.convertDateObjectToString=function(t){for(var e=[],i=0;i<3&&t[DATE_PARTS_ALL[i]];i+=1)e.push(t[DATE_PARTS_ALL[i]]);return e.join("-")},this._parseNumericDate=function(t,e,i,s){i||(i="");for(var r=s.split(e),n=0,a=r.length;n<a;n++)if(4===r[n].length){t["year"+i]=r[n].replace(/^0*/,""),r=n?r.slice(0,n):r.slice(1);break}for(n=0,a=r.length;n<a;n++)r[n]=parseInt(r[n],10);1===r.length||2===r.length&&!r[1]?t["month"+i]=""+r[0]:2===r.length&&(12<r[this.monthGuess]?(t["month"+i]=""+r[this.dayGuess],t["day"+i]=""+r[this.monthGuess]):(t["month"+i]=""+r[this.monthGuess],t["day"+i]=""+r[this.dayGuess]))},this.parseDateToObject=function(t){var e,i=t,s=-1,r=-1,n=!1;if(t){if("-"===t.slice(0,1)&&(n=!0,t=t.slice(1)),t.match(/^[0-9]{1,3}$/))for(;t.length<4;)t="0"+t;if(_=(t=(t=""+t).replace(/\s*[0-9]{2}:[0-9]{2}(?::[0-9]+)/,"")).match(P)){var a=(t=(t=(t=(t=(t=(t=t.replace(/\s+/g,"")).replace(D,"")).replace(P,"-")).replace(U,"/")).replace(/\-\//g,"/")).replace(/-$/g,"")).split(j);e=[];var o=t.match(C);if(o){for(var l=[],u=0,p=o.length;u<p;u++)l=l.concat(o[u].match(/([^0-9]+)([0-9]+)/).slice(1));for(u=0,p=a.length;u<p;u++)if(e.push(a[u]),u!==len-1){var h=2*pos;e.push(l[h]),e.push(l[h+1])}}else e=a;for(u=1,p=e.length;u<p;u+=3)e[u+1]=jiy[e[u]]+parseInt(e[u+1],10),e[u]="";s=(t=(t=(t=(t=e.join("")).replace(/\s*-\s*$/,"").replace(/\s*-\s*\//,"/")).replace(/\.\s*$/,"")).replace(/\.(?! )/,"")).indexOf("/"),r=t.indexOf("-")}}var c,f,m="",d="",g={};if('"'===(t=t.replace(/([A-Za-z])\./g,"$1")).slice(0,1)&&'"'===t.slice(-1))return g.literal=t.slice(1,-1),g;-1<s&&-1<r?e=3<t.split("/").length?(c="-",f="/",(t=t.replace(/\_/g,"-")).split(X)):(c="/",f="-",(t=t.replace(/\_/g,"/")).split(B)):(f=c="-",e=(t=(t=t.replace(/\//g,"-")).replace(/\_/g,"-")).split(M));var b=[];for(u=0,p=e.length;u<p;u++){var _;(_=e[u].match(/^\s*([\-\/]|[^\-\/\~\?0-9]+|[\-~?0-9]+)\s*$/))&&b.push(_[1])}var v=b.indexOf(c),y=[],x=!1;-1<v?(y.push([0,v]),y.push([v+1,b.length]),x=!0):y.push([0,b.length]);var I="";for(u=0,p=y.length;u<p;u++){var O=y[u],S=b.slice(O[0],O[1]);t:for(var A=0,T=S.length;A<T;A++){var N=S[A];if(-1<N.indexOf(f))this._parseNumericDate(g,f,I,N);else if(N.match(/[0-9]{4}/))g["year"+I]=N.replace(/^0*/,"");else{for(var E=0,k=this.monthRexes.length;E<k;E++)if(N.toLocaleLowerCase().match(this.monthRexes[E])){g["month"+I]=""+(parseInt(E,10)+1);continue t}N.match(/^[0-9]+$/)&&(m=N),N.toLocaleLowerCase().match(/^bc/)&&m?(g["year"+I]=""+-1*m,m=""):N.toLocaleLowerCase().match(/^ad/)&&m?(g["year"+I]=""+m,m=""):"~"===N||"?"===N||"c"===N||N.match(/^cir/)?g.circa="1":!N.toLocaleLowerCase().match(/(?:mic|tri|hil|eas)/)||g["season"+I]||(d=N)}}m&&(g["day"+I]=m,m=""),d&&!g["season"+I]&&(g["season"+I]=d,d=""),I="_end"}if(x)for(A=0,T=xt.DATE_PARTS_ALL.length;A<T;A++){var w=xt.DATE_PARTS_ALL[A];g[w]&&!g[w+"_end"]?g[w+"_end"]=g[w]:!g[w]&&g[w+"_end"]&&(g[w]=g[w+"_end"])}(!g.year||g.year&&g.day&&!g.month)&&(g={literal:i});var R=["year","month","day","year_end","month_end","day_end"];for(u=0,p=R.length;u<p;u++){var L=R[u];"string"==typeof g[L]&&g[L].match(/^[0-9]+$/)&&(g[L]=parseInt(g[L],10))}return n&&-1<Object.keys(g).indexOf("year")&&(g.year=-1*g.year),g},this.parseDateToArray=function(t){return this.convertDateObjectToArray(this.parseDateToObject(t))},this.parseDateToString=function(t){return this.convertDateObjectToString(this.parseDateToObject(t))},this.parse=function(t){return this.parseDateToObject(t)},this.setOrderMonthDay(),this.resetDateParserMonths()},(t.exports=xt).Engine=function(t,e,i,s){var r,n;this.processor_version=xt.PROCESSOR_VERSION,this.csl_version="1.0",(this.sys=t).variableWrapper&&(xt.VARIABLE_WRAPPER_PREPUNCT_REX=new RegExp("^(["+[" "].concat(xt.SWAPPING_PUNCTUATION).join("")+"]*)(.*)")),xt.retrieveStyleModule&&(this.sys.retrieveStyleModule=xt.retrieveStyleModule),xt.getAbbreviation&&(this.sys.getAbbreviation=xt.getAbbreviation),this.sys.stringCompare&&(xt.stringCompare=this.sys.stringCompare),this.sys.AbbreviationSegments=xt.AbbreviationSegments,this.parallel=new xt.Parallel(this),this.transform=new xt.Transform(this),this.setParseNames=function(t){this.opt["parse-names"]=t},this.opt=new xt.Engine.Opt,this.tmp=new xt.Engine.Tmp,this.build=new xt.Engine.Build,this.fun=new xt.Engine.Fun(this),this.configure=new xt.Engine.Configure,this.citation_sort=new xt.Engine.CitationSort,this.bibliography_sort=new xt.Engine.BibliographySort,this.citation=new xt.Engine.Citation(this),this.bibliography=new xt.Engine.Bibliography,this.output=new xt.Output.Queue(this),this.dateput=new xt.Output.Queue(this),this.cslXml=xt.setupXml(e),(this.opt.development_extensions.csl_reverse_lookup_support||this.sys.csl_reverse_lookup_support)&&(this.build.cslNodeId=0,this.setCslNodeIds=function(t,e){var i=this.cslXml.children(t);this.cslXml.setAttribute(t,"cslid",this.build.cslNodeId),this.opt.nodenames.push(e),this.build.cslNodeId+=1;for(var s=0,r=this.cslXml.numberofnodes(i);s<r;s+=1)(e=this.cslXml.nodename(i[s]))&&this.setCslNodeIds(i[s],e)},this.setCslNodeIds(this.cslXml.dataObj,"style")),this.cslXml.addMissingNameNodes(this.cslXml.dataObj),this.cslXml.addInstitutionNodes(this.cslXml.dataObj),this.cslXml.insertPublisherAndPlace(this.cslXml.dataObj),this.cslXml.flagDateMacros(this.cslXml.dataObj),void 0===this.cslXml.attributes(this.cslXml.dataObj)["@sort-separator"]&&this.cslXml.setAttribute(this.cslXml.dataObj,"sort-separator",", "),this.opt["initialize-with-hyphen"]=!0,this.setStyleAttributes(),this.opt.xclass=this.cslXml.getAttributeValue(this.cslXml.dataObj,"class"),this.opt.class=this.opt.xclass,this.opt.styleID=this.cslXml.getStyleId(this.cslXml.dataObj),this.opt.styleName=this.cslXml.getStyleId(this.cslXml.dataObj,!0),"1.1m"===this.opt.version.slice(0,4)&&(this.opt.development_extensions.static_statute_locator=!0,this.opt.development_extensions.handle_parallel_articles=!0,this.opt.development_extensions.main_title_from_short_title=!0,this.opt.development_extensions.rtl_support=!0,this.opt.development_extensions.expect_and_symbol_form=!0,this.opt.development_extensions.require_explicit_legal_case_title_short=!0,this.opt.development_extensions.force_jurisdiction=!0),i&&(i=i.replace("_","-"),i=xt.normalizeLocaleStr(i)),this.opt["default-locale"][0]&&(this.opt["default-locale"][0]=this.opt["default-locale"][0].replace("_","-"),this.opt["default-locale"][0]=xt.normalizeLocaleStr(this.opt["default-locale"][0])),i&&s&&(this.opt["default-locale"]=[i]),i&&!s&&this.opt["default-locale"][0]&&(i=this.opt["default-locale"][0]),0===this.opt["default-locale"].length&&(i||(i="en-US"),this.opt["default-locale"].push("en-US")),i||(i=this.opt["default-locale"][0]),r=xt.localeResolve(i),this.opt.lang=r.best,this.opt["default-locale"][0]=r.best,this.locale={},this.opt["default-locale-sort"]||(this.opt["default-locale-sort"]=this.opt["default-locale"][0]),-1<"dale|".localeCompare("daleb",this.opt["default-locale-sort"])?this.opt.sort_sep="@":this.opt.sort_sep="|",this.localeConfigure(r),this.locale[this.opt.lang].opts["skip-words-regexp"]=(n=(n=this.locale[this.opt.lang].opts["skip-words"]).slice(),new RegExp("(?:(?:[?!:]*\\s+|-|^)(?:"+n.join("|")+")(?=[!?:]*\\s+|-|$))","g")),this.output.adjust=new xt.Output.Queue.adjust(this.getOpt("punctuation-in-quote")),this.registry=new xt.Registry(this),this.macros={},this.build.area="citation";var a=this.cslXml.getNodesByName(this.cslXml.dataObj,this.build.area);this.buildTokenLists(a,this[this.build.area].tokens),this.build.area="bibliography";a=this.cslXml.getNodesByName(this.cslXml.dataObj,this.build.area);this.buildTokenLists(a,this[this.build.area].tokens),this.juris={},this.configureTokenLists(),this.disambiguate=new xt.Disambiguation(this),this.splice_delimiter=!1,this.fun.dateparser=xt.DateParser,this.fun.flipflopper=new xt.Util.FlipFlopper(this),this.setCloseQuotesArray(),this.fun.ordinalizer.init(this),this.fun.long_ordinalizer.init(this),this.fun.page_mangler=xt.Util.PageRangeMangler.getFunction(this,"page"),this.fun.year_mangler=xt.Util.PageRangeMangler.getFunction(this,"year"),this.setOutputFormat("html")},xt.Engine.prototype.setCloseQuotesArray=function(){var t;(t=[]).push(this.getTerm("close-quote")),t.push(this.getTerm("close-inner-quote")),t.push('"'),t.push("'"),this.opt.close_quotes_array=t},xt.makeBuilder=function(r,e){var i=[];function n(t){xt.XmlToToken.call(t,r,xt.START,e,i)}function a(t){xt.XmlToToken.call(t,r,xt.END,e,i)}function o(t){xt.XmlToToken.call(t,r,xt.SINGLETON,e,i)}return function t(e){var i;if(r.cslXml.numberofnodes(r.cslXml.children(e))){n(i=e);for(var s=0;s<r.cslXml.numberofnodes(r.cslXml.children(i));s+=1)e=r.cslXml.children(i)[s],null!==r.cslXml.nodename(e)&&("date"===r.cslXml.nodename(e)&&(xt.Util.fixDateNode.call(r,i,s,e),e=r.cslXml.children(i)[s]),t(e));a(i)}else o(e)}},xt.Engine.prototype.buildTokenLists=function(t,e){this.cslXml.getNodeValue(t)&&xt.makeBuilder(this,e)(void 0===t.length?t:t[0])},xt.Engine.prototype.setStyleAttributes=function(){var t,e,i={};for(e in i.name=this.cslXml.nodename(this.cslXml.dataObj),t=this.cslXml.attributes(this.cslXml.dataObj))t.hasOwnProperty(e)&&xt.Attributes[e].call(i,this,t[e])},xt.Engine.prototype.getTerm=function(t,e,i,s,r,n){var a;t&&t.match(/[A-Z]/)&&t===t.toUpperCase()&&(xt.debug("Warning: term key is in uppercase form: "+t),t=t.toLowerCase()),a=n?this.opt["default-locale"][0]:this.opt.lang;var o=xt.Engine.getField(xt.LOOSE,this.locale[a].terms,t,e,i,s);if(o||"range-delimiter"!==t||(o="–"),void 0===o){if(r===xt.STRICT)throw'Error in getTerm: term "'+t+'" does not exist.';r===xt.TOLERANT&&(o="")}return o&&(this.tmp.cite_renders_content=!0),o},xt.Engine.prototype.getDate=function(t,e){var i;return i=e?this.opt["default-locale"]:this.opt.lang,!!this.locale[i].dates[t]&&this.locale[i].dates[t]},xt.Engine.prototype.getOpt=function(t){return void 0!==this.locale[this.opt.lang].opts[t]&&this.locale[this.opt.lang].opts[t]},xt.Engine.prototype.getVariable=function(t,e,i,s){return xt.Engine.getField(xt.LOOSE,t,e,i,s)},xt.Engine.prototype.getDateNum=function(t,e){return void 0===t?0:t[e]},xt.Engine.getField=function(t,e,i,s,r,n){var a,o,l,u,p,h;if(a="",void 0!==e[i]){for(h=n&&e[i][n]?e[i][n]:e[i],o=[],"symbol"===s?o=["symbol","short"]:"verb-short"===s?o=["verb-short","verb"]:"long"!==s&&(o=[s]),p=(o=o.concat(["long"])).length,u=0;u<p;u+=1)if(l=o[u],"string"==typeof h||"number"==typeof h)a=h;else if(void 0!==h[l]){a="string"==typeof h[l]||"number"==typeof h[l]?h[l]:"number"==typeof r?h[l][r]:h[l][0];break}return a}if(t===xt.STRICT)throw'Error in getField: term "'+i+'" does not exist.'},xt.Engine.prototype.configureTokenLists=function(){var t,e;for(e=xt.AREAS.length,t=0;t<e;t+=1){var i=this[xt.AREAS[t]].tokens;this.configureTokenList(i)}return this.version=xt.version,this.state},xt.Engine.prototype.configureTokenList=function(t){var e,i,s,r,n,a;for(e=["year","month","day"],r=t.length-1;-1<r;r+=-1){if("date"===(i=t[r]).name&&xt.END===i.tokentype&&(s=[]),"date-part"===i.name&&i.strings.name)for(a=e.length,n=0;n<a;n+=1)e[n]===i.strings.name&&s.push(i.strings.name);"date"===i.name&&xt.START===i.tokentype&&(s.reverse(),i.dateparts=s),i.next=r+1,i.name&&xt.Node[i.name].configure&&xt.Node[i.name].configure.call(i,this,r)}},xt.Engine.prototype.retrieveItems=function(t){var e;e=[];for(var i=0,s=t.length;i<s;i+=1)e.push(this.retrieveItem(""+t[i]));return e},xt.ITERATION=0,xt.Engine.prototype.retrieveItem=function(t){var e,i;if(this.tmp.loadedItemIDs[t])return this.registry.refhash[t];if(this.tmp.loadedItemIDs[t]=!0,this.opt.development_extensions.normalize_lang_keys_to_lowercase&&"boolean"==typeof this.opt.development_extensions.normalize_lang_keys_to_lowercase){for(var s=0,r=this.opt["default-locale"].length;s<r;s+=1)this.opt["default-locale"][s]=this.opt["default-locale"][s].toLowerCase();for(s=0,r=this.opt["locale-translit"].length;s<r;s+=1)this.opt["locale-translit"][s]=this.opt["locale-translit"][s].toLowerCase();for(s=0,r=this.opt["locale-translat"].length;s<r;s+=1)this.opt["locale-translat"][s]=this.opt["locale-translat"][s].toLowerCase();this.opt.development_extensions.normalize_lang_keys_to_lowercase=100}if(xt.ITERATION+=1,e=JSON.parse(JSON.stringify(this.sys.retrieveItem(""+t))),this.opt.development_extensions.normalize_lang_keys_to_lowercase){if(e.multi){if(e.multi._keys)for(var n in e.multi._keys)for(var a in e.multi._keys[n])a!==a.toLowerCase()&&(e.multi._keys[n][a.toLowerCase()]=e.multi._keys[n][a],delete e.multi._keys[n][a]);if(e.multi.main)for(var n in e.multi.main)e.multi.main[n]=e.multi.main[n].toLowerCase()}for(s=0,r=xt.NAME_VARIABLES.length;r<s;s+=1){var o=xt.NAME_VARIABLES[s];if(e[o]&&e[o].multi)for(var l=0,u=e[o].length;l<u;l+=1){var p=e[o][l];if(p.multi){if(p.multi._key)for(var a in p.multi._key)a!==a.toLowerCase()&&(p.multi._key[a.toLowerCase()]=p.multi._key[a],delete p.multi._key[a]);p.multi.main&&(p.multi.main=p.multi.main.toLowerCase())}}}}if(e.language){var h=e.language.split("<");0<h.length&&(e["language-name"]=h[0]),2===h.length&&(e["language-name-original"]=h[1])}e.page&&(e["page-first"]=e.page,"\\"!==(i=(""+e.page).split(/\s*(?:&|, |-|\u2013)\s*/))[0].slice(-1)&&(e["page-first"]=i[0]));this.opt.development_extensions.field_hack&&e.note&&xt.parseNoteFieldHacks(e,!1,this.opt.development_extensions.allow_field_hack_date_override);for(s=1,r=xt.DATE_VARIABLES.length;s<r;s+=1){var c=e[xt.DATE_VARIABLES[s]];c&&(this.opt.development_extensions.raw_date_parsing&&c.raw&&(c=this.fun.dateparser.parseDateToObject(c.raw)),e[xt.DATE_VARIABLES[s]]=this.dateParseArray(c))}if(this.opt.development_extensions.static_statute_locator&&e.type&&-1<["bill","gazette","legislation","regulation","treaty"].indexOf(e.type)){var f,m=["type","title","jurisdiction","genre","volume","container-title"],d=[];for(s=0,r=m.length;s<r;s+=1)e[f=m[s]]&&d.push(e[f]);for(s=0,(m=["original-date","issued"]).length;s<r;s+=1)if(e[f=m[s]]&&e[f].year){var g=e[f].year;d.push(g);break}e.legislation_id=d.join("::")}if(this.opt.development_extensions.force_jurisdiction&&"string"==typeof e.authority&&(e.authority=[{literal:e.authority,multi:{_key:{}}}],e.multi&&e.multi._keys&&e.multi._keys.authority))for(var a in e.authority[0].multi._key={},e.multi._keys.authority)e.authority[0].multi._key[a]={literal:e.multi._keys.authority[a]};e["title-short"]||(e["title-short"]=e.shortTitle),this.opt.development_extensions.main_title_from_short_title&&xt.extractTitleAndSubtitle(e);var b,_=-1<["bill","legal_case","legislation","gazette","regulation"].indexOf(e.type);if(this.opt.development_extensions.force_jurisdiction&&_&&(e.jurisdiction||(e.jurisdiction="us")),!_&&e.title&&this.sys.getAbbreviation){e.jurisdiction,b=this.sys.normalizeAbbrevsKey?this.sys.normalizeAbbrevsKey(e.title):e.title;var v=this.transform.loadAbbreviation(e.jurisdiction,"title",b,e.type);this.transform.abbrevs[v].title&&this.transform.abbrevs[v].title[b]&&(e["title-short"]=this.transform.abbrevs[v].title[b])}if(e["container-title-short"]||(e["container-title-short"]=e.journalAbbreviation),e["container-title"]&&this.sys.getAbbreviation){b=this.sys.normalizeAbbrevsKey?this.sys.normalizeAbbrevsKey(e["container-title"]):e["container-title"];v=this.transform.loadAbbreviation(e.jurisdiction,"container-title",b);this.transform.abbrevs[v]["container-title"]&&this.transform.abbrevs[v]["container-title"][b]&&(e["container-title-short"]=this.transform.abbrevs[v]["container-title"][b])}return e.jurisdiction&&(e.country=e.jurisdiction.split(":")[0]),this.registry.refhash[t]=e},xt.Engine.prototype.setOpt=function(t,e,i){"style"===t.name||"cslstyle"===t.name?(this.opt.inheritedAttributes[e]=i,this.citation.opt.inheritedAttributes[e]=i,this.bibliography.opt.inheritedAttributes[e]=i):-1<["citation","bibliography"].indexOf(t.name)?this[t.name].opt.inheritedAttributes[e]=i:t.strings[e]=i},xt.Engine.prototype.inheritOpt=function(t,e,i,s){if(void 0!==t.strings[e])return t.strings[e];var r=this[this.tmp.root].opt.inheritedAttributes[i||e];return void 0!==r?r:s},(t.exports=xt).Engine.prototype.remapSectionVariable=function(t){for(var e=0,i=t.length;e<i;e+=1){var s=t[e][0],r=t[e][1];if(-1<["bill","gazette","legislation","regulation","treaty"].indexOf(s.type)){if(r.locator)r.locator=r.locator.trim(),(a=r.locator.match(xt.STATUTE_SUBDIV_PLAIN_REGEX_FRONT))||(r.label?r.locator=xt.STATUTE_SUBDIV_STRINGS_REVERSE[r.label]+" "+r.locator:r.locator="p. "+r.locator);var n=null;if(s.section)s.section=s.section.trim(),n=(a=s.section.match(xt.STATUTE_SUBDIV_PLAIN_REGEX_FRONT))?a[0].trim():(s.section="sec. "+s.section,"sec.");if(s.section)if(r.locator){var a,o=" ";(a=r.locator.match(/^([^ ]*)\s*(.*)/))?("p."===a[1]&&"p."!==n&&(r.locator=a[2]),-1<["[","(",".",",",";",":","?"].indexOf(r.locator.slice(0,1))&&(o="")):o="",r.locator=s.section+o+r.locator}else r.locator=s.section;r.label=""}}},xt.Engine.prototype.setNumberLabels=function(t){if(t.number&&-1<["bill","gazette","legislation","regulation","treaty"].indexOf(t.type)&&this.opt.development_extensions.static_statute_locator&&!this.tmp.shadow_numbers.number){this.tmp.shadow_numbers.number={},this.tmp.shadow_numbers.number.values=[],this.tmp.shadow_numbers.number.plural=0,this.tmp.shadow_numbers.number.numeric=!1,this.tmp.shadow_numbers.number.label=!1;var e=""+t.number,i=(e=e.split("\\").join("")).split(/\s+/)[0],s=xt.STATUTE_SUBDIV_STRINGS[i];if(s){var r=e.match(xt.STATUTE_SUBDIV_GROUPED_REGEX),n=e.split(xt.STATUTE_SUBDIV_PLAIN_REGEX);if(1<n.length){for(var a=[],o=1,l=n.length;o<l;o+=1){r[o-1].replace(/^\s*/,"");a.push(n[o].replace(/\s*$/,"").replace(/^\s*/,""))}e=a.join(" ")}else e=n[0];this.tmp.shadow_numbers.number.label=s,this.tmp.shadow_numbers.number.values.push(["Blob",e,!1]),this.tmp.shadow_numbers.number.numeric=!1}else this.tmp.shadow_numbers.number.values.push(["Blob",e,!1]),this.tmp.shadow_numbers.number.numeric=!0}},(t.exports=xt).substituteOne=function(i){return function(t,e){return e?i.replace("%%STRING%%",e):""}},xt.substituteTwo=function(e){return function(t){var i=e.replace("%%PARAM%%",t);return function(t,e){return e?i.replace("%%STRING%%",e):""}}},xt.Mode=function(t){var e,i,s,r,n,a;for(s in e={},i=xt.Output.Formats[t])if("@"===s.slice(0,1)){if(r=!1,n=i[s],a=s.split("/"),"string"==typeof n&&-1<n.indexOf("%%STRING%%"))r=-1<n.indexOf("%%PARAM%%")?xt.substituteTwo(n):xt.substituteOne(n);else if("boolean"!=typeof n||n){if("function"!=typeof n)throw"CSL.Compiler: Bad "+t+" config entry for "+s+": "+n;r=n}else r=xt.Output.Formatters.passthrough;1===a.length?e[a[0]]=r:2===a.length&&(e[a[0]]||(e[a[0]]={}),e[a[0]][a[1]]=r)}else e[s]=i[s];return e},xt.setDecorations=function(t,e){var i,s;for(s in i=[],xt.FORMAT_KEY_SEQUENCE){var r;e[r=xt.FORMAT_KEY_SEQUENCE[s]]&&(i.push([r,e[r]]),delete e[r])}return i},xt.Doppeler=function(t,n){this.split=function(t){n&&(t=n(t));var e=t.match(a);if(!e)return{tags:[],strings:[t]};for(var i=t.split(o),s=e.length-1;-1<s;s--){var r=e[s];"'"===r&&0<i[s+1].length&&(i[s+1]=e[s]+i[s+1],e[s]="")}return{tags:e,strings:i,origStrings:i.slice()}},this.join=function(t){for(var e=t.strings.slice(-1),i=t.tags.length-1;-1<i;i--)e.push(t.tags[i]),e.push(t.strings[i]);return e.reverse(),e.join("")};var a=new RegExp("("+t+")","g"),o=new RegExp(t,"g")},xt.Engine.prototype.normalDecorIsOrphan=function(t,e){if("normal"===e[1]){for(var i,s=!1,r=(i="citation"===this.tmp.area?[this.citation.opt.layout_decorations].concat(t.alldecor):t.alldecor).length-1;-1<r;r+=-1)for(var n=i[r].length-1;-1<n;n+=-1)i[r][n][0]===e[0]&&"normal"!==i[r][n][1]&&(s=!0);if(!s)return!0}return!1},(t.exports=xt).Engine.prototype.getCitationLabel=function(t){var e="",i=this.getTrigraphParams(),s=i[0],r=this.getTerm("reference","short",0);void 0===r&&(r="reference"),r=(r=r.replace(".","")).slice(0,1).toUpperCase()+r.slice(1);for(var n=0,a=xt.NAME_VARIABLES.length;n<a;n+=1){var o=xt.NAME_VARIABLES[n];if(t[o]){var l=t[o];s=l.length>i.length?i[i.length-1]:i[l.length-1];for(var u=0,p=l.length;u<p&&u!==s.authors.length;u+=1){var h=this.nameOutput.getName(l[u],"locale-translit",!0).name;h&&h.family?r=(r=h.family).replace(/^([ \'\u2019a-z]+\s+)/,""):h&&h.literal&&(r=h.literal);var c=r.toLowerCase().match(/^(a\s+|the\s+|an\s+)/);if(c&&(r=r.slice(c[1].length)),!(r=r.replace(xt.ROMANESQUE_NOT_REGEXP,"")))break;1<(r=r.slice(0,s.authors[u])).length?r=r.slice(0,1).toUpperCase()+r.slice(1).toLowerCase():1===r.length&&(r=r.toUpperCase()),e+=r}break}}if(!e&&t.title){var f=this.locale[this.opt.lang].opts["skip-words"],m=t.title.split(/\s+/);for(n=m.length-1;-1<n;n--)-1<f.indexOf(m[n])&&(m=m.slice(0,n).concat(m.slice(n+1)));var d=m.join("");1<(d=d.slice(0,i[0].authors[0])).length?d=d.slice(0,1).toUpperCase()+d.slice(1).toLowerCase():1===d.length&&(d=d.toUpperCase()),e=d}var g="0000";return t.issued&&t.issued.year&&(g=""+t.issued.year),e+=g=g.slice(-1*s.year)},xt.Engine.prototype.getTrigraphParams=function(){var t=[],e=this.opt.trigraph.split(":");if(!this.opt.trigraph||"A"!==this.opt.trigraph.slice(0,1))throw"Bad trigraph definition: "+this.opt.trigraph;for(var i=0,s=e.length;i<s;i+=1){for(var r=e[i],n={authors:[],year:0},a=0,o=r.length;a<o;a+=1)switch(r.slice(a,a+1)){case"A":n.authors.push(1);break;case"a":n.authors[n.authors.length-1]+=1;break;case"0":n.year+=1;break;default:throw"Invalid character in trigraph definition: "+this.opt.trigraph}t.push(n)}return t},(t.exports=xt).Engine.prototype.setOutputFormat=function(t){this.opt.mode=t,this.fun.decorate=xt.Mode(t),this.output[t]||(this.output[t]={},this.output[t].tmp={})},xt.Engine.prototype.getSortFunc=function(){return function(t,e){return t=t.split("-"),e=e.split("-"),t.length<e.length?1:t.length>e.length?-1:(t=t.slice(-1)[0],e=e.slice(-1)[0],t.length<e.length?1:t.length>e.length?-1:0)}},xt.Engine.prototype.setLangTagsForCslSort=function(t){var e,i;if(t)for(this.opt["locale-sort"]=[],e=0,i=t.length;e<i;e+=1)this.opt["locale-sort"].push(t[e]);this.opt["locale-sort"].sort(this.getSortFunc())},xt.Engine.prototype.setLangTagsForCslTransliteration=function(t){var e,i;if(this.opt["locale-translit"]=[],t)for(e=0,i=t.length;e<i;e+=1)this.opt["locale-translit"].push(t[e]);this.opt["locale-translit"].sort(this.getSortFunc())},xt.Engine.prototype.setLangTagsForCslTranslation=function(t){var e,i;if(this.opt["locale-translat"]=[],t)for(e=0,i=t.length;e<i;e+=1)this.opt["locale-translat"].push(t[e]);this.opt["locale-translat"].sort(this.getSortFunc())},xt.Engine.prototype.setLangPrefsForCites=function(t,e){var i=this.opt["cite-lang-prefs"];e||(e=function(t){return t.toLowerCase()});for(var s=["Persons","Institutions","Titles","Journals","Publishers","Places"],r=0,n=s.length;r<n;r+=1){var a=e(s[r]),o=s[r].toLowerCase();if(t[a]){for(var l=[];1<t[a].length;)l.push(t[a].pop());var u={orig:1,translit:2,translat:3};for(2===l.length&&u[l[0]]<u[l[1]]&&l.reverse();l.length;)t[a].push(l.pop());for(var p=i[o];p.length;)p.pop();for(var h=0,c=t[a].length;h<c;h+=1)p.push(t[a][h])}}},xt.Engine.prototype.setLangPrefsForCiteAffixes=function(t){if(t&&48===t.length){for(var e,i=this.opt.citeAffixes,s=0,r=["persons","institutions","titles","journals","publishers","places"],n=["translit","orig","translit","translat"],a=0,o=r.length;a<o;a+=1)for(var l=0,u=n.length;l<u;l+=1)e="",s%8==4&&(i[r[a]]["locale-"+n[l]].prefix||i[r[a]]["locale-"+n[l]].suffix)||(e=t[s]?t[s]:"",i[r[a]]["locale-"+n[l]].prefix=e,e=t[s]?t[s+1]:"",i[r[a]]["locale-"+n[l]].suffix=e),s+=2;this.opt.citeAffixes=i}},xt.Engine.prototype.setAutoVietnameseNamesOption=function(t){this.opt["auto-vietnamese-names"]=!!t},xt.Engine.prototype.setAbbreviations=function(t){this.sys.setAbbreviations&&this.sys.setAbbreviations(t)},xt.Engine.prototype.setSuppressTrailingPunctuation=function(t){this.citation.opt.suppressTrailingPunctuation=!!t},(t.exports=xt).Output={},xt.Output.Queue=function(t){this.levelname=["top"],this.state=t,this.queue=[],this.empty=new xt.Token("empty");var e={};e.empty=this.empty,this.formats=new xt.Stack(e),this.current=new xt.Stack(this.queue)},xt.Output.Queue.prototype.pop=function(){var t=this.current.value();return t.length?t.pop():t.blobs.pop()},xt.Output.Queue.prototype.getToken=function(t){return this.formats.value()[t]},xt.Output.Queue.prototype.mergeTokenStrings=function(t,e){var i,s,r;if(r=i=this.formats.value()[t],s=this.formats.value()[e]){i||((i=new xt.Token(t,xt.SINGLETON)).decorations=[]),r=new xt.Token(t,xt.SINGLETON);var n="";for(var n in i.strings)i.strings.hasOwnProperty(n)&&(r.strings[n]=i.strings[n]);for(var n in s.strings)s.strings.hasOwnProperty(n)&&(r.strings[n]=s.strings[n]);r.decorations=i.decorations.concat(s.decorations)}return r},xt.Output.Queue.prototype.addToken=function(t,e,i){var s,r;if(s=new xt.Token("output"),"string"==typeof i&&(i=this.formats.value()[i]),i&&i.strings){for(r in i.strings)i.strings.hasOwnProperty(r)&&(s.strings[r]=i.strings[r]);s.decorations=i.decorations}"string"==typeof e&&(s.strings.delimiter=e),this.formats.value()[t]=s},xt.Output.Queue.prototype.pushFormats=function(t){t||(t={}),t.empty=this.empty,this.formats.push(t)},xt.Output.Queue.prototype.popFormats=function(t){this.formats.pop()},xt.Output.Queue.prototype.startTag=function(t,e){var i={};this.state.tmp["doing-macro-with-date"]&&this.state.tmp.extension&&(e=this.empty,t="empty"),i[t]=e,this.pushFormats(i),this.openLevel(t)},xt.Output.Queue.prototype.endTag=function(t){this.closeLevel(t),this.popFormats()},xt.Output.Queue.prototype.openLevel=function(t,e){var i,s;if("object"==typeof t)i=new xt.Blob(void 0,t);else if(void 0===t)i=new xt.Blob(void 0,this.formats.value().empty,"empty");else{if(!this.formats.value()||!this.formats.value()[t])throw'CSL processor error: call to nonexistent format token "'+t+'"';i=new xt.Blob(void 0,this.formats.value()[t],t)}s=this.current.value(),!this.state.tmp.just_looking&&this.checkNestedBrace&&(i.strings.prefix=this.checkNestedBrace.update(i.strings.prefix)),s.push(i),this.current.push(i)},xt.Output.Queue.prototype.closeLevel=function(t){t&&t!==this.current.value().levelname&&xt.error("Level mismatch error:  wanted "+t+" but found "+this.current.value().levelname);var e=this.current.pop();!this.state.tmp.just_looking&&this.checkNestedBrace&&(e.strings.suffix=this.checkNestedBrace.update(e.strings.suffix))},xt.Output.Queue.prototype.append=function(t,e,i,s,r){var n,a,o,l=!0;if(i&&(s=!0),this.state.tmp["doing-macro-with-date"]&&!i){if("macro-with-date"!==e)return!1;"macro-with-date"===e&&(e="empty")}if(void 0===t)return!1;if("number"==typeof t&&(t=""+t),!i&&this.state.tmp.element_trace&&"suppress-me"===this.state.tmp.element_trace.value())return!1;if(a=!1,e?"literal"===e?l=!(n=!0):n="string"==typeof e?this.formats.value()[e]:e:n=this.formats.value().empty,!n)throw"CSL processor error: unknown format token name: "+e;if(n.strings&&void 0===n.strings.delimiter&&(n.strings.delimiter=""),"string"==typeof t&&t.length&&(t=t.replace(/ ([:;?!\u00bb])/g," $1").replace(/\u00ab /g,"« "),this.last_char_rendered=t.slice(-1),t=t.replace(/\s+'/g," '"),i||(t=t.replace(/^'/g," '")),s?i&&(this.state.tmp.term_predecessor_name=!0):(this.state.tmp.term_predecessor=!0,this.state.tmp.in_cite_predecessor=!0)),a=new xt.Blob(t,n),void 0===(o=this.current.value())&&0===this.current.mystack.length&&(this.current.mystack.push([]),o=this.current.value()),"string"==typeof a.blobs&&(s?i&&(this.state.tmp.term_predecessor_name=!0):(this.state.tmp.term_predecessor=!0,this.state.tmp.in_cite_predecessor=!0)),i||this.state.parallel.AppendBlobPointer(o),"string"==typeof t){if("string"==typeof a.blobs&&" "!==a.blobs.slice(0,1)){for(var u="",p=a.blobs;-1<xt.TERMINAL_PUNCTUATION.indexOf(p.slice(0,1));)u+=p.slice(0,1),p=p.slice(1);p&&u&&(a.strings.prefix=a.strings.prefix+u,a.blobs=p)}a.strings["text-case"]&&(a.blobs=xt.Output.Formatters[a.strings["text-case"]](this.state,t)),this.state.tmp.strip_periods&&!r&&(a.blobs=a.blobs.replace(/\.([^a-z]|$)/g,"$1"));for(var h=a.decorations.length-1;-1<h;h+=-1)"@quotes"===a.decorations[h][0]&&"false"!==a.decorations[h][1]&&(a.punctuation_in_quote=this.state.getOpt("punctuation-in-quote")),a.blobs.match(xt.ROMANESQUE_REGEXP)||"@font-style"===a.decorations[h][0]&&(a.decorations=a.decorations.slice(0,h).concat(a.decorations.slice(h+1)));o.push(a),this.state.fun.flipflopper.processTags(a)}else l?o.push(a):o.push(t);return!0},xt.Output.Queue.prototype.string=function(t,e,i){var s,r=xt.getSafeEscape(this.state),n=e.slice(),a=[];if(0===n.length)return a;var o,l,u,p,h="";i?h=i.strings.delimiter:(t.tmp.count_offset_characters=!1,t.tmp.offset_characters=0),i&&i.new_locale&&(i.old_locale=t.opt.lang,t.opt.lang=i.new_locale);for(var c=0,f=n.length;c<f;c+=1){if((o=n[c]).strings.first_blob&&(t.tmp.count_offset_characters=o.strings.first_blob),"string"==typeof o.blobs){if("number"==typeof o.num)a.push(o);else if(o.blobs){o.particle&&(o.blobs=o.particle+o.blobs,o.particle="");var m=(s=r(o.blobs)).length;if(!t.tmp.suppress_decorations)for(b=0,_=o.decorations.length;b<_;b+=1)"@showid"!==(p=o.decorations[b])[0]&&(t.normalDecorIsOrphan(o,p)||(s=t.fun.decorate[p[0]][p[1]].call(o,t,s,p[2])));if(s&&s.length){if(s=r(o.strings.prefix)+s+r(o.strings.suffix),(t.opt.development_extensions.csl_reverse_lookup_support||t.sys.csl_reverse_lookup_support)&&!t.tmp.suppress_decorations)for(b=0,_=o.decorations.length;b<_;b+=1)"@showid"===(p=o.decorations[b])[0]&&(s=t.fun.decorate[p[0]][p[1]].call(o,t,s,p[2]));a.push(s),t.tmp.count_offset_characters&&(t.tmp.offset_characters+=m+o.strings.suffix.length+o.strings.prefix.length)}}}else if(o.blobs.length){var d=t.output.string(t,o.blobs,o);if(i&&"string"!==d&&1<d.length&&o.strings.delimiter)for(var g=!1,b=0,_=d.length;b<_;b++)"string"!=typeof d[b]?g=!0:g&&(d[b]=o.strings.delimiter+d[b]);a=a.concat(d)}o.strings.first_blob&&t.registry.registry[o.strings.first_blob]&&(t.registry.registry[o.strings.first_blob].offset=t.tmp.offset_characters,t.tmp.count_offset_characters=!1)}for(c=0,f=a.length-1;c<f;c+=1)"number"!=typeof a[c].num||"number"!=typeof a[c+1].num||a[c+1].UGLY_DELIMITER_SUPPRESS_HACK||(a[c].strings.suffix=a[c].strings.suffix+(h||""),a[c+1].successor_prefix="",a[c+1].UGLY_DELIMITER_SUPPRESS_HACK=!0);var v=0;for(c=0,f=a.length;c<f;c+=1)"string"==typeof a[c]&&(v=parseInt(c,10)+1,c<a.length-1&&"object"==typeof a[c+1]&&(h&&!a[c+1].UGLY_DELIMITER_SUPPRESS_HACK&&(a[c]+=r(h)),a[c+1].UGLY_DELIMITER_SUPPRESS_HACK=!0));if(i&&(i.decorations.length||i.strings.suffix))v=a.length;else if(i&&i.strings.prefix)for(c=0,f=a.length;c<f;c++)if(void 0!==a[c].num){0===(v=c)&&(a[c].strings.prefix=i.strings.prefix+a[c].strings.prefix);break}var y=t.output.renderBlobs(a.slice(0,v),h,!1,i);if(y&&i&&(i.decorations.length||i.strings.suffix||i.strings.prefix)){if(!t.tmp.suppress_decorations)for(c=0,f=i.decorations.length;c<f;c+=1)p=i.decorations[c],-1<["@cite","@bibliography","@display","@showid"].indexOf(p[0])||t.normalDecorIsOrphan(o,p)||"string"==typeof y&&(y=t.fun.decorate[p[0]][p[1]].call(i,t,y,p[2]));if(s=y,l=i.strings.suffix,s&&s.length&&(s=r(u=i.strings.prefix)+s+r(l),t.tmp.count_offset_characters&&(t.tmp.offset_characters+=u.length+l.length)),y=s,!t.tmp.suppress_decorations)for(c=0,f=i.decorations.length;c<f;c+=1)p=i.decorations[c],-1!==["@cite","@bibliography","@display","@showid"].indexOf(p[0])&&"string"==typeof y&&(y=t.fun.decorate[p[0]][p[1]].call(i,t,y,p[2]))}var x=a.slice(v,a.length);return!x.length&&y?a=[y]:x.length&&!y?a=x:y&&x.length&&(a=[y].concat(x)),void 0===i?(this.queue=[],this.current.mystack=[],this.current.mystack.push(this.queue),t.tmp.suppress_decorations&&(a=t.output.renderBlobs(a,void 0,!1))):"boolean"==typeof i&&(a=t.output.renderBlobs(a,void 0,!0)),i&&i.new_locale&&(t.opt.lang=i.old_locale),a},xt.Output.Queue.prototype.clearlevel=function(){var t,e,i;for(i=(t=this.current.value()).blobs.length,e=0;e<i;e+=1)t.blobs.pop()},xt.Output.Queue.prototype.renderBlobs=function(t,e,i,s){var r,n,a,o,l,u,p,h,c,f,m;if(m=xt.getSafeEscape(this.state),e||(e=""),r=this.state,a=n="",u=t.length,"citation"===this.state.tmp.area&&!this.state.tmp.just_looking&&1===u&&"object"==typeof t[0]&&s)return t[0].strings.prefix=s.strings.prefix+t[0].strings.prefix,t[0].strings.suffix=t[0].strings.suffix+s.strings.suffix,t[0].decorations=t[0].decorations.concat(s.decorations),t[0].params=s.params,t[0];var d=!0;for(l=0;l<u;l+=1)d=t[l].checkNext?(t[l].checkNext(t[l+1],d),!1):!t[l+1]||!t[l+1].splice_prefix;var g=!0;for(l=t.length-1;0<l;l+=-1)t[l].checkLast?g&&t[l].checkLast(t[l-1])&&(g=!1):g=!0;for(u=t.length,l=0;l<u;l+=1)if(n&&(a=e),"string"==typeof(o=t[l]))n+=m(a),n+=o,r.tmp.count_offset_characters&&(r.tmp.offset_characters+=a.length);else if(i)n=n?[n,o]:[o];else if(o.status!==xt.SUPPRESS){var b=(c=o.particle?o.particle+o.num:o.formatter.format(o.num,o.gender)).replace(/<[^>]*>/g,"").length;this.append(c,"empty",!0);var _=this.pop(),v=r.tmp.count_offset_characters;if(c=this.string(r,[_],!1),r.tmp.count_offset_characters=v,o.strings["text-case"]&&(c=xt.Output.Formatters[o.strings["text-case"]](this.state,c)),c&&this.state.tmp.strip_periods&&(c=c.replace(/\.([^a-z]|$)/g,"$1")),!r.tmp.suppress_decorations)for(h=o.decorations.length,p=0;p<h;p+=1)f=o.decorations[p],r.normalDecorIsOrphan(o,f)||(c=r.fun.decorate[f[0]][f[1]].call(o,r,c,f[2]));c=m(o.strings.prefix)+c+m(o.strings.suffix);var y="";o.status===xt.END?y=m(o.range_prefix):o.status===xt.SUCCESSOR?y=m(o.successor_prefix):o.status===xt.START?y=0<l&&!o.suppress_splice_prefix?m(o.splice_prefix):"":o.status===xt.SEEN&&(y=m(o.splice_prefix)),n+=y,n+=c,r.tmp.count_offset_characters&&(r.tmp.offset_characters+=y.length+o.strings.prefix.length+b+o.strings.suffix.length)}return n},xt.Output.Queue.purgeEmptyBlobs=function(t){if("object"==typeof t&&"object"==typeof t.blobs&&t.blobs.length)for(var e=t.blobs.length-1;-1<e;e--){xt.Output.Queue.purgeEmptyBlobs(t.blobs[e]);var i=t.blobs[e];if(!i||!i.blobs||!i.blobs.length){for(var s=[];t.blobs.length-1>e;)s.push(t.blobs.pop());for(t.blobs.pop();s.length;)t.blobs.push(s.pop())}}},xt.Output.Queue.adjust=function(f){var t={";":!0,":":!0},e={".":!0,"!":!0,"?":!0};this.upward=function(t){{if(t.blobs&&"string"==typeof t.blobs)return void(m[t.strings.suffix.slice(0,1)]&&t.strings.suffix.slice(0,1)===t.blobs.slice(-1)&&(t.strings.suffix=t.strings.suffix.slice(1)));if("object"!=typeof t||"object"!=typeof t.blobs||!t.blobs.length)return}for(var e=y(t,!0),i=t.blobs.length-1;-1<i;i--){t.blobs.length;this.upward(t.blobs[i]);var s=t.strings,r=t.blobs[i].strings;if(0===i){" "===s.prefix.slice(-1)&&" "===r.prefix.slice(0,1)&&(r.prefix=r.prefix.slice(1));var n=r.prefix.slice(0,1);e||!g[n]||s.prefix||(s.prefix+=n,r.prefix=r.prefix.slice(1))}if(i===t.blobs.length-1){var n=r.suffix.slice(-1);!e&&-1<[" "].indexOf(n)&&(s.suffix.slice(0,1)!==n&&(s.suffix=n+s.suffix),r.suffix=r.suffix.slice(0,-1))}s.delimiter&&0<i&&g[s.delimiter.slice(-1)]&&s.delimiter.slice(-1)===r.prefix.slice(0,1)&&(r.prefix=r.prefix.slice(1))}},this.leftward=function(t){if("object"!=typeof t||"object"!=typeof t.blobs||!t.blobs.length)return;for(var e=t.blobs.length-1;-1<e;e--)if(this.leftward(t.blobs[e]),e<t.blobs.length-1&&!t.strings.delimiter){var i=t.blobs[e],s=i.strings.suffix.slice(-1),r=t.blobs[e+1],n=r.strings.prefix.slice(0,1),a=y(i)||y(r),o="number"==typeof s||"number"==typeof n;if(!a&&!o&&m[n]&&!o){var l=n===i.strings.suffix.slice(-1),u=!i.strings.suffix&&"string"==typeof i.blobs&&i.blobs.slice(-1)===n;l||u?r.strings.prefix=r.strings.prefix.slice(1):S(i,"suffix",r,"prefix")}}},this.downward=function(t,e){{if(t.blobs&&"string"==typeof t.blobs)return void(m[t.strings.suffix.slice(0,1)]&&t.strings.suffix.slice(0,1)===t.blobs.slice(-1)&&(t.strings.suffix=t.strings.suffix.slice(1)));if("object"!=typeof t||"object"!=typeof t.blobs||!t.blobs.length)return}for(var i=t.strings,s=0,r=t.blobs.length;s<r&&!_(t.blobs[s]);s++);if(i.delimiter&&m[i.delimiter.slice(0,1)]){for(var n=i.delimiter.slice(0,1),s=t.blobs.length-2;-1<s;s--){var a=t.blobs[s].strings;a.suffix.slice(-1)!==n&&(a.suffix+=n)}i.delimiter=i.delimiter.slice(1)}y(t,!0),_(t);for(var s=t.blobs.length-1;-1<s;s--){var o=t.blobs[s],a=t.blobs[s].strings,l=y(o,!0),u=_(o);if(s===t.blobs.length-1){var p=i.suffix.slice(0,1),h=!1;m[p]&&!(h=I(p,o))&&f&&(h=x(o)),h&&m[p]&&(v(o)||("string"==typeof o.blobs?S(o,"blobs",t,"suffix"):S(o,"suffix",t,"suffix"),"."===i.suffix.slice(0,1)&&(a.suffix+=i.suffix.slice(0,1),i.suffix=i.suffix.slice(1))))," "===a.suffix.slice(-1)&&" "===i.suffix.slice(0,1)&&(i.suffix=i.suffix.slice(1)),g[a.suffix.slice(0,1)]&&("string"==typeof o.blobs&&o.blobs.slice(-1)===a.suffix.slice(0,1)&&(a.suffix=a.suffix.slice(1)),a.suffix.slice(-1)===i.suffix.slice(0,1)&&(i.suffix=i.suffix.slice(0,-1))),O(t,t.strings.suffix.slice(0,1))&&(t.strings.suffix=t.strings.suffix.slice(1))}else if(i.delimiter)g[i.delimiter.slice(0,1)]&&i.delimiter.slice(0,1)===a.suffix.slice(-1)&&(t.blobs[s].strings.suffix=t.blobs[s].strings.suffix.slice(0,-1));else{var c=t.blobs[s+1].strings;_(o)||l||!g[a.suffix.slice(-1)]||a.suffix.slice(-1)!==c.prefix.slice(0,1)||(c.prefix=c.prefix.slice(1))}u||l||!m[a.suffix.slice(0,1)]||"string"!=typeof o.blobs||S(o,"blobs",o,"suffix"),this.downward(t.blobs[s])}},this.fix=function(t){if("object"!=typeof t||"object"!=typeof t.blobs||!t.blobs.length)return;for(var e,i=0,s=t.blobs.length;i<s;i++){for(var r=t.blobs[i],n=!1,a=0,o=r.decorations.length;a<o;a++){var l=r.decorations[a];"@quotes"===l[0]&&"false"!==l[1]&&(n=!0)}n&&(f?u(r):p(r)),e=this.fix(t.blobs[i]),r.blobs&&"string"==typeof r.blobs&&(e=r.blobs.slice(-1))}return e};var d={"!":{".":"!","?":"!?",":":"!",",":"!,",";":"!;"},"?":{"!":"?!",".":"?",":":"?",",":"?,",";":"?;"},".":{"!":".!","?":".?",":":".:",",":".,",";":".;"},":":{"!":"!","?":"?",".":":",",":":,",";":":;"},",":{"!":",!","?":",?",":":",:",".":",.",";":",;"},";":{"!":"!","?":"?",":":";",",":";,",".":";"}},i={},s={},m={},g={};for(var r in d)m[r]=!0,g[r]=!0,t[r]||(i[r]=!0),e[r]||(s[r]=!0);g[" "]=!0,g[" "]=!0;var b={};for(var r in d)for(var n in d[r])b[n]||(b[n]={}),b[n][r]=d[r][n];function _(t){return"number"==typeof t.num||t.blobs&&1===t.blobs.length&&"number"==typeof t.blobs[0].num}function v(t){return"number"==typeof t.num||!(!t.blobs||"object"!=typeof t.blobs)&&(!!v(t.blobs[t.blobs.length-1])||void 0)}function y(t,e){var i=!1,s=["@font-style","@font-variant","@font-weight","@text-decoration","@vertical-align"];if(e&&s.push("@quotes"),t.decorations)for(var r=0,n=t.decorations.length;r<n;r++)if(-1<s.indexOf(t.decorations[r][0])){i=!0;break}return i}function x(t){if(t.decorations)for(var e=0,i=t.decorations.length;e<i;e++)if("@quotes"===t.decorations[e][0]&&"false"!==t.decorations[e][1])return!0;return"object"==typeof t.blobs&&x(t.blobs[t.blobs.length-1])}function I(t,e){var i=e.strings.suffix.slice(-1);i||"string"!=typeof e.blobs||(i=e.blobs.slice(-1));var s=b[t][i];return!(!s||1!==s.length)||"object"==typeof e.blobs&&!!I(t,e.blobs[e.blobs.length-1])}function O(t,e){if(!m[e])return!1;if("string"==typeof t.blobs)return t.blobs.slice(-1)===e;var i=t.blobs[t.blobs.length-1];return!!i&&(i.strings.suffix.slice(-1)?i.strings.suffix.slice(-1)==e:O(i,e))}function S(t,e,i,s,r){var n="blobs"===e?t:t.strings,a="blobs"===s?i:i.strings,o=n[e].slice(-1),l=a[s].slice(0,1);function u(){a[s]=a[s].slice(1)}function p(){n[e]=n[e].slice(0,-1)}function h(t){a[s]=t+a[s]}function c(t){n[e]+=t}var f=r?function(){return d[o]}:function(){return b[l]};var m=r?function(){var t=d[o][l];"string"==typeof t?(p(),u(),h(t)):(h(o),p())}:function(){var t=b[l][o];"string"==typeof t?(p(),u(),c(t)):(c(l),u())};o===l?(r?p:u)():f()&&m()}function u(t){var e=t.strings.suffix.slice(0,1);if("string"==typeof t.blobs)for(;i[e];)S(t,"blobs",t,"suffix"),e=t.strings.suffix.slice(0,1);else for(;i[e];)S(t.blobs[t.blobs.length-1],"suffix",t,"suffix"),e=t.strings.suffix.slice(0,1)}function p(t){if("string"==typeof t.blobs)for(var e=t.blobs.slice(-1);s[e];)S(t,"blobs",t,"suffix",!0),e=t.blobs.slice(-1);else for(e=t.blobs[t.blobs.length-1].strings.suffix.slice(-1);s[e];)S(t.blobs[t.blobs.length-1],"suffix",t,"suffix",!0),e=t.blobs[t.blobs.length-1].strings.suffix.slice(-1)}},(t.exports=xt).Engine.Opt=function(){this.has_disambiguate=!1,this.mode="html",this.dates={},this.jurisdictions_seen={},this.suppressedJurisdictions={},this.inheritedAttributes={},this["locale-sort"]=[],this["locale-translit"]=[],this["locale-translat"]=[],this.citeAffixes={persons:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},institutions:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},titles:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},journals:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},publishers:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},places:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}}},this["default-locale"]=[],this.update_mode=xt.NONE,this.bib_mode=xt.NONE,this.sort_citations=!1,this["et-al-min"]=0,this["et-al-use-first"]=1,this["et-al-use-last"]=!1,this["et-al-subsequent-min"]=!1,this["et-al-subsequent-use-first"]=!1,this["demote-non-dropping-particle"]="display-and-sort",this["parse-names"]=!0,this.citation_number_slug=!1,this.trigraph="Aaaa00:AaAa00:AaAA00:AAAA00",this.nodenames=[],this.gender={},this["cite-lang-prefs"]={persons:["orig"],institutions:["orig"],titles:["orig"],journals:["orig"],publishers:["orig"],places:["orig"],number:["orig"]},this.has_layout_locale=!1,this.development_extensions={},this.development_extensions.field_hack=!0,this.development_extensions.allow_field_hack_date_override=!0,this.development_extensions.locator_date_and_revision=!0,this.development_extensions.locator_parsing_for_plurals=!0,this.development_extensions.locator_label_parse=!0,this.development_extensions.raw_date_parsing=!0,this.development_extensions.clean_up_csl_flaws=!0,this.development_extensions.flip_parentheses_to_braces=!0,this.development_extensions.jurisdiction_subfield=!0,this.development_extensions.static_statute_locator=!1,this.development_extensions.csl_reverse_lookup_support=!1,this.development_extensions.clobber_locator_if_no_statute_section=!1,this.development_extensions.wrap_url_and_doi=!1,this.development_extensions.allow_force_lowercase=!1,this.development_extensions.handle_parallel_articles=!1,this.development_extensions.thin_non_breaking_space_html_hack=!1,this.development_extensions.apply_citation_wrapper=!1,this.development_extensions.main_title_from_short_title=!1,this.development_extensions.uppercase_subtitles=!1,this.development_extensions.normalize_lang_keys_to_lowercase=!1,this.development_extensions.strict_text_case_locales=!1,this.development_extensions.rtl_support=!1,this.development_extensions.expect_and_symbol_form=!1,this.development_extensions.require_explicit_legal_case_title_short=!1,this.development_extensions.spoof_institutional_affiliations=!1,this.development_extensions.force_jurisdiction=!1,this.development_extensions.parse_names=!0},xt.Engine.Tmp=function(){this.names_max=new xt.Stack,this.names_base=new xt.Stack,this.givens_base=new xt.Stack,this.value=[],this.namepart_decorations={},this.namepart_type=!1,this.area="citation",this.root="citation",this.extension="",this.can_substitute=new xt.Stack(0,xt.LITERAL),this.element_rendered_ok=!1,this.element_trace=new xt.Stack("style"),this.nameset_counter=0,this.group_context=new xt.Stack({term_intended:!1,variable_attempt:!1,variable_success:!1,output_tip:void 0,label_form:void 0,parallel_conditions:void 0,condition:!1,force_suppress:!1,done_vars:[]}),this.term_predecessor=!1,this.in_cite_predecessor=!1,this.jump=new xt.Stack(0,xt.LITERAL),this.decorations=new xt.Stack,this.tokenstore_stack=new xt.Stack,this.last_suffix_used="",this.last_names_used=[],this.last_years_used=[],this.years_used=[],this.names_used=[],this.taintedItemIDs={},this.taintedCitationIDs={},this.initialize_with=new xt.Stack,this.disambig_request=!1,this["name-as-sort-order"]=!1,this.suppress_decorations=!1,this.disambig_settings=new xt.AmbigConfig,this.bib_sort_keys=[],this.prefix=new xt.Stack("",xt.LITERAL),this.suffix=new xt.Stack("",xt.LITERAL),this.delimiter=new xt.Stack("",xt.LITERAL),this.cite_locales=[],this.cite_affixes={citation:!1,bibliography:!1,citation_sort:!1,bibliography_sort:!1},this.strip_periods=0,this.shadow_numbers={},this.authority_stop_last=0,this.loadedItemIDs={}},xt.Engine.Fun=function(t){this.match=new xt.Util.Match,this.suffixator=new xt.Util.Suffixator(xt.SUFFIX_CHARS),this.romanizer=new xt.Util.Romanizer,this.ordinalizer=new xt.Util.Ordinalizer(t),this.long_ordinalizer=new xt.Util.LongOrdinalizer},xt.Engine.Build=function(){this["alternate-term"]=!1,this.in_bibliography=!1,this.in_style=!1,this.skip=!1,this.postponed_macro=!1,this.layout_flag=!1,this.name=!1,this.form=!1,this.term=!1,this.macro={},this.macro_stack=[],this.text=!1,this.lang=!1,this.area="citation",this.root="citation",this.extension="",this.substitute_level=new xt.Stack(0,xt.LITERAL),this.names_level=0,this.render_nesting_level=0,this.render_seen=!1},xt.Engine.Configure=function(){this.fail=[],this.succeed=[]},xt.Engine.Citation=function(t){this.opt={inheritedAttributes:{}},this.tokens=[],this.srt=new xt.Registry.Comparifier(t,"citation_sort"),this.opt.collapse=[],this.opt["disambiguate-add-names"]=!1,this.opt["disambiguate-add-givenname"]=!1,this.opt["disambiguate-add-year-suffix"]=!1,this.opt["givenname-disambiguation-rule"]="by-cite",this.opt["near-note-distance"]=5,this.opt.topdecor=[],this.opt.layout_decorations=[],this.opt.layout_prefix="",this.opt.layout_suffix="",this.opt.layout_delimiter="",this.opt.sort_locales=[],this.opt.max_number_of_names=0,this.root="citation"},xt.Engine.Bibliography=function(){this.opt={inheritedAttributes:{}},this.tokens=[],this.opt.collapse=[],this.opt.topdecor=[],this.opt.layout_decorations=[],this.opt.layout_prefix="",this.opt.layout_suffix="",this.opt.layout_delimiter="",this.opt["line-spacing"]=1,this.opt["entry-spacing"]=1,this.opt.sort_locales=[],this.opt.max_number_of_names=0,this.root="bibliography"},xt.Engine.BibliographySort=function(){this.tokens=[],this.opt={},this.opt.sort_directions=[],this.keys=[],this.opt.topdecor=[],this.root="bibliography"},xt.Engine.CitationSort=function(){this.tokens=[],this.opt={},this.opt.sort_directions=[],this.keys=[],this.opt.topdecor=[],this.root="citation"},(t.exports=xt).Engine.prototype.previewCitationCluster=function(t,e,i,s){var r=this.opt.mode;this.setOutputFormat(s);var n=this.processCitationCluster(t,e,i,xt.PREVIEW);return this.setOutputFormat(r),n[1]},xt.Engine.prototype.appendCitationCluster=function(t){for(var e=[],i=this.registry.citationreg.citationByIndex.length,s=0;s<i;s+=1){var r=this.registry.citationreg.citationByIndex[s];e.push([""+r.citationID,r.properties.noteIndex])}return this.processCitationCluster(t,e,[])[1]},xt.Engine.prototype.processCitationCluster=function(t,e,i,s){var r,n,a,o,l,u,p,h,c,f,m,d;this.debug=!1,this.tmp.loadedItemIDs={};var g,b,_,v={bibchange:!(this.tmp.citation_errors=[])};if(this.setCitationId(t),s===xt.PREVIEW){g=this.registry.citationreg.citationByIndex.slice(),b=this.registry.reflist.slice();for(var y=e.concat([[""+t.citationID,t.properties.noteIndex]]).concat(i),x={},I=[],O=0,S=y.length;O<S;O+=1)for(n=0,a=(r=this.registry.citationreg.citationById[y[O][0]]).citationItems.length;n<a;n+=1)x[r.citationItems[n].id]=!0,I.push(""+r.citationItems[n].id);_={};for(O=0,S=b.length;O<S;O+=1)if(!x[b[O].id]){var A=this.registry.registry[b[O].id].ambig,T=this.registry.ambigcites[A];if(T)for(n=0,a=T.length;n<a;n+=1)_[T[n]]=xt.cloneAmbigConfig(this.registry.registry[T[n]].disambig)}}this.tmp.taintedCitationIDs={};var N=[],E={};for(O=0,S=t.citationItems.length;O<S;O+=1){for(var k in c={},t.citationItems[O])c[k]=t.citationItems[O][k];var w;if((h=this.retrieveItem(""+c.id)).id&&this.transform.loadAbbreviation("default","hereinafter",h.id),c=xt.parseLocator.call(this,c),this.opt.development_extensions.static_statute_locator&&this.remapSectionVariable([[h,c]]),this.opt.development_extensions.locator_label_parse)if(c.locator&&-1===["bill","gazette","legislation","regulation","treaty"].indexOf(h.type)&&(!c.label||"page"===c.label))if(w=xt.LOCATOR_LABELS_REGEXP.exec(c.locator)){var R=xt.LOCATOR_LABELS_MAP[w[2]];this.getTerm(R)&&(c.label=R,c.locator=w[3])}var L=[h,c];N.push(L),t.citationItems[O].item=h}t.sortedItems=N;var j=[];for(O=0,S=e.length;O<S;O+=1){r=e[O];try{this.registry.citationreg.citationById[r[0]].properties.noteIndex=r[1]}catch(t){var C="CSL error\n";throw C+="  "+t+"\n",C+="  citationID="+r[0]+"\n",C+="  noteIndex="+r[1]+"\n",C+="  atarray citationsPre index "+O+", from citation at document position "+e.length}j.push(this.registry.citationreg.citationById[r[0]])}j.push(t);for(O=0,S=i.length;O<S;O+=1){r=i[O];try{this.registry.citationreg.citationById[r[0]].properties.noteIndex=r[1]}catch(t){C="CSL error\n";throw C+="  "+t+"\n",C+="  citationID="+r[0]+"\n",C+="  noteIndex="+r[1]+"\n",C+="  at array citationsPost index "+O+", from citation at document position "+e.length}j.push(this.registry.citationreg.citationById[r[0]])}this.registry.citationreg.citationByIndex=j,this.registry.citationreg.citationsByItemId={},this.opt.update_mode===xt.POSITION&&(m=[],f=[],d={});var P,D=[];for(O=0,S=j.length;O<S;O+=1){for(j[O].properties||(j[O].properties={}),j[O].properties.index=O,n=0,a=j[O].sortedItems.length;n<a;n+=1)c=j[O].sortedItems[n],this.registry.citationreg.citationsByItemId[c[1].id]||(this.registry.citationreg.citationsByItemId[c[1].id]=[],D.push(""+c[1].id)),-1===this.registry.citationreg.citationsByItemId[c[1].id].indexOf(j[O])&&this.registry.citationreg.citationsByItemId[c[1].id].push(j[O]);this.opt.update_mode===xt.POSITION&&(j[O].properties.noteIndex?f.push(j[O]):(j[O].properties.noteIndex=0,m.push(j[O])))}if(s!==xt.ASSUME_ALL_ITEMS_REGISTERED&&this.updateItems(D,null,null,!0),!this.opt.citation_number_sort&&N&&1<N.length&&0<this.citation_sort.tokens.length){for(O=0,S=N.length;O<S;O+=1)N[O][1].sortkeys=xt.getSortKeys.call(this,N[O][0],"citation_sort");if(this.opt.grouped_sort&&!t.properties.unsorted){for(O=0,S=N.length;O<S;O+=1){var U=N[O][1].sortkeys;this.tmp.authorstring_request=!0;var M=this.registry.registry[N[O][0].id].disambig;this.tmp.authorstring_request=!0,xt.getAmbiguousCite.call(this,N[O][0],M);var B=this.registry.authorstrings[N[O][0].id];this.tmp.authorstring_request=!1,N[O][1].sortkeys=[B].concat(U)}N.sort(this.citation.srt.compareCompositeKeys);var X=!1,F=!1,z=!1;for(O=0,S=N.length;O<S;O+=1)N[O][1].sortkeys[0]!==X&&(z=N[O][1].sortkeys[0],F=N[O][1].sortkeys[1]),N[O][1].sortkeys[0]=""+F+O,X=z}t.properties.unsorted||N.sort(this.citation.srt.compareCompositeKeys)}if(this.opt.update_mode===xt.POSITION)for(O=0;O<2;O+=1){var V={},q={};for(n=0,a=(P=[m,f][O]).length;n<a;n+=1){var G=P[n];for(P[n].properties.noteIndex||(P[n].properties.noteIndex=0),P[n].properties.noteIndex=parseInt(P[n].properties.noteIndex,10),0<n&&P[n-1].properties.noteIndex>P[n].properties.noteIndex&&(d={},V={},q={}),o=0,l=G.sortedItems.length;o<l;o+=1)this.registry.registry[G.sortedItems[o][1].id].parallel||(d[G.properties.noteIndex]?d[G.properties.noteIndex]+=1:d[G.properties.noteIndex]=1);for(o=0,l=P[n].sortedItems.length;o<l;o+=1){var $,W=(c=P[n].sortedItems[o])[0].id,K=c[1].locator,H=c[1].label;if(c[0].legislation_id&&(W=c[0].legislation_id),0<o&&($=G.sortedItems[o-1][0].legislation_id?G.sortedItems[o-1][0].legislation_id:G.sortedItems[o-1][1].id),s!==xt.PREVIEW||G.citationID==t.citationID){var Q,J={};if(J.position=c[1].position,J["first-reference-note-number"]=c[1]["first-reference-note-number"],J["near-note"]=c[1]["near-note"],c[1]["first-reference-note-number"]=0,c[1]["near-note"]=!1,this.registry.citationreg.citationsByItemId[W]&&"note"===this.opt.xclass&&this.opt.has_disambiguate){var Y=this.registry.registry[W]["citation-count"],Z=this.registry.citationreg.citationsByItemId[W].length;if(this.registry.registry[W]["citation-count"]=this.registry.citationreg.citationsByItemId[W].length,"number"==typeof Y){if(Y<2!==Z<2)for(var tt=0,et=this.registry.citationreg.citationsByItemId[W].length;tt<et;tt++)E[this.registry.registry[W].ambig]=!0,this.tmp.taintedCitationIDs[this.registry.citationreg.citationsByItemId[W][tt].citationID]=!0}else for(tt=0,et=this.registry.citationreg.citationsByItemId[W].length;tt<et;tt++)E[this.registry.registry[W].ambig]=!0,this.tmp.taintedCitationIDs[this.registry.citationreg.citationsByItemId[W][tt].citationID]=!0}if(void 0===V[W])V[W]=G.properties.noteIndex,this.registry.registry[W]&&(this.registry.registry[W]["first-reference-note-number"]=G.properties.noteIndex),q[W]=G.properties.noteIndex,c[1].position=xt.POSITION_FIRST;else{var it,st,rt,nt,at=!1,ot=!1;if(0<n){try{Q=P[n-1].sortedItems.slice(-1)[0][1].id}catch(t){C="CSL Error\n";throw C+="  "+t,C+="  in citation object "+P[n-1].citationID+" at index "+(n-1)}P[n-1].sortedItems[0].slice(-1)[0].legislation_id&&(Q=P[n-1].sortedItems[0].slice(-1)[0].legislation_id)}if(0<n&&0===parseInt(o,10)&&P[n-1].properties.noteIndex!==P[n].properties.noteIndex){var lt=P[n-1].sortedItems,ut=!1,pt=P[n-1].sortedItems[0][0].id;for(P[n-1].sortedItems[0][0].legislation_id&&(pt=P[n-1].sortedItems[0][0].legislation_id),(pt==W&&P[n-1].properties.noteIndex>=P[n].properties.noteIndex-1||P[n-1].sortedItems[0][1].id==this.registry.registry[c[1].id].parallel)&&(1!==d[P[n-1].properties.noteIndex]&&0!==P[n-1].properties.noteIndex||(ut=!0)),u=0,p=lt.slice(1).length;u<p;u+=1){var ht=lt.slice(1)[u];this.registry.registry[ht[1].id].parallel&&this.registry.registry[ht[1].id].parallel!=this.registry.registry[ht[1].id]||(ut=!1)}ut?at=!0:ot=!0}else 0<o&&$==W?at=!0:0===o&&P[n-1].properties.noteIndex==P[n].properties.noteIndex&&P[n-1].sortedItems.length&&Q==W?at=!0:ot=!0;if(at&&(st=(it=0<o?G.sortedItems[o-1][1]:P[n-1].sortedItems[0][1]).locator?(rt=it.label?it.label:"",""+it.locator+rt):it.locator,nt=K?""+K+(H||""):K),at&&st&&!nt&&(ot=!(at=!1)),at&&(!st&&nt?c[1].position=xt.POSITION_IBID_WITH_LOCATOR:st||nt?st&&nt===st?c[1].position=xt.POSITION_IBID:st&&nt&&nt!==st?c[1].position=xt.POSITION_IBID_WITH_LOCATOR:ot=!(at=!1):c[1].position=xt.POSITION_IBID),ot&&(c[1].position=xt.POSITION_SUBSEQUENT),(ot||at)&&V[W]!=G.properties.noteIndex&&(c[1]["first-reference-note-number"]=V[W],this.registry.registry[W])){var ct=this.registry.citationreg.citationsByItemId[W][0].properties.noteIndex,ft=G.properties.noteIndex;this.registry.registry[W]["first-reference-note-number"]=ft<ct?ft:ct}}if(G.properties.noteIndex){var mt=parseInt(G.properties.noteIndex,10)-parseInt(q[W],10);c[1].position!==xt.POSITION_FIRST&&mt<=this.citation.opt["near-note-distance"]&&(c[1]["near-note"]=!0),q[W]=G.properties.noteIndex}if(G.citationID!=t.citationID)for(u=0,p=xt.POSITION_TEST_VARS.length;u<p;u+=1){var dt=xt.POSITION_TEST_VARS[u];c[1][dt]!==J[dt]&&(this.registry.registry[W]&&"first-reference-note-number"===dt&&(E[this.registry.registry[W].ambig]=!0,this.tmp.taintedItemIDs[W]=!0),this.tmp.taintedCitationIDs[G.citationID]=!0)}this.sys.variableWrapper&&(c[1].index=G.properties.index,c[1].noteIndex=G.properties.noteIndex)}else void 0===V[c[1].id]&&(V[W]=G.properties.noteIndex),q[W]=G.properties.noteIndex}}}if(this.opt.citation_number_sort&&N&&1<N.length&&0<this.citation_sort.tokens.length&&!t.properties.unsorted){for(O=0,S=N.length;O<S;O+=1)N[O][1].sortkeys=xt.getSortKeys.call(this,N[O][0],"citation_sort");N.sort(this.citation.srt.compareCompositeKeys)}for(var k in this.tmp.taintedItemIDs)if(this.tmp.taintedItemIDs.hasOwnProperty(k)&&(P=this.registry.citationreg.citationsByItemId[k]))for(O=0,S=P.length;O<S;O+=1)this.tmp.taintedCitationIDs[P[O].citationID]=!0;var gt=[];if(s===xt.PREVIEW){try{gt=this.process_CitationCluster.call(this,t.sortedItems,t.citationID)}catch(t){xt.error("Error running CSL processor for preview: "+t)}this.registry.citationreg.citationByIndex=g,this.registry.citationreg.citationById={};for(O=0,S=g.length;O<S;O+=1)this.registry.citationreg.citationById[g[O].citationID]=g[O];var bt=[];for(O=0,S=b.length;O<S;O+=1)bt.push(""+b[O].id);for(var k in this.updateItems(bt,null,null,!0),_)_.hasOwnProperty(k)&&(this.registry.registry[k].disambig=_[k])}else{for(var _t in E)this.disambiguate.run(_t,t);var vt;for(var k in this.tmp.taintedCitationIDs)if(k!=t.citationID){var yt=this.registry.citationreg.citationById[k];if(!yt.properties.unsorted){for(O=0,S=yt.sortedItems.length;O<S;O+=1)yt.sortedItems[O][1].sortkeys=xt.getSortKeys.call(this,yt.sortedItems[O][0],"citation_sort");yt.sortedItems.sort(this.citation.srt.compareCompositeKeys)}this.tmp.citation_pos=yt.properties.index,this.tmp.citation_note_index=yt.properties.noteIndex,this.tmp.citation_id=""+yt.citationID,(vt=[]).push(yt.properties.index),vt.push(this.process_CitationCluster.call(this,yt.sortedItems,yt.citationID)),vt.push(yt.citationID),gt.push(vt)}this.tmp.taintedItemIDs={},this.tmp.taintedCitationIDs={},this.tmp.citation_pos=t.properties.index,this.tmp.citation_note_index=t.properties.noteIndex,this.tmp.citation_id=""+t.citationID,(vt=[]).push(e.length),vt.push(this.process_CitationCluster.call(this,N,t.citationID)),vt.push(t.citationID),gt.push(vt),gt.sort(function(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:0})}return v.citation_errors=this.tmp.citation_errors.slice(),[v,gt]},xt.Engine.prototype.process_CitationCluster=function(t,e){return this.parallel.StartCitation(t),xt.getCitationCluster.call(this,t,e)},xt.Engine.prototype.makeCitationCluster=function(t){var e,i,s,r,n,a;for(e=[],r=t.length,s=0;s<r;s+=1){for(var o in n={},t[s])n[o]=t[s][o];if(a=this.retrieveItem(""+n.id),this.opt.development_extensions.locator_label_parse&&n.locator&&-1===["bill","gazette","legislation","regulation","treaty"].indexOf(a.type)&&(!n.label||"page"===n.label)){var l=xt.LOCATOR_LABELS_REGEXP.exec(n.locator);if(l){var u=xt.LOCATOR_LABELS_MAP[l[2]];this.getTerm(u)&&(n.label=u,n.locator=l[3])}}n.locator&&(n.locator=(""+n.locator).replace(/\s+$/,"")),i=[a,n],e.push(i)}if(this.opt.development_extensions.static_statute_locator&&this.remapSectionVariable(e),e&&1<e.length&&0<this.citation_sort.tokens.length){for(r=e.length,s=0;s<r;s+=1)e[s][1].sortkeys=xt.getSortKeys.call(this,e[s][0],"citation_sort");e.sort(this.citation.srt.compareCompositeKeys)}return this.tmp.citation_errors=[],this.parallel.StartCitation(e),xt.getCitationCluster.call(this,e)},xt.getAmbiguousCite=function(t,e,i,s){var r=this.tmp.group_context.tip,n={term_intended:r.term_intended,variable_attempt:r.variable_attempt,variable_success:r.variable_success,output_tip:r.output_tip,label_form:r.label_form,parallel_conditions:r.parallel_conditions,condition:r.condition,force_suppress:r.force_suppress,done_vars:r.done_vars.slice()};this.tmp.disambig_request=e||!1;var a={position:1,"near-note":!0};s&&(a.locator=s.locator,a.label=s.label),this.registry.registry[t.id]&&this.registry.citationreg.citationsByItemId&&this.registry.citationreg.citationsByItemId[t.id]&&this.registry.citationreg.citationsByItemId[t.id].length&&i&&"by-cite"===this.citation.opt["givenname-disambiguation-rule"]&&(a["first-reference-note-number"]=this.registry.registry[t.id]["first-reference-note-number"]),this.tmp.area="citation",this.tmp.root="citation",this.parallel.use_parallels=(!0===this.parallel.use_parallels||null===this.parallel.use_parallels)&&null,this.tmp.suppress_decorations=!0,this.tmp.just_looking=!0,xt.getCite.call(this,t,a,null,!1);for(var o=0,l=this.output.queue.length;o<l;o+=1)xt.Output.Queue.purgeEmptyBlobs(this.output.queue[o]);if(this.opt.development_extensions.clean_up_csl_flaws)for(var u=0,p=this.output.queue.length;u<p;u+=1)this.output.adjust.upward(this.output.queue[u]),this.output.adjust.leftward(this.output.queue[u]),this.output.adjust.downward(this.output.queue[u]),this.output.adjust.fix(this.output.queue[u]);var h=this.output.string(this,this.output.queue);return this.tmp.just_looking=!1,this.tmp.suppress_decorations=!1,this.parallel.use_parallels=null===this.parallel.use_parallels,this.tmp.group_context.replace(n),h},xt.getSpliceDelimiter=function(t,e,i){if(void 0!==this.citation.opt["after-collapse-delimiter"])t?this.tmp.splice_delimiter=this.citation.opt["after-collapse-delimiter"]:e&&!this.tmp.have_collapsed?this.tmp.splice_delimiter=this.citation.opt["after-collapse-delimiter"]:e||this.tmp.have_collapsed||"year-suffix"===this.citation.opt.collapse?this.tmp.splice_delimiter=this.citation.opt.layout_delimiter:this.tmp.splice_delimiter=this.citation.opt["after-collapse-delimiter"];else if(this.tmp.use_cite_group_delimiter)this.tmp.splice_delimiter=this.citation.opt.cite_group_delimiter;else if(this.tmp.have_collapsed&&"in-text"===this.opt.xclass&&this.opt.update_mode!==xt.NUMERIC)this.tmp.splice_delimiter=", ";else if(this.tmp.cite_locales[i-1]){var s=this.tmp.cite_affixes[this.tmp.area][this.tmp.cite_locales[i-1]];s&&s.delimiter&&(this.tmp.splice_delimiter=s.delimiter)}else this.tmp.splice_delimiter||(this.tmp.splice_delimiter="");return this.tmp.splice_delimiter},xt.getCitationCluster=function(t,e){var i,s,r,n,a,o,l,u,p,h,c,f,m,d,g,b,_,v;t=t||[],this.tmp.last_primary_names_string=!1,_=xt.getSafeEscape(this),this.tmp.area="citation",this.tmp.root="citation",i="",s=[],this.tmp.last_suffix_used="",this.tmp.last_names_used=[],this.tmp.last_years_used=[],this.tmp.backref_index=[],this.tmp.cite_locales=[],this.output.checkNestedBrace=new xt.checkNestedBrace(this);var y=this.output.checkNestedBrace.update(this.citation.opt.layout_prefix),x=!1;if("note"===this.opt.xclass&&this.citation.opt.suppressTrailingPunctuation&&(x=!0),e&&this.registry.citationreg.citationById[e].properties["suppress-trailing-punctuation"]&&(x=!0),"note"===this.opt.xclass){for(var I=[],O=!1,S=!1,A=[],T=0,N=t.length;T<N;T+=1){var E=t[T][0].type,k=t[T][0].title,w=t[T][1].position,R=t[T][0].id;k&&"legal_case"===E&&R!==S&&w&&(k===O&&0!==I.length||(A=[],I.push(A)),A.push(t[T][1])),O=k,S=R}for(T=0,N=I.length;T<N;T+=1)if(!((A=I[T]).length<2)){var L=A.slice(-1)[0].locator;if(L)for(var j=0,C=A.length-1;j<C;j+=1)A[j].locator&&(L=!1);L&&(A[0].locator=L,delete A.slice(-1)[0].locator,A[0].label=A.slice(-1)[0].label,A.slice(-1)[0].label&&delete A.slice(-1)[0].label)}}for(r=[],n=t.length,a=0;a<n;a+=1){f=t[a][0],o=t[a][1],o=xt.parseLocator.call(this,o),l=this.tmp.have_collapsed;var P=!1;if(0<a&&t[a-1][1]&&(P=!!t[a-1][1].locator),u={},this.tmp.shadow_numbers={},!this.tmp.just_looking&&this.opt.hasPlaceholderTerm){var D=this.output;this.output=new xt.Output.Queue(this),this.output.adjust=new xt.Output.Queue.adjust,xt.getAmbiguousCite.call(this,f,null,!1,o),this.output=D}if(this.tmp.in_cite_predecessor=!1,0<a?xt.getCite.call(this,f,o,""+t[a-1][0].id,!0):(this.tmp.term_predecessor=!1,xt.getCite.call(this,f,o,null,!0)),this.tmp.cite_renders_content||(v={citationID:""+this.tmp.citation_id,index:this.tmp.citation_pos,noteIndex:this.tmp.citation_note_index,itemID:""+f.id,citationItems_pos:a,error_code:xt.ERROR_NO_RENDERED_FORM},this.tmp.citation_errors.push(v)),a===t.length-1&&this.parallel.ComposeSet(),u.splice_delimiter=xt.getSpliceDelimiter.call(this,P,l,a),o&&o["author-only"]&&(this.tmp.suppress_decorations=!0),0<a){var U=(b=t[a-1][1]).suffix&&-1<[".",","].indexOf(b.suffix.slice(-1)),M=!b.suffix&&o.prefix&&-1<[".",","].indexOf(o.prefix.slice(0,1));if(U||M){var B=u.splice_delimiter.indexOf(" ");u.splice_delimiter=-1<B&&!M?u.splice_delimiter.slice(B):""}}u.suppress_decorations=this.tmp.suppress_decorations,u.have_collapsed=this.tmp.have_collapsed,r.push(u)}this.tmp.has_purged_parallel=!1,this.parallel.PruneOutputQueue(this),c=this.output.queue.slice();this.citation.opt.layout_suffix,this.citation.opt.layout_delimiter;var X=this.citation.opt.layout_suffix,F=this.tmp.cite_locales[this.tmp.cite_locales.length-1];F&&this.tmp.cite_affixes[this.tmp.area][F]&&this.tmp.cite_affixes[this.tmp.area][F].suffix&&(X=this.tmp.cite_affixes[this.tmp.area][F].suffix),-1<xt.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(X.slice(0,1))&&(X=X.slice(0,1));var z=this.citation.opt.layout_delimiter;z||(z=""),-1<xt.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(z.slice(0,1))&&(z=z.slice(0,1)),X=this.output.checkNestedBrace.update(X);for(T=0,N=this.output.queue.length;T<N;T+=1)xt.Output.Queue.purgeEmptyBlobs(this.output.queue[T]);if(!this.tmp.suppress_decorations&&this.output.queue.length&&(this.opt.development_extensions.apply_citation_wrapper&&this.sys.wrapCitationEntry&&!this.tmp.just_looking&&"citation"===this.tmp.area||(x||(this.output.queue[this.output.queue.length-1].strings.suffix=X),this.output.queue[0].strings.prefix=y)),this.opt.development_extensions.clean_up_csl_flaws)for(j=0,C=this.output.queue.length;j<C;j+=1)this.output.adjust.upward(this.output.queue[j]),this.output.adjust.leftward(this.output.queue[j]),this.output.adjust.downward(this.output.queue[j]),this.tmp.last_chr=this.output.adjust.fix(this.output.queue[j]);for(a=0,n=c.length;a<n;a+=1){var V=[];if(this.output.queue=[c[a]],this.tmp.suppress_decorations=r[a].suppress_decorations,this.tmp.splice_delimiter=r[a].splice_delimiter,c[a].parallel_delimiter&&(this.tmp.splice_delimiter=c[a].parallel_delimiter),this.tmp.have_collapsed=r[a].have_collapsed,p=this.output.string(this,this.output.queue),this.tmp.suppress_decorations=!1,"string"==typeof p)return this.tmp.suppress_decorations=!1,p;if("object"==typeof p&&0===p.length&&!o["suppress-author"])if(this.tmp.has_purged_parallel)p.push("");else{var q=0===a?_(this.citation.opt.layout_prefix):"",G=a===c.length-1?_(this.citation.opt.layout_suffix):"";p.push(q+"[CSL STYLE ERROR: reference with no printed form.]"+G)}if(V.length&&"string"==typeof p[0]){p.reverse();var $=p.pop();$&&","===$.slice(0,1)?V.push($):"string"==typeof V.slice(-1)[0]&&","===V.slice(-1)[0].slice(-1)?V.push(" "+$):$&&V.push(_(this.tmp.splice_delimiter)+$)}else p.reverse(),void 0!==(h=p.pop())&&(V.length&&"string"==typeof V[V.length-1]&&(V[V.length-1]+=h.successor_prefix),V.push(h));for(m=p.length,d=0;d<m;d+=1)"string"!=typeof(g=p[d])?void 0!==(h=p.pop())&&V.push(h):V.push(_(this.tmp.splice_delimiter)+g);0===V.length&&t[a][1]["suppress-author"],1<V.length&&"string"!=typeof V[0]&&(V=[this.output.renderBlobs(V)]),V.length&&("string"==typeof V[0]?0<a&&(V[0]=_(this.tmp.splice_delimiter)+V[0]):V[0].splice_prefix=0<a?this.tmp.splice_delimiter:""),s=s.concat(V)}if((i+=this.output.renderBlobs(s))&&!this.tmp.suppress_decorations)for(n=this.citation.opt.layout_decorations.length,a=0;a<n;a+=1)"normal"!==(u=this.citation.opt.layout_decorations[a])[1]&&(o&&o["author-only"]||(i=this.fun.decorate[u[0]][u[1]](this,i)));return this.tmp.suppress_decorations=!1,i},xt.getCite=function(t,e,i,s){var r,n;for(this.tmp.cite_renders_content=!1,this.parallel.StartCite(t,e,i),xt.citeStart.call(this,t,e,s),r=0,this.tmp.name_node={},this.nameOutput=new xt.NameOutput(this,t,e);r<this[this.tmp.area].tokens.length;)r=xt.tokenExec.call(this,this[this.tmp.area].tokens[r],t,e);return xt.citeEnd.call(this,t,e),this.parallel.CloseCite(this),this.tmp.cite_renders_content||this.tmp.just_looking||"bibliography"===this.tmp.area&&(n={index:this.tmp.bibliography_pos,itemID:""+t.id,error_code:xt.ERROR_NO_RENDERED_FORM},this.tmp.bibliography_errors.push(n)),""+t.id},xt.citeStart=function(t,e,i){if(i||(this.tmp.shadow_numbers={}),this.tmp.disambiguate_count=0,this.tmp.disambiguate_maxMax=0,this.tmp.same_author_as_previous_cite=!1,this.tmp.suppress_decorations?this.tmp.subsequent_author_substitute_ok=!1:this.tmp.subsequent_author_substitute_ok=!0,this.tmp.lastchr="","citation"===this.tmp.area&&this.citation.opt.collapse&&this.citation.opt.collapse.length?this.tmp.have_collapsed=!0:this.tmp.have_collapsed=!1,this.tmp.render_seen=!1,this.tmp.disambig_request&&!this.tmp.disambig_override?this.tmp.disambig_settings=this.tmp.disambig_request:this.registry.registry[t.id]&&!this.tmp.disambig_override?(this.tmp.disambig_request=this.registry.registry[t.id].disambig,this.tmp.disambig_settings=this.registry.registry[t.id].disambig):this.tmp.disambig_settings=new xt.AmbigConfig,"citation"!==this.tmp.area)if(this.registry.registry[t.id]){if(this.tmp.disambig_restore=xt.cloneAmbigConfig(this.registry.registry[t.id].disambig),"bibliography"===this.tmp.area&&this.tmp.disambig_settings&&this.tmp.disambig_override&&(this.opt["disambiguate-add-names"]&&(this.tmp.disambig_settings.names=this.registry.registry[t.id].disambig.names.slice(),this.tmp.disambig_request&&(this.tmp.disambig_request.names=this.registry.registry[t.id].disambig.names.slice())),this.opt["disambiguate-add-givenname"])){this.tmp.disambig_request=this.tmp.disambig_settings,this.tmp.disambig_settings.givens=this.registry.registry[t.id].disambig.givens.slice(),this.tmp.disambig_request.givens=this.registry.registry[t.id].disambig.givens.slice();for(var s=0,r=this.tmp.disambig_settings.givens.length;s<r;s+=1)this.tmp.disambig_settings.givens[s]=this.registry.registry[t.id].disambig.givens[s].slice();for(s=0,r=this.tmp.disambig_request.givens.length;s<r;s+=1)this.tmp.disambig_request.givens[s]=this.registry.registry[t.id].disambig.givens[s].slice()}}else this.tmp.disambig_restore=new xt.AmbigConfig;this.tmp.names_used=[],this.tmp.nameset_counter=0,this.tmp.years_used=[],this.tmp.names_max.clear(),this.tmp.splice_delimiter=this[this.tmp.area].opt.layout_delimiter,this.bibliography_sort.keys=[],this.citation_sort.keys=[],this.tmp.has_done_year_suffix=!1,this.tmp.last_cite_locale=!1,!this.tmp.just_looking&&e&&!e.position&&this.registry.registry[t.id]&&(this.tmp.disambig_restore=xt.cloneAmbigConfig(this.registry.registry[t.id].disambig)),this.tmp.first_name_string=!1,this.tmp.authority_stop_last=0},xt.citeEnd=function(t,e){if(this.tmp.disambig_restore&&this.registry.registry[t.id]){this.registry.registry[t.id].disambig.names=this.tmp.disambig_restore.names.slice(),this.registry.registry[t.id].disambig.givens=this.tmp.disambig_restore.givens.slice();for(var i=0,s=this.registry.registry[t.id].disambig.givens.length;i<s;i+=1)this.registry.registry[t.id].disambig.givens[i]=this.tmp.disambig_restore.givens[i].slice()}if(this.tmp.disambig_restore=!1,e&&e.suffix?this.tmp.last_suffix_used=e.suffix:this.tmp.last_suffix_used="",this.tmp.last_years_used=this.tmp.years_used.slice(),this.tmp.last_names_used=this.tmp.names_used.slice(),this.tmp.cut_var=!1,this.tmp.disambig_request=!1,this.tmp.cite_locales.push(this.tmp.last_cite_locale),this.tmp.issued_date&&this.tmp.renders_collection_number){var r=[];for(i=this.tmp.issued_date.list.length-1;i>this.tmp.issued_date.pos;i+=-1)r.push(this.tmp.issued_date.list.pop());for(this.tmp.issued_date.list.pop(),i=r.length-1;-1<i;i+=-1)this.tmp.issued_date.list.push(r.pop());this.parallel.use_parallels&&(this.parallel.cite.issued=!1)}this.tmp.issued_date=!1,this.tmp.renders_collection_number=!1},(t.exports=xt).Engine.prototype.makeBibliography=function(t){var e,i,s,r,n,a,o;if(!this.bibliography.tokens.length)return!1;"string"==typeof t&&(this.opt.citation_number_slug=t,t=!1),a=(e=xt.getBibliographyEntries.call(this,t))[0],o=e[1];var l=e[2];for(i={maxoffset:0,entryspacing:this.bibliography.opt["entry-spacing"],linespacing:this.bibliography.opt["line-spacing"],"second-field-align":!1,entry_ids:a,bibliography_errors:this.tmp.bibliography_errors.slice(),done:l},this.bibliography.opt["second-field-align"]&&(i["second-field-align"]=this.bibliography.opt["second-field-align"]),r=this.registry.reflist.length,n=0;n<r;n+=1)(s=this.registry.reflist[n]).offset>i.maxoffset&&(i.maxoffset=s.offset);return this.bibliography.opt.hangingindent&&(i.hangingindent=this.bibliography.opt.hangingindent),i.bibstart=this.fun.decorate.bibstart,i.bibend=this.fun.decorate.bibend,this.opt.citation_number_slug=!1,[i,o]},xt.getBibliographyEntries=function(t){var e,i,s,r,n,a,o,l,u,p,h,c,f,m,d,g,b,_;function v(t,e){return t===e}function y(t,e){return!("none"!==t&&t||e)||("string"==typeof e?v(t,e):!!e&&function(t,e){for(u=e.length,p=0;p<u;p+=1)if(v(t,e[p]))return!0;return!1}(t,e))}if(e=[],b=[],this.tmp.area="bibliography",this.tmp.root="bibliography",this.tmp.last_rendered_name=!1,this.tmp.bibliography_errors=[],this.tmp.bibliography_pos=0,i=t&&t.page_start&&t.page_length?this.registry.getSortedIds():this.retrieveItems(this.registry.getSortedIds()),this.tmp.disambig_override=!0,m={},t&&t.page_start&&t.page_length&&!(_=0)!==t.page_start)for(var x=0,I=i.length;x<I&&(m[i[x]]=!0,t.page_start!=i[x]);x+=1);var O=[];for(x=0,I=i.length;x<I;x+=1){if(t&&t.page_start&&t.page_length){if(m[i[x]])continue;if(o=this.retrieveItem(i[x]),_===t.page_length)break}else if(m[(o=i[x]).id])continue;if(t){if(s=!0,t.include){for(s=!1,A=0,T=t.include.length;A<T;A+=1)if(y((l=t.include[A]).value,o[l.field])){s=!0;break}}else if(t.exclude){for(r=!1,A=0,T=t.exclude.length;A<T;A+=1)if(y((l=t.exclude[A]).value,o[l.field])){r=!0;break}r&&(s=!1)}else if(t.select){for(n=!(s=!1),A=0,T=t.select.length;A<T;A+=1)y((l=t.select[A]).value,o[l.field])||(n=!1);n&&(s=!0)}if(t.quash){for(n=!0,A=0,T=t.quash.length;A<T;A+=1)y((l=t.quash[A]).value,o[l.field])||(n=!1);n&&(s=!1)}if(!s)continue}if((a=new xt.Token("group",xt.START)).decorations=[["@bibliography","entry"]].concat(this.bibliography.opt.layout_decorations),this.output.startTag("bib_entry",a),o.system_id&&this.sys.embedBibliographyEntry?this.output.current.value().item_id=o.system_id:this.output.current.value().system_id=o.id,d=[[{id:""+o.id},o]],c=[],!this.registry.registry[o.id].master||t&&t.page_start&&t.page_length)this.registry.registry[o.id].siblings||(this.parallel.StartCitation(d),this.tmp.term_predecessor=!1,c.push(""+xt.getCite.call(this,o)),t&&t.page_start&&t.page_length&&(_+=1));else{for(f=!0,this.parallel.StartCitation(d),this.output.queue[0].strings.delimiter=", ",this.tmp.term_predecessor=!1,c.push(""+xt.getCite.call(this,o)),m[o.id]=!0,A=0,T=this.registry.registry[o.id].siblings.length;A<T;A+=1){var S=this.registry.registry[o.id].siblings[A];g=this.retrieveItem(S),c.push(""+xt.getCite.call(this,g)),m[g.id]=!0}this.parallel.ComposeSet(),this.parallel.PruneOutputQueue()}b.push(""),this.tmp.bibliography_pos+=1,O.push(c),this.output.endTag("bib_entry"),this.output.queue[0].blobs.length&&this.output.queue[0].blobs[0].blobs.length&&(f||!this.output.queue[0].blobs[0].blobs[0].strings?(h=this.output.queue[0].blobs,f=!1):h=this.output.queue[0].blobs[0].blobs,h[0].strings.prefix=this.bibliography.opt.layout_prefix+h[0].strings.prefix);for(var A=0,T=this.output.queue.length;A<T;A+=1)xt.Output.Queue.purgeEmptyBlobs(this.output.queue[A]);for(A=0,T=this.output.queue.length;A<T;A+=1)this.output.adjust.upward(this.output.queue[A]),this.output.adjust.leftward(this.output.queue[A]),this.output.adjust.downward(this.output.queue[A],!0),this.output.adjust.fix(this.output.queue[A]);var N;if(!(N=this.output.string(this,this.output.queue)[0])&&this.opt.update_mode===xt.NUMERIC){var E=e.length+1+". [CSL STYLE ERROR: reference with no printed form.]";N=xt.Output.Formats[this.opt.mode]["@bibliography/entry"](this,E)}N&&e.push(N)}var k=!1;if(t&&t.page_start&&t.page_length){var w=i.slice(-1)[0],R=O.slice(-1)[0];w&&R&&w!=R||(k=!0)}return this.tmp.disambig_override=!1,[O,e,k]},(t.exports=xt).Engine.prototype.setCitationId=function(t,e){var i,s,r;if(i=!1,!t.citationID||e){for(s=Math.floor(1e14*Math.random());;){if(r=0,!this.registry.citationreg.citationById[s]){t.citationID="a"+s.toString(32);break}s+=1===(r=!r&&s<5e13?1:-1)?1:-1}i=""+s}return this.registry.citationreg.citationById[t.citationID]=t,i},(t.exports=xt).Engine.prototype.rebuildProcessorState=function(t,e,i){t||(t=[]),e||(e="html");for(var s={},r=[],n=0,a=t.length;n<a;n+=1)for(var o=0,l=t[n].citationItems.length;o<l;o+=1){var u=""+t[n].citationItems[o].id;s[u]||r.push(u),s[u]=!0}this.updateItems(r);var p=[],h=[],c=[],f=this.opt.mode;this.setOutputFormat(e);for(n=0,a=t.length;n<a;n+=1){var m=this.processCitationCluster(t[n],p,h,xt.ASSUME_ALL_ITEMS_REGISTERED);p.push([t[n].citationID,t[n].properties.noteIndex]);for(o=0,l=m[1].length;o<l;o+=1){var d=m[1][o][0];c[d]=[p[d][0],p[d][1],m[1][o][1]]}}return this.updateUncitedItems(i),this.setOutputFormat(f),c},xt.Engine.prototype.restoreProcessorState=function(t){var e,i,s,r,n,a,o,l,u,p;l=[],u=[],t||(t=[]);var h=[],c={};for(e=0,i=t.length;e<i;e+=1)c[t[e].citationID]&&this.setCitationId(t[e],!0),c[t[e].citationID]=!0,h.push(t[e].properties.index);var f=t.slice();for(f.sort(function(t,e){return t.properties.index<e.properties.index?-1:t.properties.index>e.properties.index?1:0}),e=0,i=f.length;e<i;e+=1)f[e].properties.index=e;for(e=0,i=f.length;e<i;e+=1){for(p=[],s=0,r=f[e].citationItems.length;s<r;s+=1)void 0===(n=f[e].citationItems[s]).sortkeys&&(n.sortkeys=[]),o=[a=this.retrieveItem(""+n.id),n],p.push(o),f[e].citationItems[s].item=a,u.push(""+n.id);f[e].properties.unsorted||p.sort(this.citation.srt.compareCompositeKeys),f[e].sortedItems=p,this.registry.citationreg.citationById[f[e].citationID]=f[e]}for(this.updateItems(u),e=0,i=t.length;e<i;e+=1)l.push([""+t[e].citationID,t[e].properties.noteIndex]);var m=[];return t&&t.length?m=this.processCitationCluster(t[0],[],l.slice(1)):(this.registry=new xt.Registry(this),this.tmp=new xt.Engine.Tmp,this.disambiguate=new xt.Disambiguation(this)),m},xt.Engine.prototype.updateItems=function(t,e,i,s){var r=this.tmp.area,n=this.tmp.root,a=this.tmp.extension;if(0===this.bibliography_sort.tokens.length&&(e=!0),this.tmp.area="citation",this.tmp.root="citation",this.tmp.extension="",s||(this.tmp.loadedItemIDs={}),this.registry.init(t),i)for(var o in this.registry.ambigcites)this.registry.ambigsTouched[o]=!0;return this.registry.dodeletes(this.registry.myhash),this.registry.doinserts(this.registry.mylist),this.registry.dorefreshes(),this.registry.rebuildlist(e),this.registry.setsortkeys(),this.registry.setdisambigs(),this.registry.sorttokens(e),this.registry.renumber(),this.tmp.extension=a,this.tmp.area=r,this.tmp.root=n,this.registry.getSortedIds()},xt.Engine.prototype.updateUncitedItems=function(t,e){var i,s=this.tmp.area,r=this.tmp.root,n=this.tmp.extension;if(0===this.bibliography_sort.tokens.length&&(e=!0),this.tmp.area="citation",this.tmp.root="citation",this.tmp.extension="",this.tmp.loadedItemIDs={},t||(t=[]),"object"==typeof t)if(void 0===t.length)for(var a in i=t,t=[],i)t.push(a);else if("number"==typeof t.length){i={};for(var o=0,l=t.length;o<l;o+=1)i[t[o]]=!0}return this.registry.init(t,!0),this.registry.dopurge(i),this.registry.doinserts(this.registry.mylist),this.registry.dorefreshes(),this.registry.rebuildlist(e),this.registry.setsortkeys(),this.registry.setdisambigs(),this.registry.sorttokens(e),this.registry.renumber(),this.tmp.extension=n,this.tmp.area=s,this.tmp.root=r,this.registry.getSortedIds()},(t.exports=xt).localeResolve=function(t,e){var i,s;return e||(e="en-US"),t||(t=e),i={},s=t.split(/[\-_]/),i.base=xt.LANG_BASES[s[0]],void 0===i.base?{base:e,best:t,bare:s[0]}:(1===s.length&&(i.generic=!0),1===s.length||"x"===s[1]?i.best=i.base.replace("_","-"):i.best=s.slice(0,2).join("-"),i.base=i.base.replace("_","-"),i.bare=s[0],i)},xt.Engine.prototype.localeConfigure=function(t,e){var i;if((!e||!this.locale[t.best])&&("en-US"===t.best?(i=xt.setupXml(this.sys.retrieveLocale("en-US")),this.localeSet(i,"en-US",t.best)):"en-US"!==t.best&&(t.base!==t.best&&(i=xt.setupXml(this.sys.retrieveLocale(t.base)),this.localeSet(i,t.base,t.best)),i=xt.setupXml(this.sys.retrieveLocale(t.best)),this.localeSet(i,t.best,t.best)),this.localeSet(this.cslXml,"",t.best),this.localeSet(this.cslXml,t.bare,t.best),t.base!==t.best&&this.localeSet(this.cslXml,t.base,t.best),this.localeSet(this.cslXml,t.best,t.best),void 0===this.locale[t.best].terms["page-range-delimiter"]&&(-1<["fr","pt"].indexOf(t.best.slice(0,2).toLowerCase())?this.locale[t.best].terms["page-range-delimiter"]="-":this.locale[t.best].terms["page-range-delimiter"]="–"),void 0===this.locale[t.best].terms["year-range-delimiter"]&&(this.locale[t.best].terms["year-range-delimiter"]="–"),void 0===this.locale[t.best].terms["citation-range-delimiter"]&&(this.locale[t.best].terms["citation-range-delimiter"]="–"),this.opt.development_extensions.normalize_lang_keys_to_lowercase)){for(var s=["default-locale","locale-sort","locale-translit","locale-translat"],r=0,n=s.length;r<n;r+=1)for(var a=0,o=this.opt[s[r]].length;a<o;a+=1)this.opt[s[r]][a]=this.opt[s[r]][a].toLowerCase();this.opt.lang=this.opt.lang.toLowerCase()}},xt.Engine.prototype.localeSet=function(t,e,i){var s,r,n,a,o,l,u,p,h,c,f,m;if(e=e.replace("_","-"),i=i.replace("_","-"),this.opt.development_extensions.normalize_lang_keys_to_lowercase&&(e=e.toLowerCase(),i=i.toLowerCase()),this.locale[i]||(this.locale[i]={},this.locale[i].terms={},this.locale[i].opts={},this.locale[i].opts["skip-words"]=xt.SKIP_WORDS,this.locale[i].opts["leading-noise-words"]||(this.locale[i].opts["leading-noise-words"]=[]),this.locale[i].dates={},this.locale[i].ord={"1.0.1":!1,keys:{}},this.locale[i]["noun-genders"]={}),r=t.makeXml(),t.nodeNameIs(t.dataObj,"locale"))r=t.dataObj;else for(n=t.getNodesByName(t.dataObj,"locale"),o=0,f=t.numberofnodes(n);o<f;o+=1)if(s=n[o],t.getAttributeValue(s,"lang","xml")===e){r=s;break}for(n=t.getNodesByName(r,"type"),L=0,j=t.numberofnodes(n);L<j;L+=1){var d=n[L],g=t.getAttributeValue(d,"name"),b=t.getAttributeValue(d,"gender");this.opt.gender[g]=b}if(t.getNodesByName(r,"term","ordinal").length){for(var _ in this.locale[i].ord.keys)delete this.locale[i].terms[_];this.locale[i].ord={"1.0.1":!1,keys:{}}}n=t.getNodesByName(r,"term");var v={"last-digit":{},"last-two-digits":{},"whole-number":{}},y=!1,x={};for(o=0,f=t.numberofnodes(n);o<f;o+=1){if(l=n[o],"sub verbo"===(p=t.getAttributeValue(l,"name"))&&(p="sub-verbo"),"ordinal"===p.slice(0,7)){t.getNodeValue(l);if("ordinal"===p)y=!0;else{var I,O=t.getAttributeValue(l,"match"),S=p.slice(8);(I=t.getAttributeValue(l,"gender-form"))||(I="neuter"),O||(O="last-two-digits","0"===S.slice(0,1)&&(O="last-digit")),"0"===S.slice(0,1)&&(S=S.slice(1)),v[O][S]||(v[O][S]={}),v[O][S][I]=p}this.locale[i].ord.keys[p]=!0}void 0===this.locale[i].terms[p]&&(this.locale[i].terms[p]={}),I=!(u="long"),t.getAttributeValue(l,"form")&&(u=t.getAttributeValue(l,"form")),t.getAttributeValue(l,"gender-form")&&(I=t.getAttributeValue(l,"gender-form")),t.getAttributeValue(l,"gender")&&(this.locale[i]["noun-genders"][p]=t.getAttributeValue(l,"gender")),I?(this.locale[i].terms[p][I]={},this.locale[i].terms[p][I][u]=[],m=this.locale[i].terms[p][I],x[p]=!0):(this.locale[i].terms[p][u]=[],m=this.locale[i].terms[p]),t.numberofnodes(t.getNodesByName(l,"multiple"))?(m[u][0]=t.getNodeValue(l,"single"),-1<m[u][0].indexOf("%s")&&(this.opt.hasPlaceholderTerm=!0),m[u][1]=t.getNodeValue(l,"multiple"),-1<m[u][1].indexOf("%s")&&(this.opt.hasPlaceholderTerm=!0)):(m[u]=t.getNodeValue(l),-1<m[u].indexOf("%s")&&(this.opt.hasPlaceholderTerm=!0))}if(y){for(var A in x){var T={},N=0;for(var E in this.locale[i].terms[A])-1<["masculine","feminine"].indexOf(E)?T[E]=this.locale[i].terms[A][E]:N+=1;if(!N)if(T.feminine)for(var E in T.feminine)this.locale[i].terms[A][E]=T.feminine[E];else if(T.masculine)for(var E in T.masculine)this.locale[i].terms[A][E]=T.masculine[E]}this.locale[i].ord["1.0.1"]=v}for(p in this.locale[i].terms)for(L=0,j=2;L<j;L+=1)if(I=xt.GENDERS[L],this.locale[i].terms[p][I])for(u in this.locale[i].terms[p])this.locale[i].terms[p][I][u]||(this.locale[i].terms[p][I][u]=this.locale[i].terms[p][u]);for(n=t.getNodesByName(r,"style-options"),o=0,f=t.numberofnodes(n);o<f;o+=1)for(c in h=n[o],a=t.attributes(h))if(a.hasOwnProperty(c))if("@punctuation-in-quote"===c||"@limit-day-ordinals-to-day-1"===c)"true"===a[c]?this.locale[i].opts[c.slice(1)]=!0:this.locale[i].opts[c.slice(1)]=!1;else if("@jurisdiction-preference"===c){var k=a[c].split(/\s*,\s*/);this.locale[i].opts[c.slice(1)]=k}else if("@skip-words"===c){var w=a[c].split(/\s*,\s*/);this.locale[i].opts[c.slice(1)]=w}else if("@leading-noise-words"===c){var R=a[c].split(/\s*,\s*/);this.locale[i].opts["leading-noise-words"]=R}else if("@name-as-sort-order"===c){this.locale[i].opts["name-as-sort-order"]={};for(var L=0,j=(C=a[c].split(/\s+/)).length;L<j;L+=1)this.locale[i].opts["name-as-sort-order"][C[L]]=!0}else if("@name-as-reverse-order"===c){this.locale[i].opts["name-as-reverse-order"]={};for(L=0,j=(C=a[c].split(/\s+/)).length;L<j;L+=1)this.locale[i].opts["name-as-reverse-order"][C[L]]=!0}else if("@name-never-short"===c){this.locale[i].opts["name-never-short"]={};var C;for(L=0,j=(C=a[c].split(/\s+/)).length;L<j;L+=1)this.locale[i].opts["name-never-short"][C[L]]=!0}for(n=t.getNodesByName(r,"date"),o=0,f=t.numberofnodes(n);o<f;o+=1){var P=n[o];this.locale[i].dates[t.getAttributeValue(P,"form")]=P}},(t.exports=xt).getLocaleNames=function(t,e){var o=xt.setupXml(t);function i(t,e){var i=["base","best"];if(e){normalizedLocale=xt.localeResolve(e);for(var s=0,r=i.length;s<r;s++)normalizedLocale[i[s]]&&-1===t.indexOf(normalizedLocale[i[s]])&&t.push(normalizedLocale[i[s]])}}function s(t){for(var e=o.getNodesByName(o.dataObj,t),i=0,s=e.length;i<s;i++){var r=o.getAttributeValue(e[i],"locale");if(r)for(var n=0,a=(r=r.split(/ +/)).length;n<a;n++)this.extendLocaleList(l,r[n])}}var l=["en-US"];i(l,e);var r=o.getNodesByName(o.dataObj,"style")[0],n=o.getAttributeValue(r,"default-locale");i(l,n);for(var a=["layout","if","else-if","condition"],u=0,p=a.length;u<p;u++)s(o);return l},(t.exports=xt).Node={},xt.Node.bibliography={build:function(t,e){if(this.tokentype===xt.START){t.build.area="bibliography",t.build.root="bibliography",t.build.extension="";this.execs.push(function(t,e){t.tmp.area="bibliography",t.tmp.root="bibliography",t.tmp.extension=""})}e.push(this)}},(t.exports=xt).Node.choose={build:function(t,e){var i;this.tokentype===xt.START&&(i=function(t,e){t.tmp.jump.push(void 0,xt.LITERAL)}),this.tokentype===xt.END&&(i=function(t,e){t.tmp.jump.pop()}),this.execs.push(i),e.push(this)},configure:function(t,e){this.tokentype===xt.END?(t.configure.fail.push(e),t.configure.succeed.push(e)):(t.configure.fail.pop(),t.configure.succeed.pop())}},(t.exports=xt).Node.citation={build:function(t,e){if(this.tokentype===xt.START){t.build.area="citation",t.build.root="citation",t.build.extension="";this.execs.push(function(t,e){t.tmp.area="citation",t.tmp.root="citation",t.tmp.extension=""})}if(this.tokentype===xt.END){if(t.opt.grouped_sort="in-text"===t.opt.xclass&&t.citation.opt.collapse&&t.citation.opt.collapse.length||t.citation.opt.cite_group_delimiter&&t.citation.opt.cite_group_delimiter.length&&t.opt.update_mode!==xt.POSITION&&t.opt.update_mode!==xt.NUMERIC,t.opt.grouped_sort&&t.citation_sort.opt.sort_directions.length){var i=t.citation_sort.opt.sort_directions[0].slice();t.citation_sort.opt.sort_directions=[i].concat(t.citation_sort.opt.sort_directions)}t.citation.srt=new xt.Registry.Comparifier(t,"citation_sort")}e.push(this)}},(t.exports=xt).Node["#comment"]={build:function(t,e){}},(t.exports=xt).Node.date={build:function(t,e){var i,r,n,a,o,l,u,p,h,c;this.tokentype!==xt.START&&this.tokentype!==xt.SINGLETON||(t.build.date_parts=[],t.build.date_variables=this.variables,t.build.extension||xt.Util.substituteStart.call(this,t,e),i=t.build.extension?xt.dateMacroAsSortKey:function(t,e,i){var s;if(t.tmp.element_rendered_ok=!1,t.tmp.donesies=[],t.tmp.dateparts=[],s=[],!this.variables.length||t.tmp.just_looking&&"accessed"===this.variables[0])t.tmp.date_object=!1;else{for(void 0===(r=e[this.variables[0]])&&(r={"date-parts":[[0]]},t.opt.development_extensions.locator_date_and_revision&&i&&"locator-date"===this.variables[0]&&i["locator-date"]&&(r=i["locator-date"])),t.tmp.date_object=r,n=this.dateparts.length,a=0;a<n;a+=1)o=this.dateparts[a],void 0!==t.tmp.date_object[o+"_end"]?s.push(o):"month"===o&&void 0!==t.tmp.date_object.season_end&&s.push(o);for(l=[],n=(u=["year","month","day"]).length,a=0;a<n;a+=1)-1<s.indexOf(u[a])&&l.push(u[a]);for(s=l.slice(),p=2,n=s.length,a=0;a<n;a+=1)if(o=s[a],h=t.tmp.date_object[o],c=t.tmp.date_object[o+"_end"],h!==c){p=a;break}t.tmp.date_collapse_at=s.slice(p)}},this.execs.push(i),i=function(t,e){if(e[this.variables[0]]&&(t.parallel.StartVariable(this.variables[0]),t.output.startTag("date",this),"issued"===this.variables[0]&&"legal_case"===e.type&&!t.tmp.extension&&""+e["collection-number"]==""+t.tmp.date_object.year&&1===this.dateparts.length&&"year"===this.dateparts[0]))for(var i in t.tmp.date_object)if(t.tmp.date_object.hasOwnProperty(i)&&"year"===i.slice(0,4)){t.tmp.issued_date={};var s=t.output.current.mystack.slice(-2)[0].blobs;t.tmp.issued_date.list=s,t.tmp.issued_date.pos=s.length-1}},this.execs.push(i)),t.build.extension||this.tokentype!==xt.END&&this.tokentype!==xt.SINGLETON||(i=function(t,e){e[this.variables[0]]&&(t.output.endTag(),t.parallel.CloseVariable(this.variables[0]))},this.execs.push(i)),e.push(this),this.tokentype!==xt.END&&this.tokentype!==xt.SINGLETON||t.build.extension||xt.Util.substituteEnd.call(this,t,e)}},(t.exports=xt).Node["date-part"]={build:function(t,e){var i,l,u,p,h,c,f,m,d,g,b,_,v,y,x,I,O,S,A;this.strings.form||(this.strings.form="long"),t.build.date_parts.push(this.strings.name);var T=t.build.date_variables[0];i=function(t,e){if(t.tmp.date_object){if(p=!0,c=h="",t.tmp.donesies.push(this.strings.name),t.tmp.date_object.literal&&"year"===this.strings.name&&(t.parallel.AppendToVariable(t.tmp.date_object.literal),t.output.append(t.tmp.date_object.literal,this)),t.tmp.date_object&&(h=t.tmp.date_object[this.strings.name],c=t.tmp.date_object[this.strings.name+"_end"]),"year"!==this.strings.name||0!==h||t.tmp.suppress_decorations||(h=!1),f=!t.tmp.suppress_decorations,m=t.tmp.have_collapsed,d="year-suffix"===t[t.tmp.area].opt.collapse||"year-suffix-ranged"===t[t.tmp.area].opt.collapse,g=t.opt["disambiguate-add-year-suffix"],f&&g&&d&&(t.tmp.years_used.push(h),t.tmp.last_years_used.length>=t.tmp.years_used.length&&m&&t.tmp.last_years_used[t.tmp.years_used.length-1]===h&&(h=!1)),void 0!==h){_=b=!1,"year"===this.strings.name&&(parseInt(h,10)<500&&0<parseInt(h,10)&&(_=t.getTerm("ad")),parseInt(h,10)<0&&(b=t.getTerm("bc"),h=-1*parseInt(h,10)),c&&(parseInt(c,10)<500&&0<parseInt(c,10)&&t.getTerm("ad"),parseInt(c,10)<0&&(t.getTerm("bc"),c=-1*parseInt(c,10)))),t.parallel.AppendToVariable(h);for(var i=""+t.tmp.date_object.month;i.length<2;)i="0"+i;i="month-"+i;var s=t.locale[t.opt.lang]["noun-genders"][i];if(this.strings.form){var r=this.strings.form;if("day"===this.strings.name&&"ordinal"===r&&t.locale[t.opt.lang].opts["limit-day-ordinals-to-day-1"]&&""+h!="1"&&(r="numeric"),h=xt.Util.Dates[this.strings.name][r](t,h,s,this.default_locale),"month"===this.strings.name)if(t.tmp.strip_periods)h=h.replace(/\./g,"");else for(var n=0,a=this.decorations.length;n<a;n+=1)if("@strip-periods"===this.decorations[n][0]&&"true"===this.decorations[n][1]){h=h.replace(/\./g,"");break}if(c)if(c=xt.Util.Dates[this.strings.name][r](t,c,s,"accessed"===T,"_end"),t.tmp.strip_periods)c=c.replace(/\./g,"");else for(n=0,a=this.decorations.length;n<a;n+=1)if("@strip-periods"===this.decorations[n][0]&&"true"===this.decorations[n][1]){c=c.replace(/\./g,"");break}}if(t.output.openLevel("empty"),t.tmp.date_collapse_at.length){for(v=!0,u=t.tmp.date_collapse_at.length,l=0;l<u;l+=1)if(A=t.tmp.date_collapse_at[l],-1===t.tmp.donesies.indexOf(A)){v=!1;break}if(v){if(""+c!="0"){if(0===t.dateput.queue.length&&(p=!0),t.opt["year-range-format"]&&"expanded"!==t.opt["year-range-format"]&&!t.tmp.date_object.day&&!t.tmp.date_object.month&&!t.tmp.date_object.season&&"year"===this.strings.name&&h&&c){c=t.fun.year_mangler(h+"-"+c,!0);var o=t.getTerm("year-range-delimiter");c=c.slice(c.indexOf(o)+1)}t.dateput.append(c,this),p&&(t.dateput.current.value()[0].strings.prefix="")}t.output.append(h,this),(y=t.output.current.value()).blobs[y.blobs.length-1].strings.suffix="",t.output.append(t.getTerm("year-range-delimiter"),"empty"),x=t.dateput.current.value(),y.blobs=y.blobs.concat(x),t.dateput.string(t,t.dateput.queue),t.tmp.date_collapse_at=[]}else t.output.append(h,this),-1<t.tmp.date_collapse_at.indexOf(this.strings.name)&&""+c!="0"&&(0===t.dateput.queue.length&&(p=!0),t.dateput.openLevel("empty"),t.dateput.append(c,this),p&&(t.dateput.current.value().blobs[0].strings.prefix=""),b&&t.dateput.append(b),_&&t.dateput.append(_),t.dateput.closeLevel())}else t.output.append(h,this);b&&t.output.append(b),_&&t.output.append(_),t.output.closeLevel()}else"month"===this.strings.name&&t.tmp.date_object.season&&((h=""+t.tmp.date_object.season)&&h.match(/^[1-4]$/)?(t.tmp.group_context.tip.variable_success=!0,t.output.append(t.getTerm("season-0"+h),this)):h&&t.output.append(h,this));t.tmp.value=[],!e[T]||!h&&!t.tmp.have_collapsed||t.opt.has_year_suffix||"year"!==this.strings.name||t.tmp.just_looking||t.registry.registry[e.id]&&!1!==t.registry.registry[e.id].disambig.year_suffix&&!t.tmp.has_done_year_suffix&&(t.tmp.has_done_year_suffix=!0,O=parseInt(t.registry.registry[e.id].disambig.year_suffix,10),I=new xt.NumericBlob(!1,O,this,e.id),this.successor_prefix=t[t.build.area].opt.layout_delimiter,this.splice_prefix=t[t.build.area].opt.layout_delimiter,S=new xt.Util.Suffixator(xt.SUFFIX_CHARS),I.setFormatter(S),"year-suffix-ranged"===t[t.tmp.area].opt.collapse&&(I.range_prefix=t.getTerm("citation-range-delimiter")),t[t.tmp.area].opt.cite_group_delimiter?I.successor_prefix=t[t.tmp.area].opt.cite_group_delimiter:t[t.tmp.area].opt["year-suffix-delimiter"]?I.successor_prefix=t[t.tmp.area].opt["year-suffix-delimiter"]:I.successor_prefix=t[t.tmp.area].opt.layout_delimiter,I.UGLY_DELIMITER_SUPPRESS_HACK=!0,t.output.append(I,"literal"))}},this.execs.push(i),e.push(this)}},(t.exports=xt).Node["else-if"]={build:function(t,e){xt.Conditions.TopNode.call(this,t,e),e.push(this)},configure:function(t,e){xt.Conditions.Configure.call(this,t,e)}},(t.exports=xt).Node.else={build:function(t,e){e.push(this)},configure:function(t,e){this.tokentype===xt.START&&(t.configure.fail[t.configure.fail.length-1]=e)}},(t.exports=xt).Node["et-al"]={build:function(t,e){if("citation"===t.build.area||"bibliography"===t.build.area){this.execs.push(function(t,e,i){"string"==typeof(t.tmp.etal_node=this).strings.term&&(t.tmp.etal_term=this.strings.term)})}e.push(this)}},(t.exports=xt).Node.group={build:function(c,t,e){var i,s,f;if(this.realGroup=e,this.tokentype===xt.START&&(xt.Util.substituteStart.call(this,c,t),c.build.substitute_level.value()&&c.build.substitute_level.replace(c.build.substitute_level.value()+1),this.juris||t.push(this),(s=[]).push(i=function(t,e){if(t.output.startTag("group",this),this.strings.label_form_override&&(t.tmp.group_context.tip.label_form||(t.tmp.group_context.tip.label_form=this.strings.label_form_override)),this.strings.label_capitalize_if_first_override&&(t.tmp.group_context.tip.label_capitalize_if_first||(t.tmp.group_context.tip.label_capitalize_if_first=this.strings.label_capitalize_if_first_override)),this.realGroup){var i=!1,s=!1;t.tmp.group_context.mystack.length&&(t.output.current.value().parent=t.tmp.group_context.tip.output_tip);var r=t.tmp.group_context.tip.label_form;r||(r=this.strings.label_form_override);var n=t.tmp.group_context.tip.label_capitalize_if_first;n||(n=this.strings.label_capitalize_if_first),t.tmp.group_context.tip.condition?(i=t.tmp.group_context.tip.condition,s=t.tmp.group_context.tip.force_suppress):this.strings.reject?(i={test:this.strings.reject,not:!0},s=!0):this.strings.require&&(i={test:this.strings.require,not:!1}),t.tmp.group_context.push({old_term_predecessor:t.tmp.term_predecessor,term_intended:!1,variable_attempt:!1,variable_success:!1,variable_success_parent:t.tmp.group_context.tip.variable_success,output_tip:t.output.current.tip,label_form:r,label_capitalize_if_first:n,parallel_conditions:this.strings.set_parallel_condition,condition:i,force_suppress:s,done_vars:t.tmp.group_context.tip.done_vars.slice()})}}),this.execs=s.concat(this.execs),this.strings["has-publisher-and-publisher-place"]&&(c.build["publisher-special"]=!0,i=function(t,e){if(this.strings["subgroup-delimiter"]&&e.publisher&&e["publisher-place"]){var i=e.publisher.split(/;\s*/),s=e["publisher-place"].split(/;\s*/);1<i.length&&i.length===s.length&&(t.publisherOutput=new xt.PublisherOutput(t,this),t.publisherOutput["publisher-list"]=i,t.publisherOutput["publisher-place-list"]=s)}},this.execs.push(i)),this.juris)){for(var r=0,n=t.length;r<n;r++)t[r];var a=new xt.Token("choose",xt.START);xt.Node.choose.build.call(a,c,t);var o=new xt.Token("if",xt.START);f=this.juris,i=function(t){if(!c.sys.retrieveStyleModule||!xt.MODULE_MACROS[f]||!t.jurisdiction)return!1;var e=c.getJurisdictionList(t.jurisdiction);if(!c.opt.jurisdictions_seen[e[0]]){var i=c.retrieveAllStyleModules(e);for(var s in i){c.juris[s]={};for(var r=xt.setupXml(i[s]),n=0,a=(p=r.getNodesByName(r.dataObj,"law-module")).length;n<a;n++){var o=r.getAttributeValue(p[n],"types");if(o){c.juris[s].types={};for(var l=0,u=(o=o.split(/\s+/)).length;l<u;l++)c.juris[s].types[o[l]]=!0}}var p;for(c.juris[s].types||(c.juris[s].types=xt.MODULE_TYPES),n=0,a=(p=r.getNodesByName(r.dataObj,"macro")).length;n<a;n++){var h=r.getAttributeValue(p[n],"name");xt.MODULE_MACROS[h]?(c.juris[s][h]=[],c.buildTokenLists(p[n],c.juris[s][h]),c.configureTokenList(c.juris[s][h])):xt.debug('CSL: skipping non-modular macro name "'+h+'" in module context')}}}for(n=0,a=e.length;n<a;n++)if(s=e[n],c.juris[s]&&c.juris[s].types[t.type])return t["best-jurisdiction"]=s,!0;return!1},o.tests.push(i),o.test=c.fun.match.any(o,c,o.tests),t.push(o);var l=new xt.Token("text",xt.SINGLETON);i=function(t,e,i){var s=0;if(t.juris[e["best-jurisdiction"]][this.juris])for(;s<t.juris[e["best-jurisdiction"]][this.juris].length;)s=xt.tokenExec.call(t,t.juris[e["best-jurisdiction"]][this.juris][s],e,i)},l.juris=this.juris,l.execs.push(i),t.push(l);var u=new xt.Token("if",xt.END);xt.Node.if.build.call(u,c,t);var p=new xt.Token("else",xt.START);xt.Node.else.build.call(p,c,t)}if(this.tokentype===xt.END&&(c.build["publisher-special"]&&(c.build["publisher-special"]=!1,"string"==typeof c[c.build.root].opt["name-delimiter"]&&(i=function(t,e){t.publisherOutput&&(t.publisherOutput.render(),t.publisherOutput=!1)},this.execs.push(i))),i=function(t,e){if(t.output.endTag(),this.realGroup){var i=t.tmp.group_context.pop();if(t.tmp.group_context.tip.condition&&(t.tmp.group_context.tip.force_suppress=i.force_suppress),!i.force_suppress&&(i.variable_success||i.term_intended&&!i.variable_attempt)){this.isJurisLocatorLabel||(t.tmp.group_context.tip.variable_success=!0);var s=t.output.current.value().blobs,r=t.output.current.value().blobs.length-1;if(!t.tmp.just_looking&&void 0!==i.parallel_conditions){var n={blobs:s,conditions:i.parallel_conditions,id:e.id,pos:r};t.parallel.parallel_conditional_blobs_list.push(n)}}else{if(t.tmp.term_predecessor=i.old_term_predecessor,t.tmp.group_context.tip.variable_attempt=i.variable_attempt,i.force_suppress&&!t.tmp.group_context.tip.condition){t.tmp.group_context.tip.variable_attempt=!0,t.tmp.group_context.tip.variable_success=i.variable_success_parent;for(var a=0,o=i.done_vars.length;a<o;a++)-1<t.tmp.done_vars.indexOf(i.done_vars[a])&&(t.tmp.done_vars=t.tmp.done_vars.slice(0,a).concat(t.tmp.done_vars.slice(a+1)))}t.output.current.value().blobs&&t.output.current.value().blobs.pop()}}},this.execs.push(i),this.juris)){var h=new xt.Token("else",xt.END);xt.Node.else.build.call(h,c,t);var m=new xt.Token("choose",xt.END);xt.Node.choose.build.call(m,c,t)}this.tokentype===xt.END&&(this.juris||t.push(this),c.build.substitute_level.value()&&c.build.substitute_level.replace(c.build.substitute_level.value()-1),xt.Util.substituteEnd.call(this,c,t))}},(t.exports=xt).Node.if={build:function(t,e){xt.Conditions.TopNode.call(this,t,e),e.push(this)},configure:function(t,e){xt.Conditions.Configure.call(this,t,e)}},(t.exports=xt).Node.conditions={build:function(t,e){this.tokentype===xt.START&&t.tmp.conditions.addMatch(this.match),this.tokentype===xt.END&&t.tmp.conditions.matchCombine()}},(t.exports=xt).Node.condition={build:function(t,e){if(this.tokentype===xt.SINGLETON){var i=t.fun.match[this.match](this,t,this.tests);t.tmp.conditions.addTest(i)}}},(t.exports=xt).Conditions={},xt.Conditions.TopNode=function(t,e){var i;this.tokentype!==xt.START&&this.tokentype!==xt.SINGLETON||(this.locale&&(t.opt.lang=this.locale),this.tests&&this.tests.length?this.test=t.fun.match[this.match](this,t,this.tests):t.tmp.conditions=new xt.Conditions.Engine(t,this)),this.tokentype!==xt.END&&this.tokentype!==xt.SINGLETON||(i=function(t,e){return this.locale_default&&(t.output.current.value().old_locale=this.locale_default,t.output.closeLevel("empty"),t.opt.lang=this.locale_default),this[t.tmp.jump.value()]},this.execs.push(i),this.locale_default&&(t.opt.lang=this.locale_default))},xt.Conditions.Configure=function(t,e){this.tokentype===xt.START?(this.fail=t.configure.fail.slice(-1)[0],this.succeed=this.next,t.configure.fail[t.configure.fail.length-1]=e):this.tokentype===xt.SINGLETON?(this.fail=this.next,this.succeed=t.configure.succeed.slice(-1)[0],t.configure.fail[t.configure.fail.length-1]=e):(this.succeed=t.configure.succeed.slice(-1)[0],this.fail=this.next)},xt.Conditions.Engine=function(t,e){this.token=e,this.state=t},xt.Conditions.Engine.prototype.addTest=function(t){this.token.tests.push(t)},xt.Conditions.Engine.prototype.addMatch=function(t){this.token.match=t},xt.Conditions.Engine.prototype.matchCombine=function(){this.token.test=this.state.fun.match[this.token.match](this.token,this.state,this.token.tests)},(t.exports=xt).Node.info={build:function(t,e){this.tokentype===xt.START?t.build.skip="info":t.build.skip=!1}},(t.exports=xt).Node.institution={build:function(t,e){if(-1<[xt.SINGLETON,xt.START].indexOf(this.tokentype)){this.execs.push(function(t,e){"string"==typeof this.strings.delimiter?t.tmp.institution_delimiter=this.strings.delimiter:t.tmp.institution_delimiter=t.tmp.name_delimiter,"text"===t.inheritOpt(this,"and")?this.and_term=t.getTerm("and","long",0):"symbol"===t.inheritOpt(this,"and")?t.opt.development_extensions.expect_and_symbol_form?this.and_term=t.getTerm("and","symbol",0):this.and_term="&":"none"===t.inheritOpt(this,"and")&&(this.and_term=t.tmp.institution_delimiter),void 0===this.and_term&&t.tmp.and_term&&(this.and_term=t.getTerm("and","long",0)),xt.STARTSWITH_ROMANESQUE_REGEXP.test(this.and_term)?(this.and_prefix_single=" ",this.and_prefix_multiple=", ","string"==typeof t.tmp.institution_delimiter&&(this.and_prefix_multiple=t.tmp.institution_delimiter),this.and_suffix=" "):(this.and_prefix_single="",this.and_prefix_multiple="",this.and_suffix=""),"always"===t.inheritOpt(this,"delimiter-precedes-last")?this.and_prefix_single=t.tmp.institution_delimiter:"never"===t.inheritOpt(this,"delimiter-precedes-last")&&this.and_prefix_multiple&&(this.and_prefix_multiple=" "),this.and={},void 0!==this.and_term?(t.output.append(this.and_term,"empty",!0),this.and.single=t.output.pop(),this.and.single.strings.prefix=this.and_prefix_single,this.and.single.strings.suffix=this.and_suffix,t.output.append(this.and_term,"empty",!0),this.and.multiple=t.output.pop(),this.and.multiple.strings.prefix=this.and_prefix_multiple,this.and.multiple.strings.suffix=this.and_suffix):"undefined"!==this.strings.delimiter&&(this.and.single=new xt.Blob(t.tmp.institution_delimiter),this.and.single.strings.prefix="",this.and.single.strings.suffix="",this.and.multiple=new xt.Blob(t.tmp.institution_delimiter),this.and.multiple.strings.prefix="",this.and.multiple.strings.suffix=""),t.nameOutput.institution=this})}e.push(this)},configure:function(t,e){-1<[xt.SINGLETON,xt.START].indexOf(this.tokentype)&&(t.build.has_institution=!0)}},(t.exports=xt).Node["institution-part"]={build:function(t,e){var i;"long"===this.strings.name?i=this.strings["if-short"]?function(t,e){t.nameOutput.institutionpart["long-with-short"]=this}:function(t,e){t.nameOutput.institutionpart.long=this}:"short"===this.strings.name&&(i=function(t,e){t.nameOutput.institutionpart.short=this}),this.execs.push(i),e.push(this)}},(t.exports=xt).Node.key={build:function(t,e){var i;e=t[t.build.root+"_sort"].tokens;var s=new xt.Token("key",xt.START);t.tmp.root=t.build.root,s.strings["et-al-min"]=t.inheritOpt(this,"et-al-min"),s.strings["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first"),s.strings["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last"),i=function(t,e){t.tmp.done_vars=[]},s.execs.push(i),t.opt.citation_number_sort_direction=this.strings.sort_direction,i=function(t,e){t.output.openLevel("empty")},s.execs.push(i);var r=[];if(this.strings.sort_direction===xt.DESCENDING?(r.push(1),r.push(-1)):(r.push(-1),r.push(1)),t[t.build.area].opt.sort_directions.push(r),-1<xt.DATE_VARIABLES.indexOf(this.variables[0])&&(t.build.date_key=!0),i=function(t,e){t.tmp.sort_key_flag=!0,t.inheritOpt(this,"et-al-min")&&(t.tmp["et-al-min"]=t.inheritOpt(this,"et-al-min")),t.inheritOpt(this,"et-al-use-first")&&(t.tmp["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first")),"boolean"==typeof t.inheritOpt(this,"et-al-use-last")&&(t.tmp["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last"))},s.execs.push(i),e.push(s),this.variables.length){var n=this.variables[0];if("citation-number"===n&&("citation"===t.build.area&&"_sort"===t.build.extension&&(t.opt.citation_number_sort=!1),"bibliography"===t.build.root&&"_sort"===t.build.extension&&(t.opt.citation_number_sort_used=!1)),-1<xt.NAME_VARIABLES.indexOf(n)){var a=new xt.Token("names",xt.START);a.tokentype=xt.START,a.variables=this.variables,xt.Node.names.build.call(a,t,e);var o=new xt.Token("name",xt.SINGLETON);o.tokentype=xt.SINGLETON,o.strings["name-as-sort-order"]="all",o.strings["sort-separator"]=" ",o.strings["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last"),o.strings["et-al-min"]=t.inheritOpt(this,"et-al-min"),o.strings["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first"),xt.Node.name.build.call(o,t,e);var l=new xt.Token("institution",xt.SINGLETON);l.tokentype=xt.SINGLETON,xt.Node.institution.build.call(l,t,e);var u=new xt.Token("names",xt.END);u.tokentype=xt.END,xt.Node.names.build.call(u,t,e)}else{var p=new xt.Token("text",xt.SINGLETON);if(p.dateparts=this.dateparts,-1<xt.NUMERIC_VARIABLES.indexOf(n))i=function(t,e){var i;i=!1,(i="citation-number"===n?t.registry.registry[e.id].seq.toString():e[n])&&(i=xt.Util.padding(i)),t.output.append(i,this)};else if("citation-label"===n)i=function(t,e){var i=t.getCitationLabel(e);t.output.append(i,this)};else if(-1<xt.DATE_VARIABLES.indexOf(n))i=xt.dateAsSortKey,p.variables=this.variables;else if("title"===n){i=t.transform.getOutputFunction(this.variables,"title",!1,!1,!0)}else i=function(t,e){var i=e[n];t.output.append(i,"empty")};p.execs.push(i),e.push(p)}}else{var h=new xt.Token("text",xt.SINGLETON);h.postponed_macro=this.postponed_macro,xt.expandMacro.call(t,h,e)}var c=new xt.Token("key",xt.END);i=function(t,e){var i=t.output.string(t,t.output.queue);t.sys.normalizeUnicode&&(i=t.sys.normalizeUnicode(i)),""===(i=i?i.split(" ").join(t.opt.sort_sep)+t.opt.sort_sep:"")&&(i=void 0),("string"!=typeof i||t.tmp.empty_date)&&(i=void 0,t.tmp.empty_date=!1),t[t[t.tmp.area].root+"_sort"].keys.push(i),t.tmp.value=[]},c.execs.push(i),t.build.date_key&&("citation"===t.build.area&&"_sort"===t.build.extension&&(t[t.build.area].opt.sort_directions.push([-1,1]),i=function(t,e){var i=t.registry.registry[e.id].disambig.year_suffix;i||(i=0);var s=xt.Util.padding(""+i);t[t.tmp.area].keys.push(s)},c.execs.push(i)),t.build.date_key=!1),i=function(t,e){t.tmp["et-al-min"]=void 0,t.tmp["et-al-use-first"]=void 0,t.tmp["et-al-use-last"]=void 0,t.tmp.sort_key_flag=!1},c.execs.push(i),e.push(c)}},(t.exports=xt).Node.label={build:function(t,e){if(this.strings.term){this.strings.form;this.execs.push(function(t,e,i){var s=xt.evaluateLabel(this,t,e,i);i&&"locator"===this.strings.term&&(t.parallel.StartVariable("label"),t.parallel.AppendToVariable(i.label),i.section_form_override=this.strings.form),s&&(t.tmp.group_context.tip.term_intended=!0),xt.UPDATE_GROUP_CONTEXT_CONDITION(t,s),-1===s.indexOf("%s")&&(this.strings.capitalize_if_first&&(t.tmp.term_predecessor||"in-text"===t.opt.class&&"citation"===t.tmp.area||(s=xt.Output.Formatters["capitalize-first"](t,s))),t.output.append(s,this)),i&&"locator"===this.strings.term&&t.parallel.CloseVariable()})}else{var i=t.build.names_variables.slice(-1)[0];t.build.name_label||(t.build.name_label={});for(var s=0,r=i.length;s<r;s+=1)t.build.name_label[i[s]]||(t.build.name_label[i[s]]={});if(t.build.name_flag)for(s=0,r=i.length;s<r;s+=1)t.build.name_label[i[s]].after=this;else for(var s=0,r=i.length;s<r;s+=1)t.build.name_label[i[s]].before=this}e.push(this)}},(t.exports=xt).Node.layout={build:function(t,e){var i,s,r,n,a;function o(){"bibliography"===t.build.area&&(r=new xt.Token("text",xt.SINGLETON),i=function(t,e,i){var s;t.tmp.cite_locales[t.tmp.cite_locales.length-1];s=t.tmp.cite_affixes[t.tmp.area][t.tmp.last_cite_locale]?t.tmp.cite_affixes[t.tmp.area][t.tmp.last_cite_locale].suffix:t.bibliography.opt.layout_suffix;var r=t.output.current.value();t.opt.using_display?r.blobs[r.blobs.length-1].strings.suffix=s:r.strings.suffix=s,t.bibliography.opt["second-field-align"]&&t.output.endTag("bib_other")},r.execs.push(i),e.push(r))}if(this.tokentype===xt.START&&(this.locale_raw?t.build.current_default_locale=this.locale_raw:t.build.current_default_locale=t.opt["default-locale"],i=function(t,e,i){t.opt.development_extensions.apply_citation_wrapper&&t.sys.wrapCitationEntry&&!t.tmp.just_looking&&e.system_id&&"citation"===t.tmp.area&&(cite_entry=new xt.Token("group",xt.START),cite_entry.decorations=[["@cite","entry"]],t.output.startTag("cite_entry",cite_entry),t.output.current.value().item_id=e.system_id,i&&(t.output.current.value().locator_txt=i.locator_txt,t.output.current.value().suffix_txt=i.suffix_txt))},this.execs.push(i)),this.tokentype!==xt.START||t.tmp.cite_affixes[t.build.area]||(i=function(t,e){t.tmp.done_vars=[],t.opt.suppressedJurisdictions[e.country]&&e.country&&-1===["treaty","patent"].indexOf(e.type)&&t.tmp.done_vars.push("country"),!t.tmp.just_looking&&t.registry.registry[e.id]&&t.registry.registry[e.id].parallel&&t.tmp.done_vars.push("first-reference-note-number"),t.tmp.rendered_name=!1},this.execs.push(i),i=function(t,e){t.tmp.sort_key_flag=!1},this.execs.push(i),i=function(t,e){t.tmp.nameset_counter=0},this.execs.push(i),i=function(t,e){var i=new xt.Token;t.opt.development_extensions.rtl_support&&-1<["ar","he","fa","ur","yi","ps","syr"].indexOf(e.language)&&((i=new xt.Token).strings.prefix="‫",i.strings.suffix="‬"),t.output.openLevel(i)},this.execs.push(i),e.push(this),t.opt.development_extensions.rtl_support,"citation"===t.build.area&&(s=new xt.Token("text",xt.SINGLETON),i=function(t,e,i){var s;if(i&&i.prefix){s="";var r=i.prefix.replace(/<[^>]+>/g,"").replace(/["'\u201d\u2019\u00bb\u202f\u00a0 ]+$/g,""),n=r.slice(-1);r.match(xt.ENDSWITH_ROMANESQUE_REGEXP)?s=" ":-1<xt.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(n)?s=" ":n.match(/[\)\],0-9]/)&&(s=" ");var a=!1;-1<xt.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(n)&&-1<i.prefix.trim().indexOf(" ")&&(a=!(t.tmp.term_predecessor=!1));var o=(i.prefix+s).replace(/\s+/g," ");t.tmp.just_looking||(o=t.output.checkNestedBrace.update(o)),t.output.append(o,this,!1,a)}},s.execs.push(i),e.push(s))),this.locale_raw&&((a=new xt.Token("dummy",xt.START)).locale=this.locale_raw,a.strings.delimiter=this.strings.delimiter,a.strings.suffix=this.strings.suffix,t.tmp.cite_affixes[t.build.area]||(t.tmp.cite_affixes[t.build.area]={})),this.tokentype===xt.START&&(t.build.layout_flag=!0,this.locale_raw||(t[t.tmp.area].opt.topdecor=[this.decorations],t[t.tmp.area+"_sort"].opt.topdecor=[this.decorations],t[t.build.area].opt.layout_prefix=this.strings.prefix,t[t.build.area].opt.layout_suffix=this.strings.suffix,t[t.build.area].opt.layout_delimiter=this.strings.delimiter,t[t.build.area].opt.layout_decorations=this.decorations,t.tmp.cite_affixes[t.build.area]&&(n=new xt.Token("else",xt.START),xt.Node.else.build.call(n,t,e))),this.locale_raw)){if(t.build.layout_locale_flag)a.name="else-if",xt.Attributes["@locale-internal"].call(a,t,this.locale_raw),xt.Node["else-if"].build.call(a,t,e);else{var l=new xt.Token("choose",xt.START);xt.Node.choose.build.call(l,t,e),a.name="if",xt.Attributes["@locale-internal"].call(a,t,this.locale_raw),xt.Node.if.build.call(a,t,e)}t.tmp.cite_affixes[t.build.area][a.locale]={},t.tmp.cite_affixes[t.build.area][a.locale].delimiter=this.strings.delimiter,t.tmp.cite_affixes[t.build.area][a.locale].suffix=this.strings.suffix}this.tokentype===xt.END&&(this.locale_raw&&(o(),t.build.layout_locale_flag?(a.name="else-if",a.tokentype=xt.END,xt.Attributes["@locale-internal"].call(a,t,this.locale_raw),xt.Node["else-if"].build.call(a,t,e)):(a.name="if",a.tokentype=xt.END,xt.Attributes["@locale-internal"].call(a,t,this.locale_raw),xt.Node.if.build.call(a,t,e),t.build.layout_locale_flag=!0)),this.locale_raw||(o(),t.tmp.cite_affixes[t.build.area]&&t.build.layout_locale_flag&&(n=new xt.Token("else",xt.END),xt.Node.else.build.call(n,t,e),n=new xt.Token("choose",xt.END),xt.Node.choose.build.call(n,t,e)),t.build_layout_locale_flag=!0,"citation"===t.build.area&&(r=new xt.Token("text",xt.SINGLETON),i=function(t,e,i){var s;if(i&&i.suffix){s="",(i.suffix.match(xt.STARTSWITH_ROMANESQUE_REGEXP)||-1<["[","("].indexOf(i.suffix.slice(0,1)))&&(s=" ");var r=i.suffix;t.tmp.just_looking||(r=t.output.checkNestedBrace.update(r)),t.output.append(s+r,this)}},r.execs.push(i),e.push(r)),i=function(t,e){t.output.closeLevel()},this.execs.push(i),i=function(t,e){t.opt.development_extensions.apply_citation_wrapper&&t.sys.wrapCitationEntry&&!t.tmp.just_looking&&e.system_id&&"citation"===t.tmp.area&&t.output.endTag()},this.execs.push(i),e.push(this),t.build.layout_flag=!1,t.build.layout_locale_flag=!1))}},(t.exports=xt).Node.macro={build:function(t,e){}},(t.exports=xt).NameOutput=function(t,e,i,s){this.debug=!1,this.state=t,this.Item=e,this.item=i,this.nameset_base=0,this.etal_spec={},this._first_creator_variable=!1,this._please_chop=!1},xt.NameOutput.prototype.init=function(t){this.state.tmp.term_predecessor&&(this.state.tmp.subsequent_author_substitute_ok=!1),this.nameset_offset&&(this.nameset_base=this.nameset_base+this.nameset_offset),this.nameset_offset=0,this.names=t,this.variables=t.variables,this.state.tmp.value=[],this.state.tmp.rendered_name=[],this.state.tmp.label_blob=!1,this.state.tmp.etal_node=!1,this.state.tmp.etal_term=!1;for(var e=0,i=this.variables.length;e<i;e+=1)this.Item[this.variables[e]]&&this.Item[this.variables[e]].length&&(this.state.tmp.value=this.state.tmp.value.concat(this.Item[this.variables[e]]));this["et-al"]=void 0,this.with=void 0,this.name=void 0,this.institutionpart={},this.state.tmp.group_context.tip.variable_attempt=!0,this.labelVariable=this.variables[0],this.state.tmp.value.length},xt.NameOutput.prototype.reinit=function(t,e){if(this.labelVariable=e,this.state.tmp.can_substitute.value()){this.nameset_offset=0,this.variables=t.variables;var i=this.state.tmp.value.slice();this.state.tmp.value=[];for(var s=0,r=this.variables.length;s<r;s+=1)this.Item[this.variables[s]]&&this.Item[this.variables[s]].length&&(this.state.tmp.value=this.state.tmp.value.concat(this.Item[this.variables[s]]));this.state.tmp.value.length&&this.state.tmp.can_substitute.replace(!1,xt.LITERAL),this.state.tmp.value=i}},xt.NameOutput.prototype.outputNames=function(){var t=this.variables;if(this.institution.and&&(this.institution.and.single.blobs&&this.institution.and.single.blobs.length||(this.institution.and.single.blobs=this.name.and.single.blobs),this.institution.and.multiple.blobs&&this.institution.and.multiple.blobs.length||(this.institution.and.multiple.blobs=this.name.and.multiple.blobs)),this.variable_offset={},this.family)for(this.family_decor=xt.Util.cloneToken(this.family),this.family_decor.strings.prefix="",this.family_decor.strings.suffix="",f=0,m=this.family.execs.length;f<m;f+=1)this.family.execs[f].call(this.family_decor,this.state,this.Item);else this.family_decor=!1;if(this.given)for(this.given_decor=xt.Util.cloneToken(this.given),this.given_decor.strings.prefix="",this.given_decor.strings.suffix="",f=0,m=this.given.execs.length;f<m;f+=1)this.given.execs[f].call(this.given_decor,this.state,this.Item);else this.given_decor=!1;if(this.getEtAlConfig(),this.divideAndTransliterateNames(),this.truncatePersonalNameLists(),this.disambigNames(),this.constrainNames(),"count"!==this.name.strings.form){this.setEtAlParameters(),this.setCommonTerm(),this.state.tmp.name_node={},this.state.tmp.name_node.children=[],this.renderAllNames();var e=[];for(f=0,m=t.length;f<m;f+=1){var i=t[f],s=[],r=!1,n=null;if(this.state.opt.development_extensions.spoof_institutional_affiliations){for(var a=0,o=this.institutions[i].length;a<o;a+=1)s.push(this.joinPersonsAndInstitutions([this.persons[i][a],this.institutions[i][a]]));if(this.institutions[i].length){var l=this.nameset_base+this.variable_offset[i];this.freeters[i].length&&(l+=1),r=this.joinInstitutionSets(s,l)}n=this.joinFreetersAndInstitutionSets([this.freeters[i],r])}else n=this._join([this.freeters[i]],"");if(n&&(this.state.tmp.extension||(n=this._applyLabels(n,i)),e.push(n)),this.common_term)break}for(this.state.output.openLevel("empty"),this.state.output.current.value().strings.delimiter=this.state.inheritOpt(this.names,"delimiter","names-delimiter"),f=0,m=e.length;f<m;f+=1)this.state.output.append(e[f],"literal",!0);this.state.output.closeLevel("empty");var u=this.state.output.pop(),p=xt.Util.cloneToken(this.names);if(this.state.output.append(u,p),this.state.tmp.term_predecessor_name&&(this.state.tmp.term_predecessor=!0),this.state.tmp.name_node.top=this.state.output.current.value(),"authority"!==t[0]){var h=[],c=this.Item[t[0]];if(c)for(var f=0,m=c.length;f<m;f+=1){var d=xt.Util.Names.getRawName(c[f]);d&&h.push(d)}(h=h.join(", "))&&(this.state.tmp.name_node.string=h)}if(this.state.tmp.name_node.string&&!this.state.tmp.first_name_string&&(this.state.tmp.first_name_string=this.state.tmp.name_node.string),"classic"===this.Item.type){var g=[];this.state.tmp.first_name_string&&g.push(this.state.tmp.first_name_string),this.Item.title&&g.push(this.Item.title),(g=g.join(", "))&&this.state.sys.getAbbreviation&&(this.state.transform.loadAbbreviation("default","classic",g),this.state.transform.abbrevs.default.classic[g]&&(this.state.tmp.done_vars.push("title"),this.state.output.append(this.state.transform.abbrevs.default.classic[g],"empty",!0),u=this.state.output.pop(),this.state.tmp.name_node.top.blobs.pop(),this.state.tmp.name_node.top.blobs.push(u)))}this._collapseAuthor(),this.variables=[]}else(this.state.tmp.extension||0!=this.names_count)&&(this.state.output.append(this.names_count,"empty"),this.state.tmp.group_context.tip.variable_success=!0)},xt.NameOutput.prototype._applyLabels=function(t,e){var i;if(!this.label||!this.label[this.labelVariable])return t;var s=0,r=this.freeters_count[e]+this.institutions_count[e];if(1<r)s=1;else{for(var n=0,a=this.persons[e].length;n<a;n+=1)r+=this.persons_count[e][n];1<r&&(s=1)}return this.label[this.labelVariable].before?("number"==typeof this.label[this.labelVariable].before.strings.plural&&(s=this.label[this.labelVariable].before.strings.plural),i=this._buildLabel(e,s,"before",this.labelVariable),this.state.output.openLevel("empty"),this.state.output.append(i,this.label[this.labelVariable].before,!0),this.state.output.append(t,"literal",!0),this.state.output.closeLevel("empty"),t=this.state.output.pop()):this.label[this.labelVariable].after&&("number"==typeof this.label[this.labelVariable].after.strings.plural&&(s=this.label[this.labelVariable].after.strings.plural),i=this._buildLabel(e,s,"after",this.labelVariable),this.state.output.openLevel("empty"),this.state.output.append(t,"literal",!0),this.state.output.append(i,this.label[this.labelVariable].after,!0),this.state.tmp.label_blob=this.state.output.pop(),this.state.output.append(this.state.tmp.label_blob,"literal",!0),this.state.output.closeLevel("empty"),t=this.state.output.pop()),t},xt.NameOutput.prototype._buildLabel=function(t,e,i,s){this.common_term&&(t=this.common_term);var r=!1,n=this.label[s][i];return n&&(r=xt.castLabel(this.state,n,t,e,xt.TOLERANT)),r},xt.NameOutput.prototype._collapseAuthor=function(){var t,e,i;0===this.nameset_base&&this.Item[this.variables[0]]&&!this._first_creator_variable&&(this._first_creator_variable=this.variables[0]),(this.item&&this.item["suppress-author"]&&this._first_creator_variable==this.variables[0]||this.state[this.state.tmp.area].opt.collapse&&this.state[this.state.tmp.area].opt.collapse.length||this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter.length)&&(this.state.tmp.authorstring_request?(e="",t=this.state.tmp.name_node.top.blobs.slice(-1)[0].blobs,i=this.state.tmp.offset_characters,t&&(e=this.state.output.string(this.state,t,!1)),this.state.tmp.offset_characters=i,this.state.registry.authorstrings[this.Item.id]=e):this.state.tmp.just_looking||this.state.tmp.suppress_decorations||!(this.item["suppress-author"]||this.state[this.state.tmp.area].opt.collapse&&this.state[this.state.tmp.area].opt.collapse.length||this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter)||(e="",t=this.state.tmp.name_node.top.blobs.slice(-1)[0].blobs,i=this.state.tmp.offset_characters,t&&(e=this.state.output.string(this.state,t,!1)),e===this.state.tmp.last_primary_names_string?((this.item["suppress-author"]||this.state[this.state.tmp.area].opt.collapse&&this.state[this.state.tmp.area].opt.collapse.length)&&(this.state.tmp.name_node.top.blobs.pop(),this.state.tmp.name_node.children=[],this.state.tmp.offset_characters=i),this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter&&(this.state.tmp.use_cite_group_delimiter=!0)):(this.state.tmp.last_primary_names_string=e,-1<this.variables.indexOf(this._first_creator_variable)&&this.item&&this.item["suppress-author"]&&"legal_case"!==this.Item.type&&(this.state.tmp.name_node.top.blobs.pop(),this.state.tmp.name_node.children=[],this.state.tmp.offset_characters=i,this.state.tmp.term_predecessor=!1),this.state.tmp.have_collapsed=!1,this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter&&(this.state.tmp.use_cite_group_delimiter=!1))))},(t.exports=xt).NameOutput.prototype.isPerson=function(t){return!(t.literal||!t.given&&t.family&&t.isInstitution)},(t.exports=xt).NameOutput.prototype.truncatePersonalNameLists=function(){var t,e,i,s;for(t in this.freeters_count={},this.persons_count={},this.institutions_count={},this.freeters)this.freeters.hasOwnProperty(t)&&(this.freeters_count[t]=this.freeters[t].length,this.freeters[t]=this._truncateNameList(this.freeters,t));for(t in this.persons)if(this.persons.hasOwnProperty(t))for(this.institutions_count[t]=this.institutions[t].length,this._truncateNameList(this.institutions,t),this.persons[t]=this.persons[t].slice(0,this.institutions[t].length),this.persons_count[t]=[],r=0,n=this.persons[t].length;r<n;r+=1)this.persons_count[t][r]=this.persons[t][r].length,this.persons[t][r]=this._truncateNameList(this.persons,t,r);if((s=1===this.etal_min&&1===this.etal_use_first&&!this.state.tmp.extension&&!this.state.tmp.just_looking&&t)||this._please_chop)for(e=0,i=this.variables.length;e<i;e+=1){t=this.variables[e],this.freeters[t].length&&(this._please_chop===t?(this.freeters[t]=this.freeters[t].slice(1),this.freeters_count[t]+=-1,this._please_chop=!1):s&&!this._please_chop&&(this.freeters[t]=this.freeters[t].slice(0,1),this.freeters_count[t]=1,this.institutions[t]=[],this.persons[t]=[],this._please_chop=s));for(var r=0,n=this.persons[t].length;r<n;r++)if(this.persons[t][r].length){if(this._please_chop===t){this.persons[t][r]=this.persons[t][r].slice(1),this.persons_count[t][r]+=-1,this._please_chop=!1;break}if(s&&!this._please_chop){this.freeters[t]=this.persons[t][r].slice(0,1),this.freeters_count[t]=1,this.institutions[t]=[],this.persons[t]=[],this._please_chop=s;break}}this.institutions[t].length&&(this._please_chop===t?(this.institutions[t]=this.institutions[t].slice(1),this.institutions_count[t]+=-1,this._please_chop=!1):s&&!this._please_chop&&(this.institutions[t]=this.institutions[t].slice(0,1),this.institutions_count[t]=1,this._please_chop=s))}for(e=0,i=this.variables.length;e<i;e+=1){this.institutions[t].length&&(this.nameset_offset+=1);for(r=0,n=this.persons[t].length;r<n;r++)this.persons[t][r].length&&(this.nameset_offset+=1)}},xt.NameOutput.prototype._truncateNameList=function(t,e,i){var s;if(s=void 0===i?t[e]:t[e][i],this.state[this.state[this.state.tmp.area].root].opt.max_number_of_names&&50<s.length&&s.length>this.state[this.state[this.state.tmp.area].root].opt.max_number_of_names+2){var r=this.state[this.state[this.state.tmp.area].root].opt.max_number_of_names;s=s.slice(0,r+1).concat(s.slice(-1))}return s},(t.exports=xt).NameOutput.prototype.divideAndTransliterateNames=function(){var t,e,i,s,r=this.Item,n=this.variables;for(this.varnames=n.slice(),this.freeters={},this.persons={},this.institutions={},t=0,e=n.length;t<e;t+=1){var a=n[t];this.variable_offset[a]=this.nameset_offset;var o=this._normalizeVariableValue(r,a);if(this.name.strings["suppress-min"]&&o.length>=this.name.strings["suppress-min"]&&(o=[]),this.name.strings["suppress-max"]&&o.length<=this.name.strings["suppress-max"]&&(o=[]),this._getFreeters(a,o),this._getPersonsAndInstitutions(a,o),this.state.opt.development_extensions.spoof_institutional_affiliations)if(0===this.name.strings["suppress-min"])for(this.freeters[a]=[],i=0,s=this.persons[a].length;i<s;i+=1)this.persons[a][i]=[];else if(0===this.institution.strings["suppress-min"]){for(this.institutions[a]=[],this.freeters[a]=this.freeters[a].concat(this.persons[a]),i=0,s=this.persons[a].length;i<s;i+=1)for(var l=0,u=this.persons[a][i].length;l<u;l+=1)this.freeters[a].push(this.persons[a][i][l]);this.persons[a]=[]}}},xt.NameOutput.prototype._normalizeVariableValue=function(t,e){return"string"==typeof t[e]||"number"==typeof t[e]?(xt.debug('name variable "'+e+'" is string or number, not array. Attempting to fix.'),[{literal:t[e]+""}]):t[e]?("number"!=typeof t[e].length&&(xt.debug('name variable "'+e+'" is object, not array. Attempting to fix.'),t[e]=[t[e]]),t[e].slice()):[]},xt.NameOutput.prototype._getFreeters=function(t,e){if(this.freeters[t]=[],this.state.opt.development_extensions.spoof_institutional_affiliations)for(var i=e.length-1;-1<i&&this.isPerson(e[i]);i--){(s=this._checkNickname(e.pop()))&&this.freeters[t].push(s)}else for(i=e.length-1;-1<i;i--){var s=e.pop();if(this.isPerson(s))s=this._checkNickname(s);this.freeters[t].push(s)}this.freeters[t].reverse(),this.freeters[t].length&&(this.nameset_offset+=1)},xt.NameOutput.prototype._getPersonsAndInstitutions=function(t,e){if(this.persons[t]=[],this.institutions[t]=[],this.state.opt.development_extensions.spoof_institutional_affiliations){for(var i=[],s=!1,r=!0,n=e.length-1;-1<n;n+=-1)if(this.isPerson(e[n])){var a=this._checkNickname(e[n]);a&&i.push(a)}else s=!0,this.institutions[t].push(e[n]),r||(i.reverse(),this.persons[t].push(i),i=[]),r=!1;s&&(i.reverse(),this.persons[t].push(i),this.persons[t].reverse(),this.institutions[t].reverse())}},xt.NameOutput.prototype._clearValues=function(t){for(var e=t.length-1;-1<e;e+=-1)t.pop()},xt.NameOutput.prototype._checkNickname=function(t){if(-1<["interview","personal_communication"].indexOf(this.Item.type)){var e;if((e=xt.Util.Names.getRawName(t))&&this.state.sys.getAbbreviation&&(!this.item||!this.item["suppress-author"])){var i=e;this.state.sys.normalizeAbbrevsKey&&(i=this.state.sys.normalizeAbbrevsKey("author",e)),this.state.transform.loadAbbreviation("default","nickname",i);var s=this.state.transform.abbrevs.default.nickname[i];s&&(t="!here>>>"!==s&&{family:s,given:""})}}return t},(t.exports=xt).NameOutput.prototype.joinPersons=function(t,e,i,s){return s||(s="name"),void 0===i?1===this.etal_spec[e].freeters?this._joinEtAl(t,s):2===this.etal_spec[e].freeters?this._joinEllipsis(t,s):this.state.tmp.sort_key_flag?this._join(t," "):this._joinAnd(t,s):1===this.etal_spec[e].persons[i]?this._joinEtAl(t,s):2===this.etal_spec[e].persons[i]?this._joinEllipsis(t,s):this.state.tmp.sort_key_flag?this._join(t," "):this._joinAnd(t,s)},xt.NameOutput.prototype.joinInstitutionSets=function(t,e){return 1===this.etal_spec[e].institutions?this._joinEtAl(t,"institution"):2===this.etal_spec[e].institutions?this._joinEllipsis(t,"institution"):this._joinAnd(t,"institution")},xt.NameOutput.prototype.joinPersonsAndInstitutions=function(t){return this._join(t,this.state.tmp.name_delimiter)},xt.NameOutput.prototype.joinFreetersAndInstitutionSets=function(t){return this._join(t,"[never here]",this.with.single,this.with.multiple)},xt.NameOutput.prototype._joinEtAl=function(t,e){var i=this._join(t,this.state.tmp.name_delimiter);return this.state.output.openLevel(this._getToken(e)),this.state.output.current.value().strings.delimiter="",this.state.output.append(i,"literal",!0),1<t.length?this.state.output.append(this["et-al"].multiple,"literal",!0):1===t.length&&this.state.output.append(this["et-al"].single,"literal",!0),this.state.output.closeLevel(),this.state.output.pop()},xt.NameOutput.prototype._joinEllipsis=function(t,e){return this._join(t,this.state.tmp.name_delimiter,this.name.ellipsis.single,this.name.ellipsis.multiple,e)},xt.NameOutput.prototype._joinAnd=function(t,e){return this._join(t,this.state.inheritOpt(this[e],"delimiter",e+"-delimiter",", "),this[e].and.single,this[e].and.multiple,e)},xt.NameOutput.prototype._join=function(t,e,i,s,r){var n,a;if(!t)return!1;for(n=t.length-1;-1<n;n+=-1)t[n]&&0!==t[n].length&&t[n].blobs.length||(t=t.slice(0,n).concat(t.slice(n+1)));if(!t.length)return!1;if(i&&2===t.length)i&&(i=new xt.Blob(i.blobs,i)),t=[t[0],i,t[1]];else{var o;for(o=s?2:1,n=0,a=t.length-o;n<a;n+=1)t[n].strings.suffix+=e;if(1<t.length){var l=t.pop();s?(s=new xt.Blob(s.blobs,s),t.push(s)):(i&&(i=new xt.Blob(i.blobs,i)),t.push(i)),t.push(l)}}for(this.state.output.openLevel(),i&&s&&(this.state.output.current.value().strings.delimiter=""),n=0,a=t.length;n<a;n+=1)this.state.output.append(t[n],!1,!0);return this.state.output.closeLevel(),this.state.output.pop()},xt.NameOutput.prototype._getToken=function(t){var e=this[t];return"institution"!==t?e:new xt.Token},(t.exports=xt).NameOutput.prototype.setCommonTerm=function(){var t=this.variables.slice();if(t.sort(),this.common_term=t.join(""),!this.common_term)return!1;var e=!1;if(this.label&&this.label[this.variables[0]]&&(this.label[this.variables[0]].before?e=this.state.getTerm(this.common_term,this.label[this.variables[0]].before.strings.form,0):this.label[this.variables[0]].after&&(e=this.state.getTerm(this.common_term,this.label[this.variables[0]].after.strings.form,0))),!this.state.locale[this.state.opt.lang].terms[this.common_term]||!e||this.variables.length<2)this.common_term=!1;else for(var i=0,s=this.variables.length-1;i<s;i+=1){var r=this.variables[i],n=this.variables[i+1];if((this.freeters[r].length||this.freeters[n].length)&&(this.etal_spec[r].freeters!==this.etal_spec[n].freeters||!this._compareNamesets(this.freeters[r],this.freeters[n])))return void(this.common_term=!1);if(this.persons[r].length!==this.persons[n].length)return void(this.common_term=!1);for(var a=0,o=this.persons[r].length;a<o;a+=1)if(this.etal_spec[r].persons[a]!==this.etal_spec[n].persons[a]||!this._compareNamesets(this.persons[r][a],this.persons[n][a]))return void(this.common_term=!1)}},xt.NameOutput.prototype._compareNamesets=function(t,e){if(t.length!==e.length)return!1;for(var i=0,s=e.length;i<s;i+=1){e[i];for(var r=0,n=xt.NAME_PARTS.length;r<n;r+=1){var a=xt.NAME_PARTS[r];if(!t[i]||t[i][a]!=e[i][a])return!1}}return!0},(t.exports=xt).NameOutput.prototype.constrainNames=function(){for(var t,e=this.names_count=0,i=this.variables.length;e<i;e+=1){var s=this.variables[e];t=this.nameset_base+e,this.freeters[s].length&&(this.state.tmp.names_max.push(this.freeters[s].length,"literal"),this._imposeNameConstraints(this.freeters,this.freeters_count,s,t),this.names_count+=this.freeters[s].length),this.institutions[s].length&&(this.state.tmp.names_max.push(this.institutions[s].length,"literal"),this._imposeNameConstraints(this.institutions,this.institutions_count,s,t),this.persons[s]=this.persons[s].slice(0,this.institutions[s].length),this.names_count+=this.institutions[s].length);for(var r=0,n=this.persons[s].length;r<n;r+=1)this.persons[s][r].length&&(this.state.tmp.names_max.push(this.persons[s][r].length,"literal"),this._imposeNameConstraints(this.persons[s],this.persons_count[s],r,t),this.names_count+=this.persons[s][r].length)}},xt.NameOutput.prototype._imposeNameConstraints=function(t,e,i,s){var r=t[i],n=this.state.tmp["et-al-min"];this.state.tmp.suppress_decorations?this.state.tmp.disambig_request&&this.state.tmp.disambig_request.names[s]?n=this.state.tmp.disambig_request.names[s]:e[i]>=this.etal_min&&(n=this.etal_use_first):(this.state.tmp.disambig_request&&this.state.tmp.disambig_request.names[s]>this.etal_use_first?n=e[i]<this.etal_min?e[i]:this.state.tmp.disambig_request.names[s]:e[i]>=this.etal_min&&(n=this.etal_use_first),this.etal_use_last&&n>this.etal_min-2&&(n=this.etal_min-2));var a=this.etal_min>=this.etal_use_first,o=e[i]>n;n>e[i]&&(n=r.length),a&&o&&(this.etal_use_last?t[i]=r.slice(0,n).concat(r.slice(-1)):t[i]=r.slice(0,n)),this.state.tmp.disambig_settings.names[s]=t[i].length,this.state.disambiguate.padBase(this.state.tmp.disambig_settings)},(t.exports=xt).NameOutput.prototype.disambigNames=function(){for(var t,e=0,i=this.variables.length;e<i;e+=1){var s=this.variables[e];if(t=this.nameset_base+e,this.freeters[s].length&&this._runDisambigNames(this.freeters[s],t),this.institutions[s].length){void 0===this.state.tmp.disambig_settings.givens[t]&&(this.state.tmp.disambig_settings.givens[t]=[]);for(var r=0,n=this.institutions[s].length;r<n;r+=1)void 0===this.state.tmp.disambig_settings.givens[t][r]&&this.state.tmp.disambig_settings.givens[t].push(2)}for(r=0,n=this.persons[s].length;r<n;r+=1)this.persons[s][r].length&&this._runDisambigNames(this.persons[s][r],t)}},xt.NameOutput.prototype._runDisambigNames=function(t,e){var i,s,r,n,a,o;for(n=0,a=t.length;n<a;n+=1)if(t[n].given||t[n].family){if(s=this.state.inheritOpt(this.name,"initialize-with"),this.state.registry.namereg.addname(""+this.Item.id,t[n],n),void 0===this.state.tmp.disambig_settings.givens[e])for(var l=0,u=e+1;l<u;l+=1)this.state.tmp.disambig_settings.givens[l]||(this.state.tmp.disambig_settings.givens[l]=[]);if(void 0===this.state.tmp.disambig_settings.givens[e][n]&&(i=this.state.inheritOpt(this.name,"form","name-form","long"),r=this.state.registry.namereg.evalname(""+this.Item.id,t[n],n,0,i,s),this.state.tmp.disambig_settings.givens[e].push(r)),i=this.state.inheritOpt(this.name,"form","name-form","long"),o=this.state.registry.namereg.evalname(""+this.Item.id,t[n],n,0,i,s),this.state.tmp.disambig_request){var p=this.state.tmp.disambig_settings.givens[e][n];1!==p||"by-cite"!==this.state.citation.opt["givenname-disambiguation-rule"]||void 0!==this.state.inheritOpt(this.name,"initialize-with")&&void 0!==t[n].given||(p=2),r=p,this.state.opt["disambiguate-add-givenname"]&&t[n].given&&(r=this.state.registry.namereg.evalname(""+this.Item.id,t[n],n,r,this.state.inheritOpt(this.name,"form","name-form","long"),this.state.inheritOpt(this.name,"initialize-with")))}else r=o;!this.state.tmp.just_looking&&this.item&&this.item.position===xt.POSITION_FIRST&&r<o&&(r=o),this.state.tmp.sort_key_flag||(this.state.tmp.disambig_settings.givens[e][n]=r,"string"!=typeof s||void 0!==this.name.strings.initialize&&!0!==this.name.strings.initialize||(this.state.tmp.disambig_settings.use_initials=!0))}},(t.exports=xt).NameOutput.prototype.getEtAlConfig=function(){var t=this.item;this["et-al"]={},this.state.output.append(this.etal_term,this.etal_style,!0),this["et-al"].single=this.state.output.pop(),this["et-al"].single.strings.suffix=this.etal_suffix,this["et-al"].single.strings.prefix=this.etal_prefix_single,this.state.output.append(this.etal_term,this.etal_style,!0),this["et-al"].multiple=this.state.output.pop(),this["et-al"].multiple.strings.suffix=this.etal_suffix,this["et-al"].multiple.strings.prefix=this.etal_prefix_multiple,void 0===t&&(t={}),t.position?(this.state.inheritOpt(this.name,"et-al-subsequent-min")?this.etal_min=this.state.inheritOpt(this.name,"et-al-subsequent-min"):this.etal_min=this.state.inheritOpt(this.name,"et-al-min"),this.state.inheritOpt(this.name,"et-al-subsequent-use-first")?this.etal_use_first=this.state.inheritOpt(this.name,"et-al-subsequent-use-first"):this.etal_use_first=this.state.inheritOpt(this.name,"et-al-use-first")):(this.state.tmp["et-al-min"]?this.etal_min=this.state.tmp["et-al-min"]:this.etal_min=this.state.inheritOpt(this.name,"et-al-min"),this.state.tmp["et-al-use-first"]?this.etal_use_first=this.state.tmp["et-al-use-first"]:this.etal_use_first=this.state.inheritOpt(this.name,"et-al-use-first"),"boolean"==typeof this.state.tmp["et-al-use-last"]?this.etal_use_last=this.state.tmp["et-al-use-last"]:this.etal_use_last=this.state.inheritOpt(this.name,"et-al-use-last")),this.state.tmp["et-al-min"]||(this.state.tmp["et-al-min"]=this.etal_min)},(t.exports=xt).NameOutput.prototype.setEtAlParameters=function(){var t,e,i,s;for(t=0,e=this.variables.length;t<e;t+=1){var r=this.variables[t];for(void 0===this.etal_spec[r]&&(this.etal_spec[r]={freeters:0,institutions:0,persons:[]}),this.etal_spec[this.nameset_base+t]=this.etal_spec[r],this.freeters[r].length&&this._setEtAlParameter("freeters",r),i=0,s=this.persons[r].length;i<s;i+=1)void 0===this.etal_spec[r][i]&&(this.etal_spec[r].persons[i]=0),this._setEtAlParameter("persons",r,i);this.institutions[r].length&&this._setEtAlParameter("institutions",r)}},xt.NameOutput.prototype._setEtAlParameter=function(t,e,i){var s,r;r="persons"===t?(s=this.persons[e][i],this.persons_count[e][i]):(s=this[t][e],this[t+"_count"][e]),s.length<r&&!this.state.tmp.sort_key_flag?this.etal_use_last?"persons"===t?this.etal_spec[e].persons[i]=2:this.etal_spec[e][t]=2:"persons"===t?this.etal_spec[e].persons[i]=1:this.etal_spec[e][t]=1:"persons"===t?this.etal_spec[e].persons[i]=0:this.etal_spec[e][t]=0},(t.exports=xt).NameOutput.prototype.renderAllNames=function(){for(var t,e=0,i=this.variables.length;e<i;e+=1){var s=this.variables[e];(this.freeters[s].length||this.institutions[s].length)&&(this.state.tmp.group_context.tip.condition||(this.state.tmp.just_did_number=!1)),t=this.nameset_base+e,this.freeters[s].length&&(this.freeters[s]=this._renderNames(s,this.freeters[s],t));for(var r=0,n=this.institutions[s].length;r<n;r+=1)this.persons[s][r]=this._renderNames(s,this.persons[s][r],t,r)}this.renderInstitutionNames()},xt.NameOutput.prototype.renderInstitutionNames=function(){for(var t=0,e=this.variables.length;t<e;t+=1)for(var i=this.variables[t],s=0,r=this.institutions[i].length;s<r;s+=1){var n,a=this.institutions[i][s],o={primary:"locale-orig",secondary:!1,tertiary:!1};if(n=this.state.tmp.extension?["sort"]:a.isInstitution||a.literal?this.state.opt["cite-lang-prefs"].institutions:this.state.opt["cite-lang-prefs"].persons)for(var l=["primary","secondary","tertiary"],u=0,p=l.length;u<p&&!(n.length-1<u);u+=1)n[u]&&(o[l[u]]="locale-"+n[u]);else o.primary="locale-translat";"bibliography"===this.state.tmp.area||"citation"===this.state.tmp.area&&"note"===this.state.opt.xclass&&this.item&&!this.item.position||(o.secondary=!1,o.tertiary=!1),this.setRenderedName(a);var h=this._renderInstitutionName(i,a,o,s);this.institutions[i][s]=h}},xt.NameOutput.prototype._renderInstitutionName=function(t,e,i,s){var r,n,a,o,l,u=this.getName(e,i.primary,!0),p=u.name,h=u.usedOrig;if(p&&(p=this.fixupInstitution(p,t,s)),c=!1,i.secondary){var c=(u=this.getName(e,i.secondary,!1,h)).name;h=u.usedOrig,c&&(c=this.fixupInstitution(c,t,s))}r=!1,i.tertiary&&(r=(u=this.getName(e,i.tertiary,!1,h)).name)&&(r=this.fixupInstitution(r,t,s));var f={l:{pri:!1,sec:!1,ter:!1},s:{pri:!1,sec:!1,ter:!1}};switch(p&&(f.l.pri=p.long,f.s.pri=p.short.length?p.short:p.long),c&&(f.l.sec=c.long,f.s.sec=c.short.length?c.short:c.long),r&&(f.l.ter=r.long,f.s.ter=r.short.length?r.short:r.long),this.institution.strings["institution-parts"]){case"short":o=p.short.length?(a=this._getShortStyle(),[this._composeOneInstitutionPart([f.s.pri,f.s.sec,f.s.ter],i,a,t)]):(n=this._getLongStyle(p,t,s),[this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],i,n,t)]);break;case"short-long":n=this._getLongStyle(p,t,s),a=this._getShortStyle(),o=[l=this._renderOneInstitutionPart(p.short,a),this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],i,n,t)];break;case"long-short":n=this._getLongStyle(p,t,s),a=this._getShortStyle(),l=this._renderOneInstitutionPart(p.short,a),o=[this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],i,n,t),l];break;default:n=this._getLongStyle(p,t,s),o=[this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],i,n,t)]}var m=this._join(o," ");return this.state.tmp.name_node.children.push(m),m},xt.NameOutput.prototype._composeOneInstitutionPart=function(t,e,i,s){var r,n,a,o,l=!1,u=!1,p=!1;if(t[0]){if(r=xt.Util.cloneToken(i),this.state.opt.citeAffixes[e.primary]&&"<i>"===this.state.opt.citeAffixes.institutions[e.primary].prefix){for(var h=!1,c=0,f=r.decorations.length;c<f;c+=1)"@font-style"===i.decorations[c][0]&&"italic"===r.decorations[c][1]&&(h=!0);h||r.decorations.push(["@font-style","italic"])}l=this._renderOneInstitutionPart(t[0],r)}if(t[1]&&(u=this._renderOneInstitutionPart(t[1],i)),t[2]&&(p=this._renderOneInstitutionPart(t[2],i)),u||p){this.state.output.openLevel("empty"),this.state.output.append(l),n=xt.Util.cloneToken(i),e.secondary&&(n.strings.prefix=this.state.opt.citeAffixes.institutions[e.secondary].prefix,n.strings.suffix=this.state.opt.citeAffixes.institutions[e.secondary].suffix,n.strings.prefix||(n.strings.prefix=" "));var m=new xt.Token;m.decorations.push(["@font-style","normal"]),m.decorations.push(["@font-weight","normal"]),this.state.output.openLevel(m),this.state.output.append(u,n),this.state.output.closeLevel(),a=xt.Util.cloneToken(i),e.tertiary&&(a.strings.prefix=this.state.opt.citeAffixes.institutions[e.tertiary].prefix,a.strings.suffix=this.state.opt.citeAffixes.institutions[e.tertiary].suffix,a.strings.prefix||(a.strings.prefix=" "));var d=new xt.Token;d.decorations.push(["@font-style","normal"]),d.decorations.push(["@font-weight","normal"]),this.state.output.openLevel(d),this.state.output.append(p,a),this.state.output.closeLevel(),this.state.output.closeLevel(),o=this.state.output.pop()}else o=l;return o},xt.NameOutput.prototype._renderOneInstitutionPart=function(t,e){for(var i=0,s=t.length;i<s;i+=1)if(t[i]){var r=t[i];if(this.state.tmp.strip_periods)r=r.replace(/\./g,"");else for(var n=0,a=e.decorations.length;n<a;n+=1)if("@strip-periods"===e.decorations[n][0]&&"true"===e.decorations[n][1]){r=r.replace(/\./g,"");break}this.state.tmp.group_context.tip.variable_success=!0,this.state.tmp.can_substitute.replace(!1,xt.LITERAL),t[i]="!here>>>"!==r&&(this.state.output.append(r,e,!0),this.state.output.pop())}return void 0===this.institution.strings["part-separator"]&&(this.institution.strings["part-separator"]=this.state.tmp.name_delimiter),this._join(t,this.institution.strings["part-separator"])},xt.NameOutput.prototype._renderNames=function(t,e,i,s){var r=!1;if(e.length){for(var n=[],a=0,o=e.length;a<o;a+=1){var l,u=e[a],p={primary:"locale-orig",secondary:!1,tertiary:!1};if(l=this.state.tmp.extension?["sort"]:u.isInstitution||u.literal?this.state.opt["cite-lang-prefs"].institutions:this.state.opt["cite-lang-prefs"].persons)for(var h=["primary","secondary","tertiary"],c=0,f=h.length;c<f&&!(l.length-1<c);c+=1)p[h[c]]="locale-"+l[c];else p.primary="locale-translat";if((this.state.tmp.sort_key_flag||"bibliography"!==this.state.tmp.area&&("citation"!==this.state.tmp.area||"note"!==this.state.opt.xclass||!this.item||this.item.position))&&(p.secondary=!1,p.tertiary=!1),this.setRenderedName(u),u.literal||u.isInstitution)n.push(this._renderInstitutionName(t,u,p,s));else{var m=this._renderPersonalName(t,u,p,i,a,s),d=xt.Util.cloneToken(this.name);this.state.output.append(m,d,!0),n.push(this.state.output.pop())}}r=this.joinPersons(n,i,s)}return r},xt.NameOutput.prototype._renderPersonalName=function(t,e,i,s,r,n){var a=this.getName(e,i.primary,!0),o=this._renderOnePersonalName(a.name,s,r,n),l=!1;i.secondary&&(a=this.getName(e,i.secondary,!1,a.usedOrig)).name&&(l=this._renderOnePersonalName(a.name,s,r,n));var u,p=!1;if(i.tertiary&&(a=this.getName(e,i.tertiary,!1,a.usedOrig)).name&&(p=this._renderOnePersonalName(a.name,s,r,n)),l||p){this.state.output.openLevel("empty"),this.state.output.append(o);var h=new xt.Token;i.secondary&&(h.strings.prefix=this.state.opt.citeAffixes.persons[i.secondary].prefix,h.strings.suffix=this.state.opt.citeAffixes.persons[i.secondary].suffix,h.strings.prefix||(h.strings.prefix=" ")),this.state.output.append(l,h);var c=new xt.Token;i.tertiary&&(c.strings.prefix=this.state.opt.citeAffixes.persons[i.tertiary].prefix,c.strings.suffix=this.state.opt.citeAffixes.persons[i.tertiary].suffix,c.strings.prefix||(c.strings.prefix=" ")),this.state.output.append(p,c),this.state.output.closeLevel(),u=this.state.output.pop()}else u=o;return u},xt.NameOutput.prototype._isRomanesque=function(t){var e,i=2;return t.family.replace(/\"/g,"").match(xt.ROMANESQUE_REGEXP)||(i=0),!i&&t.given&&t.given.match(xt.STARTSWITH_ROMANESQUE_REGEXP)&&(i=1),2==i&&(t.multi&&t.multi.main?e=t.multi.main.slice(0,2):this.Item.language&&(e=this.Item.language.slice(0,2)),-1<["ja","zh"].indexOf(e)&&(i=1)),i},xt.NameOutput.prototype._renderOnePersonalName=function(t,e,i,s){var r=t,n=this._droppingParticle(r,e,s),a=this._familyName(r),o=this._nonDroppingParticle(r),l=this._givenName(r,e,i),u=this._nameSuffix(r);!1===l&&(u=n=!1);var p,h=this.state.inheritOpt(this.name,"sort-separator");h||(h=""),p=r["comma-suffix"]?", ":" ";var c=this._isRomanesque(r);var f,m,d,g,b=function t(e){return!!e&&("string"==typeof e.blobs?-1<["’","'","-"," "].indexOf(e.blobs.slice(-1)):t(e.blobs[e.blobs.length-1]))}(o);if(0===c)f=this._join([o,a,l],"");else if(1===c||r["static-ordering"])f=this._join([o,a,l]," ");else if(r["reverse-ordering"])f=this._join([l,o,a]," ");else if(this.state.tmp.sort_key_flag)f=(m="never"===this.state.opt["demote-non-dropping-particle"]?(d=this._join([o,a,n]," "),this._join([d,l],this.state.opt.sort_sep)):(g=this._join([l,n,o]," "),this._join([a,g],this.state.opt.sort_sep)),this._join([m,u]," "));else if("all"===this.state.inheritOpt(this.name,"name-as-sort-order")||"first"===this.state.inheritOpt(this.name,"name-as-sort-order")&&0===i&&(0===s||void 0===s))-1<["Lord","Lady"].indexOf(r.given)&&(h=", "),f=(m=-1<["always","display-and-sort"].indexOf(this.state.opt["demote-non-dropping-particle"])?(g=this._join([l,n],r["comma-dropping-particle"]+" "),(g=this._join([g,o]," "))&&this.given&&(g.strings.prefix=this.given.strings.prefix,g.strings.suffix=this.given.strings.suffix),a&&this.family&&(a.strings.prefix=this.family.strings.prefix,a.strings.suffix=this.family.strings.suffix),this._join([a,g],h)):((d=b?this._join([o,a],""):this._join([o,a]," "))&&this.family&&(d.strings.prefix=this.family.strings.prefix,d.strings.suffix=this.family.strings.suffix),(g=this._join([l,n],r["comma-dropping-particle"]+" "))&&this.given&&(g.strings.prefix=this.given.strings.prefix,g.strings.suffix=this.given.strings.suffix),this._join([d,g],h)),this._join([m,u],h));else{r["dropping-particle"]&&r.family&&!r["non-dropping-particle"]&&-1<["'","ʼ","’","-"].indexOf(r["dropping-particle"].slice(-1))&&(a=this._join([n,a],""),n=!1),this.state.tmp.term_predecessor;var _=" ";this.state.inheritOpt(this.name,"initialize-with")&&this.state.inheritOpt(this.name,"initialize-with").match(/[\u00a0\ufeff]/)&&-1<["fr","ru","cs"].indexOf(this.state.opt["default-locale"][0].slice(0,2))&&(_=" "),g=b?(g=this._join([o,a],""),this._join([n,g],_)):this._join([n,o,a],_),(g=this._join([g,u],p))&&this.family&&(g.strings.prefix=this.family.strings.prefix,g.strings.suffix=this.family.strings.suffix),l&&this.given&&(l.strings.prefix=this.given.strings.prefix,l.strings.suffix=this.given.strings.suffix),g.strings.prefix&&(r["comma-dropping-particle"]=""),f=this._join([l,g],r["comma-dropping-particle"]+_)}return this.state.tmp.group_context.tip.variable_success=!0,this.state.tmp.can_substitute.replace(!1,xt.LITERAL),this.state.tmp.term_predecessor=!0,this.state.tmp.name_node.children.push(f),f},xt.NameOutput.prototype._normalizeNameInput=function(t){var e={literal:t.literal,family:t.family,isInstitution:t.isInstitution,given:t.given,suffix:t.suffix,"comma-suffix":t["comma-suffix"],"non-dropping-particle":t["non-dropping-particle"],"dropping-particle":t["dropping-particle"],"static-ordering":t["static-ordering"],"static-particles":t["static-particles"],"reverse-ordering":t["reverse-ordering"],"full-form-always":t["full-form-always"],"parse-names":t["parse-names"],"comma-dropping-particle":"",block_initialize:t.block_initialize,multi:t.multi};return this._parseName(e),e},xt.NameOutput.prototype._stripPeriods=function(t,e){var i=this[t+"_decor"];if(e)if(this.state.tmp.strip_periods)e=e.replace(/\./g,"");else if(i)for(var s=0,r=i.decorations.length;s<r;s+=1)if("@strip-periods"===i.decorations[s][0]&&"true"===i.decorations[s][1]){e=e.replace(/\./g,"");break}return e},xt.NameOutput.prototype._nonDroppingParticle=function(t){var e=t["non-dropping-particle"];e&&this.state.tmp.sort_key_flag&&(e=e.replace(/[\'\u2019]/,""));var i=this._stripPeriods("family",e);return!!this.state.output.append(i,this.family_decor,!0)&&this.state.output.pop()},xt.NameOutput.prototype._droppingParticle=function(t,e,i){var s=t["dropping-particle"];s&&this.state.tmp.sort_key_flag&&(s=s.replace(/[\'\u2019]/,""));var r=this._stripPeriods("given",s);if(t["dropping-particle"]&&t["dropping-particle"].match(/^et.?al[^a-z]$/))this.state.inheritOpt(this.name,"et-al-use-last")?void 0===i?this.etal_spec[e].freeters=2:this.etal_spec[e].persons=2:void 0===i?this.etal_spec[e].freeters=1:this.etal_spec[e].persons=1,t["comma-dropping-particle"]="";else if(this.state.output.append(r,this.given_decor,!0))return this.state.output.pop();return!1},xt.NameOutput.prototype._familyName=function(t){var e=this._stripPeriods("family",t.family);return!!this.state.output.append(e,this.family_decor,!0)&&this.state.output.pop()},xt.NameOutput.prototype._givenName=function(t,e,i){var s,r,n="long"!==this.state.inheritOpt(this.name,"form","name-form","long"),a=!(!1===this.state.inheritOpt(this.name,"initialize")),o="string"==typeof this.state.inheritOpt(this.name,"initialize-with")&&!t.block_initialize;this.state.tmp.area.slice(0,12);if(t["full-form-always"])r=2;else{s=n?0:o?1:2;var l=this.state.tmp.disambig_settings.givens[e][i];r=s<l?l:s}var u=this.state.citation.opt["givenname-disambiguation-rule"];if(u&&"-with-initials"===u.slice(-14)&&(o=!0),t.family&&1===r)if(o){var p=this.state.inheritOpt(this.name,"initialize-with",!1,"");t.given=xt.Util.Names.initializeWith(this.state,t.given,p,!a)}else t.given=xt.Util.Names.unInitialize(this.state,t.given);else{if(0===r)return!1;2===r&&(t.given=xt.Util.Names.unInitialize(this.state,t.given))}var h=this._stripPeriods("given",t.given);return!!this.state.output.append(h,this.given_decor,!0)&&this.state.output.pop()},xt.NameOutput.prototype._nameSuffix=function(t){var e,i=t.suffix;"string"==typeof this.state.inheritOpt(this.name,"initialize-with")&&(i=xt.Util.Names.initializeWith(this.state,t.suffix,this.state.inheritOpt(this.name,"initialize-with"),!0));var s="";return(i=this._stripPeriods("family",i))&&"."===i.slice(-1)&&(i=i.slice(0,-1),s="."),!!this.state.output.append(i,"empty",!0)&&((e=this.state.output.pop()).strings.suffix=s+e.strings.suffix,e)},xt.NameOutput.prototype._getLongStyle=function(t,e,i){var s;return(s=t.short.length&&this.institutionpart["long-with-short"]?this.institutionpart["long-with-short"]:this.institutionpart.long)||(s=new xt.Token),s},xt.NameOutput.prototype._getShortStyle=function(){return this.institutionpart.short?this.institutionpart.short:new xt.Token},xt.NameOutput.prototype._parseName=function(t){if(!t["parse-names"]&&void 0!==t["parse-names"])return t;var e;t.family&&!t.given&&t.isInstitution&&(t.literal=t.family,t.family=void 0,t.isInstitution=void 0),t.family&&'"'===t.family.slice(0,1)&&'"'===t.family.slice(-1)||!t["parse-names"]&&void 0!==t["parse-names"]?(t.family=t.family.slice(1,-1),e=!0,t["parse-names"]=0):e=!1,this.state.opt.development_extensions.parse_names&&!t["non-dropping-particle"]&&t.family&&!e&&t.given&&(t["static-particles"]||xt.parseParticles(t,!0))},xt.NameOutput.prototype.getName=function(t,e,i,s){if(s&&"locale-orig"===e)return{name:!1,usedOrig:s};t.family||(t.family=""),t.given||(t.given="");var r={};r["static-ordering"]=this.getStaticOrder(t);var n,a=!0;if("locale-orig"!==e&&(a=!1,t.multi))for(var o=this.state.opt[e],l=0,u=o.length;l<u;l+=1)if(n=o[l],t.multi._key[n]){a=!0;var p=t.isInstitution;(t=t.multi._key[n]).isInstitution=p,(r=this.getNameParams(n)).transliterated=!0;break}return a||(n=!1,t.multi&&t.multi.main?n=t.multi.main:this.Item.language&&(n=this.Item.language),n&&(r=this.getNameParams(n))),i||a?(t.family||(t.family=""),t.given||(t.given=""),!(t={family:t.family,given:t.given,"non-dropping-particle":t["non-dropping-particle"],"dropping-particle":t["dropping-particle"],suffix:t.suffix,"static-ordering":r["static-ordering"],"static-particles":t["static-particles"],"reverse-ordering":r["reverse-ordering"],"full-form-always":r["full-form-always"],"parse-names":t["parse-names"],"comma-suffix":t["comma-suffix"],"comma-dropping-particle":t["comma-dropping-particle"],transliterated:r.transliterated,block_initialize:r["block-initialize"],literal:t.literal,isInstitution:t.isInstitution,multi:t.multi}).literal&&!t.given&&t.family&&t.isInstitution&&(t.literal=t.family),t.literal&&(delete t.family,delete t.given),{name:t=this._normalizeNameInput(t),usedOrig:s||!a}):{name:!1,usedOrig:s}},xt.NameOutput.prototype.getNameParams=function(t){var e={},i=xt.localeResolve(this.Item.language,this.state.opt["default-locale"][0]),s=this.state.locale[i.best]?i.best:this.state.opt["default-locale"][0],r=this.state.locale[s].opts["name-as-sort-order"],n=this.state.locale[s].opts["name-as-reverse-order"],a=this.state.locale[s].opts["name-never-short"],o=t.split("-")[0];return r&&r[o]&&(e["static-ordering"]=!0,e["reverse-ordering"]=!1),n&&n[o]&&(e["reverse-ordering"]=!0,e["static-ordering"]=!1),a&&a[o]&&(e["full-form-always"]=!0),e["static-ordering"]&&(e["block-initialize"]=!0),e},xt.NameOutput.prototype.setRenderedName=function(t){if("bibliography"===this.state.tmp.area){for(var e="",i=0,s=xt.NAME_PARTS.length;i<s;i+=1)t[xt.NAME_PARTS[i]]&&(e+=t[xt.NAME_PARTS[i]]);this.state.tmp.rendered_name.push(e)}},xt.NameOutput.prototype.fixupInstitution=function(t,e,i){this.state.sys.getHumanForm&&"legal_case"===this.Item.type&&"authority"===e&&(t.literal=this.state.sys.getHumanForm(this.Item.jurisdiction,t.literal,!0)),t=this._splitInstitution(t,e,i),this.institution.strings["reverse-order"]&&t.long.reverse();var s=t.long,r=t.long.slice(),n=!1;if(this.state.sys.getAbbreviation)for(var a=this.Item.jurisdiction,o=0,l=s.length;o<l;o+=1){var u=s[o];this.state.sys.normalizeAbbrevsKey&&(u=this.state.sys.normalizeAbbrevsKey(e,s[o])),a=this.state.transform.loadAbbreviation(a,"institution-part",u),this.state.transform.abbrevs[a]["institution-part"][u]&&(r[o]=this.state.transform.abbrevs[a]["institution-part"][u],n=!0)}return t.short=n?r:[],t},xt.NameOutput.prototype.getStaticOrder=function(t,e){var i=!1;return!e&&t["static-ordering"]?i=!0:0===this._isRomanesque(t)?i=!0:(!t.multi||!t.multi.main)&&this.Item.language&&-1<["vi","hu"].indexOf(this.Item.language)?i=!0:t.multi&&t.multi.main&&-1<["vi","hu"].indexOf(t.multi.main.slice(0,2))?i=!0:this.state.opt["auto-vietnamese-names"]&&xt.VIETNAMESE_NAMES.exec(t.family+" "+t.given)&&xt.VIETNAMESE_SPECIALS.exec(t.family+t.given)&&(i=!0),i},xt.NameOutput.prototype._splitInstitution=function(t,e,i){var s={};!t.literal&&t.family&&(t.literal=t.family,delete t.family);var r=t.literal.replace(/\s*\|\s*/g,"|");if(r=r.split("|"),"short"===this.institution.strings.form&&this.state.sys.getAbbreviation)for(var n=this.Item.jurisdiction,a=r.length;0<a;a+=-1){var o=r.slice(0,a).join("|"),l=o;if(this.state.sys.normalizeAbbrevsKey&&(l=this.state.sys.normalizeAbbrevsKey(e,o)),n=this.state.transform.loadAbbreviation(n,"institution-entire",l),this.state.transform.abbrevs[n]["institution-entire"][l]){var u=this.state.transform.abbrevs[n]["institution-entire"][l],p=(u=this.state.transform.quashCheck(u)).split(/>>[0-9]{4}>>/),h=u.match(/>>([0-9]{4})>>/);if(u=p.pop(),0<p.length&&this.Item["original-date"]&&this.Item["original-date"].year)for(var c=h.length-1;0<c&&!(parseInt(this.Item["original-date"].year,10)>=parseInt(h[c],10));c+=-1)u=p.pop();r=[u=u.replace(/\s*\|\s*/g,"|")];break}}return r.reverse(),s.long=this._trimInstitution(r,e,i),s},xt.NameOutput.prototype._trimInstitution=function(t,e,i){var s=!1,r=!1,n=t.slice(),a=!1;return this.institution&&(void 0!==this.institution.strings["use-first"]&&(s=this.institution.strings["use-first"]),void 0!==this.institution.strings["stop-last"]?a=this.institution.strings["stop-last"]:"authority"===e&&this.state.tmp.authority_stop_last&&(a=this.state.tmp.authority_stop_last),a&&(n=n.slice(0,a),t=t.slice(0,a)),void 0!==this.institution.strings["use-last"]&&(r=this.institution.strings["use-last"]),"authority"===e&&(a&&(this.state.tmp.authority_stop_last=a),r&&(this.state.tmp.authority_stop_last+=-1*r))),!1===s&&(0===this.persons[e].length&&(s=this.institution.strings["substitute-use-first"]),s||(s=0)),!1===r&&(r=s?0:t.length),s>t.length-r&&(s=t.length-r),t=t.slice(0,s),n=n.slice(s),r&&(r>n.length&&(r=n.length),r&&(t=t.concat(n.slice(n.length-r)))),t},(t.exports=xt).PublisherOutput=function(t,e){this.state=t,this.group_tok=e,this.varlist=[]},xt.PublisherOutput.prototype.render=function(){this.clearVars(),this.composeAndBlob(),this.composeElements(),this.composePublishers(),this.joinPublishers()},xt.PublisherOutput.prototype.composeAndBlob=function(){var t=!(this.and_blob={});"text"===this.group_tok.strings.and?t=this.state.getTerm("and"):"symbol"===this.group_tok.strings.and&&(t="&");var e=new xt.Token;e.strings.suffix=" ",e.strings.prefix=" ",this.state.output.append(t,e,!0);var i=this.state.output.pop();e.strings.prefix=this.group_tok.strings["subgroup-delimiter"],this.state.output.append(t,e,!0);var s=this.state.output.pop();this.and_blob.single=!1,this.and_blob.multiple=!1,t&&("always"===this.group_tok.strings["subgroup-delimiter-precedes-last"]?this.and_blob.single=s:"never"===this.group_tok.strings["subgroup-delimiter-precedes-last"]?(this.and_blob.single=i,this.and_blob.multiple=i):(this.and_blob.single=i,this.and_blob.multiple=s))},xt.PublisherOutput.prototype.composeElements=function(){for(var t=0;t<2;t+=1)for(var e=["publisher","publisher-place"][t],i=0,s=this["publisher-list"].length;i<s;i+=1){var r=this[e+"-list"][i],n=this[e+"-token"];this.state.output.append(r,n,!0),this[e+"-list"][i]=this.state.output.pop()}},xt.PublisherOutput.prototype.composePublishers=function(){for(var t,e=0,i=this["publisher-list"].length;e<i;e+=1)t=[this[this.varlist[0]+"-list"][e],this[this.varlist[1]+"-list"][e]],this["publisher-list"][e]=this._join(t,this.group_tok.strings.delimiter)},xt.PublisherOutput.prototype.joinPublishers=function(){var t=this["publisher-list"],e=(this.name_delimiter,this._join(t,this.group_tok.strings["subgroup-delimiter"],this.and_blob.single,this.and_blob.multiple,this.group_tok));this.state.output.append(e,"literal")},xt.PublisherOutput.prototype._join=xt.NameOutput.prototype._join,xt.PublisherOutput.prototype._getToken=xt.NameOutput.prototype._getToken,xt.PublisherOutput.prototype.clearVars=function(){this.state.tmp["publisher-list"]=!1,this.state.tmp["publisher-place-list"]=!1,this.state.tmp["publisher-group-token"]=!1,this.state.tmp["publisher-token"]=!1,this.state.tmp["publisher-place-token"]=!1},(t.exports=xt).evaluateLabel=function(t,e,i,s){var r;"locator"===t.strings.term?(s&&s.label&&(r="sub verbo"===s.label?"sub-verbo":s.label),r||(r="page")):r=t.strings.term;var n=t.strings.plural;if("number"!=typeof n){var a="locator"===t.strings.term?s:i;e.processNumber(!1,a,t.strings.term,i.type),n=e.tmp.shadow_numbers[t.strings.term].plural,e.tmp.shadow_numbers[t.strings.term].labelForm||e.tmp.shadow_numbers[t.strings.term].labelDecorations||(e.tmp.shadow_numbers[t.strings.term].labelForm=t.strings.form,e.tmp.shadow_numbers[t.strings.term].labelCapitalizeIfFirst=t.strings.capitalize_if_first,e.tmp.shadow_numbers[t.strings.term].labelDecorations=t.decorations.slice()),-1<["locator","number","page"].indexOf(t.strings.term)&&e.tmp.shadow_numbers[t.strings.term].label&&(r=e.tmp.shadow_numbers[t.strings.term].label),t.decorations&&(e.opt.development_extensions.csl_reverse_lookup_support||e.sys.csl_reverse_lookup_support)&&(t.decorations.reverse(),t.decorations.push(["@showid","true",t.cslid]),t.decorations.reverse())}return xt.castLabel(e,t,r,n,xt.TOLERANT)},xt.castLabel=function(t,e,i,s,r){var n=e.strings.form,a=e.strings.capitalize_if_first;t.tmp.group_context.tip.label_form&&"static"!==n&&(n=t.tmp.group_context.tip.label_form),t.tmp.group_context.tip.label_capitalize_if_first&&(a=t.tmp.group_context.tip.label_capitalize_if_first);var o=t.getTerm(i,n,s,!1,r,e.default_locale);if(a&&(o=xt.Output.Formatters["capitalize-first"](t,o)),t.tmp.strip_periods)o=o.replace(/\./g,"");else for(var l=0,u=e.decorations.length;l<u;l+=1)if("@strip-periods"===e.decorations[l][0]&&"true"===e.decorations[l][1]){o=o.replace(/\./g,"");break}return o},(t.exports=xt).Node.name={build:function(t,e){var i,s;-1<[xt.SINGLETON,xt.START].indexOf(this.tokentype)&&(void 0===t.tmp.root?(s=void 0,t.tmp.root="citation"):s=t.tmp.root,t.inheritOpt(this,"et-al-subsequent-min")&&t.inheritOpt(this,"et-al-subsequent-min")!==t.inheritOpt(this,"et-al-min")&&(t.opt.update_mode=xt.POSITION),t.inheritOpt(this,"et-al-subsequent-use-first")&&t.inheritOpt(this,"et-al-subsequent-use-first")!==t.inheritOpt(this,"et-al-use-first")&&(t.opt.update_mode=xt.POSITION),t.tmp.root=s,i=function(t,e){t.tmp.etal_term="et-al",t.tmp.name_delimiter=t.inheritOpt(this,"delimiter","name-delimiter",", "),t.tmp["delimiter-precedes-et-al"]=t.inheritOpt(this,"delimiter-precedes-et-al"),"text"===t.inheritOpt(this,"and")?this.and_term=t.getTerm("and","long",0):"symbol"===t.inheritOpt(this,"and")&&(t.opt.development_extensions.expect_and_symbol_form?this.and_term=t.getTerm("and","symbol",0):this.and_term="&"),t.tmp.and_term=this.and_term,xt.STARTSWITH_ROMANESQUE_REGEXP.test(this.and_term)?(this.and_prefix_single=" ",this.and_prefix_multiple=", ","string"==typeof t.tmp.name_delimiter&&(this.and_prefix_multiple=t.tmp.name_delimiter),this.and_suffix=" "):(this.and_prefix_single="",this.and_prefix_multiple="",this.and_suffix=""),"always"===t.inheritOpt(this,"delimiter-precedes-last")?this.and_prefix_single=t.tmp.name_delimiter:"never"===t.inheritOpt(this,"delimiter-precedes-last")?this.and_prefix_multiple&&(this.and_prefix_multiple=" "):"after-inverted-name"===t.inheritOpt(this,"delimiter-precedes-last")&&(this.and_prefix_single&&(this.and_prefix_single=t.tmp.name_delimiter),this.and_prefix_multiple&&(this.and_prefix_multiple=" ")),this.and={},t.inheritOpt(this,"and")?(t.output.append(this.and_term,"empty",!0),this.and.single=t.output.pop(),this.and.single.strings.prefix=this.and_prefix_single,this.and.single.strings.suffix=this.and_suffix,t.output.append(this.and_term,"empty",!0),this.and.multiple=t.output.pop(),this.and.multiple.strings.prefix=this.and_prefix_multiple,this.and.multiple.strings.suffix=this.and_suffix):t.tmp.name_delimiter&&(this.and.single=new xt.Blob(t.tmp.name_delimiter),this.and.single.strings.prefix="",this.and.single.strings.suffix="",this.and.multiple=new xt.Blob(t.tmp.name_delimiter),this.and.multiple.strings.prefix="",this.and.multiple.strings.suffix=""),this.ellipsis={},t.inheritOpt(this,"et-al-use-last")&&(this.ellipsis_term="…",this.ellipsis_prefix_single=" ",this.ellipsis_prefix_multiple=t.inheritOpt(this,"delimiter","name-delimiter",", "),this.ellipsis_suffix=" ",this.ellipsis.single=new xt.Blob(this.ellipsis_term),this.ellipsis.single.strings.prefix=this.ellipsis_prefix_single,this.ellipsis.single.strings.suffix=this.ellipsis_suffix,this.ellipsis.multiple=new xt.Blob(this.ellipsis_term),this.ellipsis.multiple.strings.prefix=this.ellipsis_prefix_multiple,this.ellipsis.multiple.strings.suffix=this.ellipsis_suffix),void 0===t.tmp["et-al-min"]&&(t.tmp["et-al-min"]=t.inheritOpt(this,"et-al-min")),void 0===t.tmp["et-al-use-first"]&&(t.tmp["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first")),void 0===t.tmp["et-al-use-last"]&&(t.tmp["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last")),t.nameOutput.name=this},t.build.name_flag=!0,this.execs.push(i));e.push(this)}},(t.exports=xt).Node["name-part"]={build:function(t,e){t.build[this.strings.name]=this}},(t.exports=xt).Node.names={build:function(t,e){var i;if(this.tokentype!==xt.START&&this.tokentype!==xt.SINGLETON||(xt.Util.substituteStart.call(this,t,e),t.build.substitute_level.push(1)),this.tokentype===xt.SINGLETON&&(t.build.names_variables.push(this.variables),i=function(t,e,i){var s=t.nameOutput.labelVariable;t.nameOutput.reinit(this,s)},this.execs.push(i)),this.tokentype===xt.START&&(t.build.names_flag=!0,t.build.names_level+=1,1===t.build.names_level&&(t.build.names_variables=[],t.build.name_label={}),t.build.names_variables.push(this.variables),i=function(t,e,i){t.tmp.can_substitute.push(!0),t.parallel.StartVariable("names",this.variables[0]),t.nameOutput.init(this)},this.execs.push(i)),this.tokentype===xt.END){for(var s=0;s<3;s+=1){var r=["family","given","et-al"][s];this[r]=t.build[r],1===t.build.names_level&&(t.build[r]=void 0)}this.label=t.build.name_label,1===t.build.names_level&&(t.build.name_label={}),t.build.names_level+=-1,t.build.names_variables.pop(),i=function(t,e,i){t.tmp.etal_node?this.etal_style=t.tmp.etal_node:this.etal_style="empty",this.etal_term=t.getTerm(t.tmp.etal_term,"long",0),xt.STARTSWITH_ROMANESQUE_REGEXP.test(this.etal_term)?(this.etal_prefix_single=" ",this.etal_prefix_multiple=t.tmp.name_delimiter,"always"===t.tmp["delimiter-precedes-et-al"]?this.etal_prefix_single=t.tmp.name_delimiter:"never"===t.tmp["delimiter-precedes-et-al"]?this.etal_prefix_multiple=" ":"after-inverted-name"===t.tmp["delimiter-precedes-et-al"]&&(this.etal_prefix_single=t.tmp.name_delimiter,this.etal_prefix_multiple=" ")):(this.etal_prefix_single="",this.etal_prefix_multiple=""),this.etal_suffix="";for(var s=0;s<3;s+=1){var r=["family","given"][s];t.nameOutput[r]=this[r]}t.nameOutput.with=this.with;var n="with",a="",o="";xt.STARTSWITH_ROMANESQUE_REGEXP.test(n)&&(o=a=" ");var l={};l.single=new xt.Blob(n),l.single.strings.suffix=o,l.multiple=new xt.Blob(n),l.multiple.strings.suffix=o,"always"===t.inheritOpt(t.nameOutput.name,"delimiter-precedes-last")?(l.single.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter"),l.multiple.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter")):"contextual"===t.inheritOpt(t.nameOutput.name,"delimiter-precedes-last")?(l.single.strings.prefix=a,l.multiple.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter")):("after-inverted-name"===t.inheritOpt(t.nameOutput.name,"delimiter-precedes-last")?l.single.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter"):l.single.strings.prefix=a,l.multiple.strings.prefix=a),t.nameOutput.with=l,t.nameOutput.label=this.label,t.nameOutput.etal_style=this.etal_style,t.nameOutput.etal_term=this.etal_term,t.nameOutput.etal_prefix_single=this.etal_prefix_single,t.nameOutput.etal_prefix_multiple=this.etal_prefix_multiple,t.nameOutput.etal_suffix=this.etal_suffix,t.nameOutput.outputNames(),t.tmp["et-al-use-first"]=void 0,t.tmp["et-al-min"]=void 0,t.tmp["et-al-use-last"]=void 0},this.execs.push(i),i=function(t,e){t.tmp.can_substitute.pop()||t.tmp.can_substitute.replace(!1,xt.LITERAL),t.parallel.CloseVariable("names"),1===t.tmp.can_substitute.mystack.length&&(t.tmp.can_block_substitute=!1)},this.execs.push(i),t.build.name_flag=!1}e.push(this),this.tokentype!==xt.END&&this.tokentype!==xt.SINGLETON||(t.build.substitute_level.pop(),xt.Util.substituteEnd.call(this,t,e))}},(t.exports=xt).Node.number={build:function(t,e){var i;xt.Util.substituteStart.call(this,t,e),"roman"===this.strings.form?this.formatter=t.fun.romanizer:"ordinal"===this.strings.form?this.formatter=t.fun.ordinalizer:"long-ordinal"===this.strings.form&&(this.formatter=t.fun.long_ordinalizer),void 0===this.successor_prefix&&(this.successor_prefix=t[t.build.area].opt.layout_delimiter),void 0===this.splice_prefix&&(this.splice_prefix=t[t.build.area].opt.layout_delimiter),i=function(t,e,i){if(0!==this.variables.length){if(void 0===i)i={};var s;if("locator"!==(s=this.variables[0])||!t.tmp.just_looking){t.parallel.StartVariable(this.variables[0]),"locator"===this.variables[0]?t.parallel.AppendToVariable(e.section):t.parallel.AppendToVariable(e[this.variables[0]]);new RegExp("(?:&|, | and |"+t.getTerm("page-range-delimiter")+")");"collection-number"===s&&"legal_case"===e.type&&(t.tmp.renders_collection_number=!0);e[this.variables[0]];if(t.tmp.group_context.tip.force_suppress)return!1;"locator"===s?t.processNumber(this,i,s,e.type):(!t.tmp.group_context.tip.condition&&e[s]&&(t.tmp.just_did_number=!0),t.processNumber(this,e,s,e.type)),xt.Util.outputNumericField(t,s,e.id),t.parallel.CloseVariable("number"),-1<["locator","locator-extra"].indexOf(this.variables_real[0])&&!t.tmp.just_looking&&(t.tmp.done_vars.push(this.variables_real[0]),t.tmp.group_context.tip.done_vars.push(this.variables_real[0]))}}},this.execs.push(i),e.push(this),xt.Util.substituteEnd.call(this,t,e)}},(t.exports=xt).Node.sort={build:function(t,e){if(e=t[t.build.root+"_sort"].tokens,this.tokentype===xt.START){"citation"===t.build.area&&(t.parallel.use_parallels=!1,t.opt.sort_citations=!0),t.build.area=t.build.root+"_sort",t.build.extension="_sort";var i=function(t,e){if(t.opt.has_layout_locale){for(var i,s=xt.localeResolve(e.language,t.opt["default-locale"][0]),r=t[t.tmp.area.slice(0,-5)].opt.sort_locales,n=0,a=r.length;n<a&&((i=r[n][s.bare])||(i=r[n][s.best]),!i);n+=1);i||(i=t.opt["default-locale"][0]),t.tmp.lang_sort_hold=t.opt.lang,t.opt.lang=i}};this.execs.push(i)}if(this.tokentype===xt.END){t.build.area=t.build.root,t.build.extension="";i=function(t,e){t.opt.has_layout_locale&&(t.opt.lang=t.tmp.lang_sort_hold,delete t.tmp.lang_sort_hold)};this.execs.push(i)}e.push(this)}},(t.exports=xt).Node.substitute={build:function(t,e){var i;this.tokentype===xt.START&&(i=function(t,e){t.tmp.can_block_substitute=!0,t.tmp.value.length&&t.tmp.can_substitute.replace(!1,xt.LITERAL)},this.execs.push(i)),e.push(this)}},(t.exports=xt).Node.text={build:function(t,e){var i,u,l,r,n,a,o,p,h,s,c,f;if(this.postponed_macro){var m=xt.Util.cloneToken(this);m.name="group",m.tokentype=xt.START,xt.Node.group.build.call(m,t,e),xt.expandMacro.call(t,this,e);var d=xt.Util.cloneToken(this);d.name="group",d.tokentype=xt.END,"juris-locator-label"===this.postponed_macro&&(d.isJurisLocatorLabel=!0),xt.Node.group.build.call(d,t,e)}else{if(xt.Util.substituteStart.call(this,t,e),this.variables_real||(this.variables_real=[]),this.variables||(this.variables=[]),u="long",l=0,this.strings.form&&(u=this.strings.form),this.strings.plural&&(l=this.strings.plural),"citation-number"===this.variables_real[0]||"year-suffix"===this.variables_real[0]||"citation-label"===this.variables_real[0])"citation-number"===this.variables_real[0]?("citation"===t.build.root&&(t.opt.update_mode=xt.NUMERIC),"bibliography"===t.build.root&&(t.opt.bib_mode=xt.NUMERIC),"bibliography_sort"===t.build.area&&(t.opt.citation_number_sort_used=!0),"citation-number"===t[t.tmp.area].opt.collapse&&(this.range_prefix=t.getTerm("citation-range-delimiter")),this.successor_prefix=t[t.build.area].opt.layout_delimiter,this.splice_prefix=t[t.build.area].opt.layout_delimiter,i=function(t,e,i){if(r=""+e.id,!t.tmp.just_looking){if(i&&i["author-only"]){t.tmp.element_trace.replace("do-not-suppress-me");var s=t.getTerm("reference","long","singular");void 0===s&&(s="reference"),f=xt.Output.Formatters["capitalize-first"](t,s),t.output.append(f+" "),t.tmp.last_element_trace=!0}i&&i["suppress-author"]&&(t.tmp.last_element_trace&&t.tmp.element_trace.replace("suppress-me"),t.tmp.last_element_trace=!1),n=t.registry.registry[r].seq,t.opt.citation_number_slug?t.output.append(t.opt.citation_number_slug,this):(a=new xt.NumericBlob(!1,n,this,e.id),t.tmp.in_cite_predecessor&&(t.tmp.just_looking,a.suppress_splice_prefix=!0),t.output.append(a,"literal"))}},this.execs.push(i)):"year-suffix"===this.variables_real[0]?(t.opt.has_year_suffix=!0,"year-suffix-ranged"===t[t.tmp.area].opt.collapse&&(this.range_prefix=t.getTerm("citation-range-delimiter")),this.successor_prefix=t[t.build.area].opt.layout_delimiter,t[t.tmp.area].opt["year-suffix-delimiter"]&&(this.successor_prefix=t[t.build.area].opt["year-suffix-delimiter"]),i=function(t,e){if(t.registry.registry[e.id]&&!1!==t.registry.registry[e.id].disambig.year_suffix&&!t.tmp.just_looking){n=parseInt(t.registry.registry[e.id].disambig.year_suffix,10),t[t.tmp.area].opt.cite_group_delimiter&&(this.successor_prefix=t[t.tmp.area].opt.cite_group_delimiter),a=new xt.NumericBlob(!1,n,this,e.id),o=new xt.Util.Suffixator(xt.SUFFIX_CHARS),a.setFormatter(o),t.output.append(a,"literal"),p=!1;for(var i=0,s=t.tmp.group_context.mystack.length;i<s;i++){var r=t.tmp.group_context.mystack[i];if(!r.variable_success&&(r.variable_attempt||!r.variable_attempt&&!r.term_intended)){p=!0;break}}h=t[t.tmp.area].opt["year-suffix-delimiter"],p&&h&&!t.tmp.sort_key_flag&&(t.tmp.splice_delimiter=t[t.tmp.area].opt["year-suffix-delimiter"])}},this.execs.push(i)):"citation-label"===this.variables_real[0]&&(t.opt.has_year_suffix=!0,i=function(t,e){(s=e["citation-label"])||(s=t.getCitationLabel(e)),t.tmp.just_looking||(c="",t.registry.registry[e.id]&&!1!==t.registry.registry[e.id].disambig.year_suffix&&(n=parseInt(t.registry.registry[e.id].disambig.year_suffix,10),c=t.fun.suffixator.format(n)),s+=c),t.output.append(s,this)},this.execs.push(i));else if(this.strings.term)i=function(t,e,i){var s,r=t.opt.gender[e.type],n=this.strings.term;if(""!==(n=t.getTerm(n,u,l,r,xt.TOLERANT,this.default_locale))&&(t.tmp.group_context.tip.term_intended=!0),xt.UPDATE_GROUP_CONTEXT_CONDITION(t,n),s=t.tmp.term_predecessor||"in-text"===t.opt.class&&"citation"===t.tmp.area?n:xt.Output.Formatters["capitalize-first"](t,n),t.tmp.strip_periods)s=s.replace(/\./g,"");else for(var a=0,o=this.decorations.length;a<o;a+=1)if("@strip-periods"===this.decorations[a][0]&&"true"===this.decorations[a][1]){s=s.replace(/\./g,"");break}t.output.append(s,this)},this.execs.push(i),t.build.term=!1,t.build.form=!1,t.build.plural=!1;else if(this.variables_real.length){if(i=function(t,e,i){"locator"!==this.variables_real[0]&&(t.tmp.have_collapsed=!1);var s=this.variables[0];"title"!==s||"short"!==u&&!e["title-short"]||(s="title-short"),t.parallel.StartVariable(s),t.parallel.AppendToVariable(e[s],s),!t.tmp.group_context.tip.condition&&e[this.variables[0]]&&(t.tmp.just_did_number=!1)},this.execs.push(i),-1<xt.MULTI_FIELDS.indexOf(this.variables_real[0])||-1<["language-name","language-name-original"].indexOf(this.variables_real[0])){var g=this.variables[0],b=!1,_=!1,v=!1;"short"===u||-1<["country","jurisdiction"].indexOf(this.variables_real[0])?"container-title"===this.variables_real[0]?_="journalAbbreviation":"title"===this.variables_real[0]&&(_="title-short"):g=!1,t.build.extension?v=!0:b=v=!0,i=t.transform.getOutputFunction(this.variables,g,b,_,v)}else i=-1<xt.CITE_FIELDS.indexOf(this.variables_real[0])?function(t,e,i){i&&i[this.variables[0]]&&(t.processNumber(this,i,this.variables[0],e.type),xt.Util.outputNumericField(t,this.variables[0],e.id),-1<["locator","locator-extra"].indexOf(this.variables_real[0])&&!t.tmp.just_looking&&t.tmp.done_vars.push(this.variables_real[0]))}:-1<["page","page-first","chapter-number","collection-number","edition","issue","number","number-of-pages","number-of-volumes","volume"].indexOf(this.variables_real[0])?function(t,e){t.processNumber(this,e,this.variables[0],e.type),xt.Util.outputNumericField(t,this.variables[0],e.id)}:-1<["URL","DOI"].indexOf(this.variables_real[0])?function(t,e){var i;if(this.variables[0]&&(i=t.getVariable(e,this.variables[0],u)))if(t.opt.development_extensions.wrap_url_and_doi)if(this.decorations.length&&this.decorations[0][0]==="@"+this.variables[0])t.output.append(i,this,!1,!1,!0);else if("DOI"===this.variables_real[0]&&"https://doi.org/"===this.strings.prefix){var s,r=xt.Util.cloneToken(this),n=new xt.Blob(null,null,"url-wrapper");n.decorations.push(["@DOI","true"]),s=(i=i.replace(/^https?:\/\/doi\.org\//,"")).match(/^https?:\/\//)?"":"https://doi.org/";var a=new xt.Blob(s),o=new xt.Blob(i);r.strings.prefix="",n.push(a),n.push(o),t.output.append(n,r,!1,!1,!0)}else this.decorations=[["@"+this.variables[0],"true"]].concat(this.decorations),t.output.append(i,this,!1,!1,!0);else{if(this.decorations.length)for(var l=this.decorations.length-1;-1<l;l--)this.decorations[l][0]==="@"+this.variables[0]&&(this.decorations=this.decorations.slice(0,l).concat(this.decorations.slice(l+1)));t.output.append(i,this,!1,!1,!0)}}:"section"===this.variables_real[0]?function(t,e){var i;(i=t.getVariable(e,this.variables[0],u))&&t.output.append(i,this)}:"hereinafter"===this.variables_real[0]?function(t,e){var i=t.transform.abbrevs.default.hereinafter[e.id];i&&(t.output.append(i,this),t.tmp.group_context.tip.variable_success=!0)}:function(t,e){var i;this.variables[0]&&(i=t.getVariable(e,this.variables[0],u))&&(i=(i=""+i).split("\\").join(""),t.output.append(i,this))};this.execs.push(i),i=function(t,e){t.parallel.CloseVariable("text")},this.execs.push(i)}else this.strings.value&&(i=function(t,e){t.tmp.group_context.tip.term_intended=!0,xt.UPDATE_GROUP_CONTEXT_CONDITION(t,this.strings.value,!0),t.output.append(this.strings.value,this)},this.execs.push(i));e.push(this),xt.Util.substituteEnd.call(this,t,e)}}},(t.exports=xt).Attributes={},xt.Attributes["@genre"]=function(t,i){i=i.replace("-"," ");this.tests.push(function(t,e){return i===t.genre})},xt.Attributes["@disambiguate"]=function(i,t){if("true"===t){i.opt.has_disambiguate=!0;var e=function(t,e){if("bibliography"===i.tmp.area){if(i.tmp.disambiguate_count<i.registry.registry[t.id].disambig.disambiguate)return i.tmp.disambiguate_count+=1,!0}else if(i.tmp.disambiguate_maxMax+=1,i.tmp.disambig_settings.disambiguate&&i.tmp.disambiguate_count<i.tmp.disambig_settings.disambiguate)return i.tmp.disambiguate_count+=1,!0;return!1};this.tests.push(e)}else if("check-ambiguity-and-backreference"===t){e=function(t,e){return!!(i.registry.registry[t.id].disambig.disambiguate&&1<i.registry.registry[t.id]["citation-count"])};this.tests.push(e)}},xt.Attributes["@is-numeric"]=function(r,t,e){for(var i=t.split(/\s+/),s=function(s){return function(t,e){var i=t;if(-1<["locator","locator-extra"].indexOf(s)&&(i=e),void 0===i)return!1;if(-1<xt.NUMERIC_VARIABLES.indexOf(s)){if(r.tmp.shadow_numbers[s]||r.processNumber(!1,i,s,t.type),i[s]&&r.tmp.shadow_numbers[s].numeric)return!0}else if(-1<["title","locator-extra","version"].indexOf(s)&&i[s]&&i[s].slice(-1)===""+parseInt(i[s].slice(-1),10))return!0;return!1}},n=0;n<i.length;n+=1)this.tests.push(s(i[n]))},xt.Attributes["@is-uncertain-date"]=function(t,e){for(var i=e.split(/\s+/),s=function(i){return function(t,e){return!(!t[i]||!t[i].circa)}},r=0,n=i.length;r<n;r+=1)this.tests.push(s(i[r]))},xt.Attributes["@locator"]=function(r,t){for(var e=t.replace("sub verbo","sub-verbo"),i=function(s){return function(t,e){var i;return r.processNumber(!1,e,"locator"),i=r.tmp.shadow_numbers.locator.label,s===i}},s=0,n=(e=e.split(/\s+/)).length;s<n;s+=1)this.tests.push(i(e[s]))},xt.Attributes["@position"]=function(s,t){s.opt.update_mode=xt.POSITION,s.parallel.use_parallels=null;for(var e=t.split(/\s+/),i=function(i){return function(t,e){if("bibliography"===s.tmp.area)return!1;if(e&&void 0===e.position&&(e.position=0),e&&"number"==typeof e.position){if(0===e.position&&0===i)return!0;if(0<i&&e.position>=i)return!0}else if(0===i)return!0;return!1}},r=0,n=e.length;r<n;r+=1){var a;"first"===(a=e[r])?a=xt.POSITION_FIRST:"subsequent"===a?a=xt.POSITION_SUBSEQUENT:"ibid"===a?a=xt.POSITION_IBID:"ibid-with-locator"===a&&(a=xt.POSITION_IBID_WITH_LOCATOR),"near-note"===a?this.tests.push(function(t,e){return!!(e&&e.position>=xt.POSITION_SUBSEQUENT&&e["near-note"])}):"far-note"===a?this.tests.push(function(t,e){return!(!e||e.position!=xt.POSITION_SUBSEQUENT||e["near-note"])}):this.tests.push(i(a))}},xt.Attributes["@type"]=function(t,e){for(var i=e.split(/\s+/),s=function(i){return function(t,e){return!!(t.type===i)}},r=[],n=0,a=i.length;n<a;n+=1)r.push(s(i[n]));this.tests.push(t.fun.match.any(this,t,r))},xt.Attributes["@variable"]=function(n,t){var e;if(this.variables=t.split(/\s+/),this.variables_real=this.variables.slice(),"label"===this.name&&this.variables[0])this.strings.term=this.variables[0];else if(-1<["names","date","text","number"].indexOf(this.name))e=function(t,e,i){for(var s=this.variables.length-1;-1<s;s+=-1)this.variables.pop();s=0;for(var r=this.variables_real.length;s<r;s++)-1!==t.tmp.done_vars.indexOf(this.variables_real[s])||i&&"legal_case"===e.type&&i["suppress-author"]&&"title"===this.variables_real[s]||this.variables.push(this.variables_real[s]),t.tmp.can_block_substitute&&t.tmp.done_vars.push(this.variables_real[s])},this.execs.push(e),e=function(t,e,i){for(var s=!1,r=0,n=this.variables.length;r<n;r++){var a=this.variables[r];if(-1<["authority","committee"].indexOf(a)&&"string"==typeof e[a]&&"names"===this.name){var o=!0,l=e[a].split(/\s*;\s*/),u={};if(e.multi&&e.multi._keys[a])for(var p in e.multi._keys[a])if(u[p]=e.multi._keys[a][p].split(/\s*;\s*/),u[p].length!==l.length){o=!1;break}o||(l=[e[a]],u=e.multi._keys[a]);for(var h=0,c=l.length;h<c;h++){var f={literal:l[h],multi:{_key:{}}};for(var p in u){var m={literal:u[p][h]};f.multi._key[p]=m}l[h]=f}e[a]=l}if("short"!==this.strings.form||e[a]||("title"===a?a="title-short":"container-title"===a&&(a="journalAbbreviation")),"year-suffix"===a){s=!0;break}if(-1<xt.DATE_VARIABLES.indexOf(a)){if(t.opt.development_extensions.locator_date_and_revision&&"locator-date"===a){s=!0;break}if(e[a]){for(var d in e[a])if((-1!==this.dateparts.indexOf(d)||"literal"===d)&&e[a][d]){s=!0;break}if(s)break}}else{if("locator"===a){i&&i.locator&&(s=!0);break}if("locator-extra"===a){i&&i["locator-extra"]&&(s=!0);break}if(-1<["citation-number","citation-label"].indexOf(a)){s=!0;break}if("first-reference-note-number"===a){i&&i["first-reference-note-number"]&&(s=!0);break}if("hereinafter"===a){t.transform.abbrevs.default.hereinafter[e.id]&&t.sys.getAbbreviation&&e.id&&(s=!0);break}if("object"==typeof e[a]){e[a].length;break}if("string"==typeof e[a]&&e[a]){s=!0;break}if("number"==typeof e[a]){s=!0;break}}if(s)break}if(s){for(r=0,n=this.variables_real.length;r<n;r++){"citation-number"===(a=this.variables_real[r])&&"bibliography"===t.tmp.area||(t.tmp.cite_renders_content=!0),t.tmp.group_context.tip.variable_success=!0,t.tmp.can_substitute.value()&&"bibliography"===t.tmp.area&&"string"==typeof e[a]&&(t.tmp.name_node.top=t.output.current.value(),t.tmp.rendered_name.push(e[a]))}t.tmp.can_substitute.replace(!1,xt.LITERAL)}else t.tmp.group_context.tip.variable_attempt=!0},this.execs.push(e);else if(-1<["if","else-if","condition"].indexOf(this.name))for(var i=function(r){return function(t,e){var i=t;if(e&&-1<["locator","locator-extra","first-reference-note-number","locator-date"].indexOf(r)&&(i=e),"hereinafter"===r&&n.sys.getAbbreviation&&i.id){if(n.transform.abbrevs.default.hereinafter[i.id])return!0}else if(i[r]){if("number"==typeof i[r]||"string"==typeof i[r])return!0;if("object"==typeof i[r])for(var s in i[r])if(i[r][s])return!0}return!1}},s=0,r=this.variables.length;s<r;s+=1)this.tests.push(i(this.variables[s]))},xt.Attributes["@page"]=function(r,t){for(var e=t.replace("sub verbo","sub-verbo"),i=function(s){return function(t,e){var i;return r.processNumber(!1,t,"page",t.type),i=r.tmp.shadow_numbers.page.label?"sub verbo"===r.tmp.shadow_numbers.page.label?"sub-verbo":r.tmp.shadow_numbers.page.label:"page",s===i}},s=0,n=(e=e.split(/\s+/)).length;s<n;s+=1)this.tests.push(i(e[s]))},xt.Attributes["@number"]=function(r,t){for(var e=t.replace("sub verbo","sub-verbo"),i=function(s){return function(t,e){var i;return r.processNumber(!1,t,"number",t.type),i=r.tmp.shadow_numbers.number.label?"sub verbo"===r.tmp.shadow_numbers.number.label?"sub-verbo":r.tmp.shadow_numbers.number.label:"number",s===i}},s=0,n=(e=e.split(/\s+/)).length;s<n;s+=1)this.tests.push(i(e[s]))},xt.Attributes["@jurisdiction"]=function(t,e){for(var i=e.split(/\s+/),s=0,r=i.length;s<r;s+=1)i[s]=i[s].split(":");var n=function(n){return function(t,e){if(!t.jurisdiction)return!1;for(var i=t.jurisdiction.split(":"),s=0,r=i.length;s<r;s+=1)i[s]=i[s].split(":");for(s=n.length;0<s;s+=-1){if(n.slice(0,s).join(":")!==i.slice(0,s).join(":"))return!1}return!0}};for(s=0,r=i.length;s<r;s+=1){var a=i[s].slice();this.tests.push(n(a))}},xt.Attributes["@context"]=function(i,s){this.tests.push(function(t,e){return i.tmp.area.slice(0,s.length)===s})},xt.Attributes["@has-year-only"]=function(t,e){for(var i=e.split(/\s+/),s=function(s){return function(t,e){var i=t[s];return!(!i||i.month||i.season)}},r=0,n=i.length;r<n;r+=1)this.tests.push(s(i[r]))},xt.Attributes["@has-to-month-or-season"]=function(t,e){for(var i=e.split(/\s+/),s=function(s){return function(t,e){var i=t[s];return!(!i||!i.month&&!i.season||i.day)}},r=0,n=i.length;r<n;r+=1)this.tests.push(s(i[r]))},xt.Attributes["@has-day"]=function(t,e){for(var i=e.split(/\s+/),s=function(s){return function(t,e){var i=t[s];return!(!i||!i.day)}},r=0,n=i.length;r<n;r+=1)this.tests.push(s(i[r]))},xt.Attributes["@subjurisdictions"]=function(t,e){var s=parseInt(e,10);this.tests.push(function(t,e){var i=0;return t.jurisdiction&&(i=t.jurisdiction.split(":").length),i&&(i+=-1),s<=i})},xt.Attributes["@is-plural"]=function(l,u){this.tests.push(function(t,e){var i=t[u];if(i&&i.length){for(var s=0,r=0,n=!1,a=0,o=i.length;a<o;a+=1)n=l.opt.development_extensions.spoof_institutional_affiliations&&(i[a].literal||i[a].isInstitution&&i[a].family&&!i[a].given)?(r+=1,!1):(s+=1,!0);if(1<s)return!0;if(1<r)return!0;if(r&&n)return!0}return!1})},xt.Attributes["@locale"]=function(t,e){var i,s,r,n,a,o,l=t.opt["default-locale"][0];if("layout"===this.name){if(this.locale_raw=e,this.tokentype===xt.START){var u=e.split(/\s+/),p={},h=xt.localeResolve(u[0],l);h.generic?p[h.generic]=h.best:p[h.best]=h.best;for(var c=1,f=u.length;c<f;c+=1){var m=xt.localeResolve(u[c],l);m.generic?p[m.generic]=h.best:p[m.best]=h.best}t[t.build.area].opt.sort_locales.push(p)}t.opt.has_layout_locale=!0}else{r=e.split(/\s+/);var d=[];for(c=0,f=r.length;c<f;c+=1)s=r[c],i=xt.localeResolve(s,l),2===r[c].length&&d.push(i.bare),t.localeConfigure(i,!0),r[c]=i;var g=r.slice();this.tests.push((n=g,a=l,o=d,function(t,e){var i,s,r=i=!1;for(s=t.language?t.language:a,r=xt.localeResolve(s,a),c=0,f=n.length;c<f;c+=1)if(r.best===n[c].best){i=!0;break}return!i&&-1<o.indexOf(r.bare)&&(i=!0),i}))}},xt.Attributes["@authority-residue"]=function(i,t){var s;this.tests.push((s="true"===t,function(t,e){return t.authority&&t.authority[0]&&t.authority[0].family&&0<t.authority[0].family.split("|").length+i.tmp.authority_stop_last?s:!s}))},xt.Attributes["@locale-internal"]=function(r,t){var e,n,i,a,o;for(i=t.split(/\s+/),this.locale_bares=[],a=0,o=i.length;a<o;a+=1)n=i[a],e=xt.localeResolve(n,r.opt["default-locale"][0]),2===i[a].length&&this.locale_bares.push(e.bare),r.localeConfigure(e),i[a]=e;this.locale_default=r.opt["default-locale"][0],this.locale=i[0].best,this.locale_list=i.slice();var l;this.tests.push((l=this,function(t,e){var i,s=i=!1;if(t.language&&(n=t.language,(s=xt.localeResolve(n,r.opt["default-locale"][0])).best===r.opt["default-locale"][0]&&(s=!1)),s){for(a=0,o=l.locale_list.length;a<o;a+=1)if(s.best===l.locale_list[a].best){r.opt.lang=l.locale,r.tmp.last_cite_locale=l.locale,r.output.openLevel("empty"),r.output.current.value().new_locale=l.locale,i=!0;break}!i&&-1<l.locale_bares.indexOf(s.bare)&&(r.opt.lang=l.locale,r.tmp.last_cite_locale=l.locale,r.output.openLevel("empty"),r.output.current.value().new_locale=l.locale,i=!0)}return i}))},xt.Attributes["@is-parallel"]=function(t,e){for(var i=e.split(" "),s=0,r=i.length;s<r;s+=1)"true"===i[s]?i[s]=!0:"false"===i[s]&&(i[s]=!1);this.strings.set_parallel_condition=i},xt.Attributes["@jurisdiction-depth"]=function(t,e){this.strings.jurisdiction_depth=parseInt(e,10)},xt.Attributes["@require"]=function(t,e){this.strings.require=e},xt.Attributes["@reject"]=function(t,e){this.strings.reject=e},xt.Attributes["@gender"]=function(t,e){this.gender=e},xt.Attributes["@cslid"]=function(t,e){this.cslid=parseInt(e,10)},xt.Attributes["@capitalize-if-first"]=function(t,e){this.strings.capitalize_if_first_override=e},xt.Attributes["@label-capitalize-if-first"]=function(t,e){this.strings.label_capitalize_if_first_override=e},xt.Attributes["@label-form"]=function(t,e){this.strings.label_form_override=e},xt.Attributes["@part-separator"]=function(t,e){this.strings["part-separator"]=e},xt.Attributes["@leading-noise-words"]=function(t,e){this["leading-noise-words"]=e},xt.Attributes["@name-never-short"]=function(t,e){this["name-never-short"]=e},xt.Attributes["@class"]=function(t,e){t.opt.class=e},xt.Attributes["@version"]=function(t,e){t.opt.version=e},xt.Attributes["@value"]=function(t,e){this.strings.value=e},xt.Attributes["@name"]=function(t,e){this.strings.name=e},xt.Attributes["@form"]=function(t,e){this.strings.form=e},xt.Attributes["@date-parts"]=function(t,e){this.strings["date-parts"]=e},xt.Attributes["@range-delimiter"]=function(t,e){this.strings["range-delimiter"]=e},xt.Attributes["@macro"]=function(t,e){this.postponed_macro=e},xt.Attributes["@term"]=function(t,e){this.strings.term="sub verbo"===e?"sub-verbo":e},xt.Attributes["@xmlns"]=function(t,e){},xt.Attributes["@lang"]=function(t,e){e&&(t.build.lang=e)},xt.Attributes["@lingo"]=function(t,e){},xt.Attributes["@macro-has-date"]=function(t,e){this["macro-has-date"]=!0},xt.Attributes["@suffix"]=function(t,e){this.strings.suffix=e},xt.Attributes["@prefix"]=function(t,e){this.strings.prefix=e},xt.Attributes["@delimiter"]=function(t,e){this.strings.delimiter=e},xt.Attributes["@match"]=function(t,e){this.match=e},xt.Attributes["@names-min"]=function(t,e){var i=parseInt(e,10);t[t.build.area].opt.max_number_of_names<i&&(t[t.build.area].opt.max_number_of_names=i),this.strings["et-al-min"]=i},xt.Attributes["@names-use-first"]=function(t,e){this.strings["et-al-use-first"]=parseInt(e,10)},xt.Attributes["@names-use-last"]=function(t,e){this.strings["et-al-use-last"]="true"===e},xt.Attributes["@sort"]=function(t,e){"descending"===e&&(this.strings.sort_direction=xt.DESCENDING)},xt.Attributes["@plural"]=function(t,e){"always"===e||"true"===e?this.strings.plural=1:"never"===e||"false"===e?this.strings.plural=0:"contextual"===e&&(this.strings.plural=!1)},xt.Attributes["@has-publisher-and-publisher-place"]=function(t,e){this.strings["has-publisher-and-publisher-place"]=!0},xt.Attributes["@publisher-delimiter-precedes-last"]=function(t,e){this.strings["publisher-delimiter-precedes-last"]=e},xt.Attributes["@publisher-delimiter"]=function(t,e){this.strings["publisher-delimiter"]=e},xt.Attributes["@publisher-and"]=function(t,e){this.strings["publisher-and"]=e},xt.Attributes["@newdate"]=function(t,e){},xt.Attributes["@givenname-disambiguation-rule"]=function(t,e){-1<xt.GIVENNAME_DISAMBIGUATION_RULES.indexOf(e)&&(t.citation.opt["givenname-disambiguation-rule"]=e)},xt.Attributes["@collapse"]=function(t,e){e&&(t[this.name].opt.collapse=e)},xt.Attributes["@cite-group-delimiter"]=function(t,e){e&&(t[t.tmp.area].opt.cite_group_delimiter=e)},xt.Attributes["@names-delimiter"]=function(t,e){t.setOpt(this,"names-delimiter",e)},xt.Attributes["@name-form"]=function(t,e){t.setOpt(this,"name-form",e)},xt.Attributes["@subgroup-delimiter"]=function(t,e){this.strings["subgroup-delimiter"]=e},xt.Attributes["@subgroup-delimiter-precedes-last"]=function(t,e){this.strings["subgroup-delimiter-precedes-last"]=e},xt.Attributes["@name-delimiter"]=function(t,e){t.setOpt(this,"name-delimiter",e)},xt.Attributes["@et-al-min"]=function(t,e){var i=parseInt(e,10);t[t.build.area].opt.max_number_of_names<i&&(t[t.build.area].opt.max_number_of_names=i),t.setOpt(this,"et-al-min",i)},xt.Attributes["@et-al-use-first"]=function(t,e){t.setOpt(this,"et-al-use-first",parseInt(e,10))},xt.Attributes["@et-al-use-last"]=function(t,e){"true"===e?t.setOpt(this,"et-al-use-last",!0):t.setOpt(this,"et-al-use-last",!1)},xt.Attributes["@et-al-subsequent-min"]=function(t,e){var i=parseInt(e,10);t[t.build.area].opt.max_number_of_names<i&&(t[t.build.area].opt.max_number_of_names=i),t.setOpt(this,"et-al-subsequent-min",i)},xt.Attributes["@et-al-subsequent-use-first"]=function(t,e){t.setOpt(this,"et-al-subsequent-use-first",parseInt(e,10))},xt.Attributes["@suppress-min"]=function(t,e){this.strings["suppress-min"]=parseInt(e,10)},xt.Attributes["@suppress-max"]=function(t,e){this.strings["suppress-max"]=parseInt(e,10)},xt.Attributes["@and"]=function(t,e){t.setOpt(this,"and",e)},xt.Attributes["@delimiter-precedes-last"]=function(t,e){t.setOpt(this,"delimiter-precedes-last",e)},xt.Attributes["@delimiter-precedes-et-al"]=function(t,e){t.setOpt(this,"delimiter-precedes-et-al",e)},xt.Attributes["@initialize-with"]=function(t,e){t.setOpt(this,"initialize-with",e)},xt.Attributes["@initialize"]=function(t,e){"false"===e&&t.setOpt(this,"initialize",!1)},xt.Attributes["@name-as-reverse-order"]=function(t,e){this["name-as-reverse-order"]=e},xt.Attributes["@name-as-sort-order"]=function(t,e){"style-options"===this.name?this["name-as-sort-order"]=e:t.setOpt(this,"name-as-sort-order",e)},xt.Attributes["@sort-separator"]=function(t,e){t.setOpt(this,"sort-separator",e)},xt.Attributes["@year-suffix-delimiter"]=function(t,e){t[this.name].opt["year-suffix-delimiter"]=e},xt.Attributes["@after-collapse-delimiter"]=function(t,e){t[this.name].opt["after-collapse-delimiter"]=e},xt.Attributes["@subsequent-author-substitute"]=function(t,e){t[this.name].opt["subsequent-author-substitute"]=e},xt.Attributes["@subsequent-author-substitute-rule"]=function(t,e){t[this.name].opt["subsequent-author-substitute-rule"]=e},xt.Attributes["@disambiguate-add-names"]=function(t,e){"true"===e&&(t.opt["disambiguate-add-names"]=!0)},xt.Attributes["@disambiguate-add-givenname"]=function(t,e){"true"===e&&(t.opt["disambiguate-add-givenname"]=!0)},xt.Attributes["@disambiguate-add-year-suffix"]=function(t,e){"true"===e&&"numeric"!==t.opt.xclass&&(t.opt["disambiguate-add-year-suffix"]=!0)},xt.Attributes["@second-field-align"]=function(t,e){"flush"!==e&&"margin"!==e||(t[this.name].opt["second-field-align"]=e)},xt.Attributes["@hanging-indent"]=function(t,e){"true"===e&&(t[this.name].opt.hangingindent=2)},xt.Attributes["@line-spacing"]=function(t,e){e&&e.match(/^[.0-9]+$/)&&(t[this.name].opt["line-spacing"]=parseFloat(e,10))},xt.Attributes["@entry-spacing"]=function(t,e){e&&e.match(/^[.0-9]+$/)&&(t[this.name].opt["entry-spacing"]=parseFloat(e,10))},xt.Attributes["@near-note-distance"]=function(t,e){t[this.name].opt["near-note-distance"]=parseInt(e,10)},xt.Attributes["@text-case"]=function(t,i){this.execs.push(function(t,e){"normal"===i?this.text_case_normal=!0:"title"===(this.strings["text-case"]=i)&&(t.opt["default-locale"][0].slice(0,2),e.jurisdiction&&(this.strings["text-case"]="passthrough"))})},xt.Attributes["@page-range-format"]=function(t,e){t.opt["page-range-format"]=e},xt.Attributes["@year-range-format"]=function(t,e){t.opt["year-range-format"]=e},xt.Attributes["@default-locale"]=function(t,e){if("style"===this.name){var i,s,r,n,a;if(a=e.match(/-x-(sort|translit|translat)-/g))for(r=0,s=a.length;r<s;r+=1)a[r]=a[r].replace(/^-x-/,"").replace(/-$/,"");for(n=[(i=e.split(/-x-(?:sort|translit|translat)-/))[0]],r=1,s=i.length;r<s;r+=1)n.push(a[r-1]),n.push(i[r]);for(s=(i=n.slice()).length,r=1;r<s;r+=2)t.opt["locale-"+i[r]].push(i[r+1].replace(/^\s*/g,"").replace(/\s*$/g,""));i.length?t.opt["default-locale"]=i.slice(0,1):t.opt["default-locale"]=["en"]}else"true"===e&&(this.default_locale=!0)},xt.Attributes["@default-locale-sort"]=function(t,e){t.opt["default-locale-sort"]=e},xt.Attributes["@demote-non-dropping-particle"]=function(t,e){t.opt["demote-non-dropping-particle"]=e},xt.Attributes["@initialize-with-hyphen"]=function(t,e){"false"===e&&(t.opt["initialize-with-hyphen"]=!1)},xt.Attributes["@institution-parts"]=function(t,e){this.strings["institution-parts"]=e},xt.Attributes["@if-short"]=function(t,e){"true"===e&&(this.strings["if-short"]=!0)},xt.Attributes["@substitute-use-first"]=function(t,e){this.strings["substitute-use-first"]=parseInt(e,10)},xt.Attributes["@use-first"]=function(t,e){this.strings["use-first"]=parseInt(e,10)},xt.Attributes["@stop-last"]=function(t,e){this.strings["stop-last"]=-1*parseInt(e,10)},xt.Attributes["@use-last"]=function(t,e){this.strings["use-last"]=parseInt(e,10)},xt.Attributes["@reverse-order"]=function(t,e){"true"===e&&(this.strings["reverse-order"]=!0)},xt.Attributes["@display"]=function(t,e){2===t.bibliography.tokens.length&&(t.opt.using_display=!0),this.strings.cls=e},(t.exports=xt).Stack=function(t,e){this.mystack=[],(e||t)&&this.mystack.push(t),this.tip=this.mystack[0]},xt.Stack.prototype.push=function(t,e){e||t?this.mystack.push(t):this.mystack.push(""),this.tip=this.mystack[this.mystack.length-1]},xt.Stack.prototype.clear=function(){this.mystack=[],this.tip={}},xt.Stack.prototype.replace=function(t,e){if(0===this.mystack.length)throw"Internal CSL processor error: attempt to replace nonexistent stack item with "+t;this.mystack[this.mystack.length-1]=e||t?t:"",this.tip=this.mystack[this.mystack.length-1]},xt.Stack.prototype.pop=function(){var t=this.mystack.pop();return this.mystack.length?this.tip=this.mystack[this.mystack.length-1]:this.tip={},t},xt.Stack.prototype.value=function(){return this.mystack.slice(-1)[0]},xt.Stack.prototype.length=function(){return this.mystack.length},(t.exports=xt).Parallel=function(t){this.state=t,this.sets=new xt.Stack([]),this.try_cite=!0,this.use_parallels=!1,this.midVars=["section","volume","container-title","collection-number","issue","page-first","page","number"],this.ignoreVarsLawGeneral=["first-reference-note-number","locator","label","page-first","page","genre"],this.ignoreVarsLawProceduralHistory=["issued","first-reference-note-number","locator","label","page-first","page","genre","jurisdiction"],this.ignoreVarsOrders=["first-reference-note-number"],this.ignoreVarsOther=["first-reference-note-number","locator","label","section","page-first","page"]},xt.Parallel.prototype.isMid=function(t){return-1<this.midVars.indexOf(t)},xt.Parallel.prototype.StartCitation=function(t,e){this.parallel_conditional_blobs_list=[],this.use_parallels&&(this.sortedItems=t,this.sortedItemsPos=-1,this.sets.clear(),this.sets.push([]),this.in_series=!0,this.delim_counter=0,this.delim_pointers=[],this.out=e||this.state.output.queue,this.master_was_neutral_cite=!0)},xt.Parallel.prototype.StartCite=function(t,e,i){var s,r,n,a,o,l;if(this.use_parallels){this.sets.value().length&&this.sets.value()[0].itemId==t.id&&this.ComposeSet(),this.sortedItemsPos+=1,e&&(s=e.position);for(var u=!(this.try_cite=!0),p=0,h=xt.PARALLEL_MATCH_VARS.length;p<h;p+=1)if(t[xt.PARALLEL_MATCH_VARS[p]]){u=!0;break}var c=!0,f=this.sets.value().slice(-1)[0];if(f&&f.Item){var m=f.Item.jurisdiction?f.Item.jurisdiction.split(":")[0]:"",d=t.jurisdiction?t.jurisdiction.split(":")[0]:"";f.Item.title!==t.title?c=!1:m!==d?c=!1:f.Item.type!==t.type?c=!1:-1<["article-journal","article-magazine"].indexOf(t.type)&&(this.state.opt.development_extensions.handle_parallel_articles&&f.Item["container-title"]===t["container-title"]||(c=!1))}if(c&&u&&-1!==xt.PARALLEL_TYPES.indexOf(t.type)||(this.try_cite=!0,this.in_series&&(this.in_series=!1)),this.cite={},this.cite.front=[],this.cite.mid=[],this.cite.back=[],this.cite.front_collapse={},this.cite.back_forceme=[],this.cite.position=s,this.cite.Item=t,this.cite.itemId=""+t.id,this.cite.prevItemID=""+i,this.target="front",-1<["treaty"].indexOf(t.type))this.ignoreVars=this.ignoreVarsOrders;else if(-1<["article-journal","article-magazine"].indexOf(t.type))this.ignoreVars=this.ignoreVarsOther;else if(e&&e.prefix){this.ignoreVars=this.ignoreVarsLawProceduralHistory,this.cite.useProceduralHistory=!0;var g=this.sets.value()[this.sets.value().length-1];if(g&&g.back)for(p=g.back.length-1;-1<p;p+=-1)g.back[p]&&g[g.back[p]]&&delete g[g.back[p]]}else this.ignoreVars=this.ignoreVarsLawGeneral;if(this.sortedItems&&0<this.sortedItemsPos&&this.sortedItemsPos<this.sortedItems.length){if(n=this.sortedItems[this.sortedItemsPos][1],a=""+this.sortedItems[this.sortedItemsPos-1][1].id,o=!1,this.state.registry.registry[a].parallel==n.id){for(r=this.sortedItemsPos-1;-1<r;r+=-1)if(this.sortedItems[r][1].id==t.id){o=this.sortedItems[r][1].locator;break}l=this.sortedItems[this.sortedItemsPos][1].locator,n.position=!o&&l?xt.POSITION_IBID_WITH_LOCATOR:l===o?xt.POSITION_IBID:xt.POSITION_IBID_WITH_LOCATOR}}else{if(!this.state.registry.registry[t.id])return this.try_cite=!1,void(this.force_collapse=!1);this.state.registry.registry[t.id].parallel=!1}this.force_collapse=!1,this.state.registry.registry[t.id].parallel&&(this.force_collapse=!0)}},xt.Parallel.prototype.StartVariable=function(t,e){if(this.use_parallels&&(this.try_cite||this.force_collapse)){if(this.variable="names"===t?t+":"+this.target:t,-1<this.ignoreVars.indexOf(t))return;"container-title"===t&&0===this.sets.value().length&&(this.master_was_neutral_cite=!1),this.data={},this.data.value="",this.data.blobs=[];var i=this.isMid(t);if("authority"===e&&"names:front"===this.variable&&this.sets.value().length){var s=this.sets.value()[this.sets.value().length-1].Item,r=!1;this.cite.Item.authority&&this.cite.Item.authority.length&&(r=this.cite.Item.authority[0].literal);var n=!1;s.authority&&s.authority.length&&(n=s.authority[0].literal),r!==n&&(this.try_cite=!0,this.in_series=!1)}else"front"===this.target&&i?this.target="mid":"mid"===this.target&&!i&&this.cite.Item.title&&"names"!==t?this.target="back":"back"===this.target&&i&&(this.try_cite=!0,this.in_series=!1);"number"===t?this.cite.front.push(this.variable):-1<xt.PARALLEL_COLLAPSING_MID_VARSET.indexOf(t)?-1<["article-journal","article-magazine"].indexOf(this.cite.Item.type)?this.cite.mid.push(this.variable):this.cite.front.push(this.variable):this.cite[this.target].push(this.variable)}},xt.Parallel.prototype.AppendBlobPointer=function(t){if(this.use_parallels){if(-1<this.ignoreVars.indexOf(this.variable))return;if(this.use_parallels&&(this.force_collapse||this.try_cite)){if(-1<["article-journal","article-magazine"].indexOf(this.cite.Item.type)){if(-1<["volume","page","page-first","issue"].indexOf(this.variable))return;if("container-title"===this.variable&&1<this.cite.mid.length)return}this.variable&&(this.try_cite||this.force_collapse)&&t&&t.blobs&&(this.cite.useProceduralHistory&&"back"===this.target||this.data.blobs.push([t,t.blobs.length]))}}},xt.Parallel.prototype.AppendToVariable=function(t,e){if(this.use_parallels){if(-1<this.ignoreVars.indexOf(this.variable))return;if(this.try_cite||this.force_collapse)this.target,this.data.value+="::"+t}},xt.Parallel.prototype.CloseVariable=function(){if(this.use_parallels){if(-1<this.ignoreVars.indexOf(this.variable))return;if((this.try_cite||this.force_collapse)&&(this.cite[this.variable]=this.data,0<this.sets.value().length)){var t=this.sets.value()[this.sets.value().length-1];"front"===this.target&&"issued"===this.variable&&this.data.value&&this.master_was_neutral_cite&&(this.target="mid"),"front"===this.target?!t[this.variable]&&!this.data.value||t[this.variable]&&this.data.value===t[this.variable].value||"issued"!==this.variable&&(this.in_series=!1):"mid"===this.target?-1<xt.PARALLEL_COLLAPSING_MID_VARSET.indexOf(this.variable)&&(t[this.variable]&&t[this.variable].value===this.data.value?this.cite.front_collapse[this.variable]=!0:this.cite.front_collapse[this.variable]=!1):"back"===this.target&&t[this.variable]&&this.data.value!==t[this.variable].value&&-1===this.sets.value().slice(-1)[0].back_forceme.indexOf(this.variable)&&(this.in_series=!1)}this.variable=!1}},xt.Parallel.prototype.CloseCite=function(){var t,e,i,s,r,n;if(this.use_parallels&&(this.force_collapse||this.try_cite)){if(i=!1,this.cite.front_collapse["container-title"]||(i=!0),!1===this.cite.front_collapse.volume&&(i=!0),!1===this.cite.front_collapse["collection-number"]&&(i=!0),!1===this.cite.front_collapse.section&&(i=!0),i){this.cite.use_journal_info=!0,-1<(n=this.cite.front.indexOf("section"))&&(this.cite.front=this.cite.front.slice(0,n).concat(this.cite.front.slice(n+1))),-1<(s=this.cite.front.indexOf("volume"))&&(this.cite.front=this.cite.front.slice(0,s).concat(this.cite.front.slice(s+1))),-1<(r=this.cite.front.indexOf("container-title"))&&(this.cite.front=this.cite.front.slice(0,r).concat(this.cite.front.slice(r+1)));var a=this.cite.front.indexOf("collection-number");-1<a&&(this.cite.front=this.cite.front.slice(0,a).concat(this.cite.front.slice(a+1)))}if(this.in_series||this.force_collapse||this.ComposeSet(!0),0===this.sets.value().length){var o=!1;for(t=0,e=this.cite.back.length;t<e;t+=1)if("issued"===this.cite.back[t]&&this.cite.issued&&this.cite.issued.value){o=!0;break}o||this.cite.back_forceme.push("issued")}else{var l=this.cite.front.indexOf("issued");if((-1===l||this.master_was_neutral_cite)&&(this.cite.back_forceme=this.sets.value().slice(-1)[0].back_forceme),-1<l)this.sets.value()[this.sets.value().length-1].issued||(this.cite.front=this.cite.front.slice(0,l).concat(this.cite.front.slice(l+1)));this.master_was_neutral_cite&&-1<this.cite.mid.indexOf("names:mid")&&this.cite.front.push("names:mid")}this.sets.value().push(this.cite)}},xt.Parallel.prototype.ComposeSet=function(t){var e,i,s;if(this.use_parallels&&(this.force_collapse||this.try_cite)){var r=this.sets.value().length;if(1===this.sets.value().length)this.in_series||(this.sets.value().pop(),this.delim_counter+=1);else{for(s=this.sets.value().length,i=0;i<s;i+=1)e=this.sets.value()[i],0===i||(!e.Item.title&&e.use_journal_info?this.delim_pointers.push(!1):this.delim_pointers.push(this.delim_counter)),this.delim_counter+=1,xt.POSITION_FIRST===e.position&&(0===i?(this.state.registry.registry[e.itemId].master=!0,this.state.registry.registry[e.itemId].siblings=[],this.state.registry.registry[e.itemId].parallel=!1):e.prevItemID&&(this.state.registry.registry[e.prevItemID].parallel?this.state.registry.registry[e.itemId].parallel=this.state.registry.registry[e.prevItemID].parallel:this.state.registry.registry[e.itemId].parallel=e.prevItemID,this.state.registry.registry[e.itemId].siblings=this.state.registry.registry[e.prevItemID].siblings,this.state.registry.registry[e.itemId].siblings||(this.state.registry.registry[e.itemId].siblings=[],xt.debug("WARNING: adding missing siblings array to registry object")),this.state.registry.registry[e.itemId].siblings.push(e.itemId)));this.sets.push([])}r<2?this.purgeGroupsIfParallel(!1):this.purgeGroupsIfParallel(!0),this.in_series=!0}},xt.Parallel.prototype.PruneOutputQueue=function(){var t,e,i,s,r,n;if(this.use_parallels)for(t=this.sets.mystack.length,e=0;e<t;e+=1)if(1<(i=this.sets.mystack[e]).length)for(r=i.length,s=0;s<r;s+=1)n=i[s],0===s?this.purgeVariableBlobs(n,n.back):s===i.length-1?this.purgeVariableBlobs(n,n.front.concat(n.back_forceme)):this.purgeVariableBlobs(n,n.front.concat(n.back))},xt.Parallel.prototype.purgeVariableBlobs=function(t,e){var i,s,r,n,a,o;if(this.use_parallels){for(void 0===(o=this.state.output.current.value()).length&&(o=o.blobs),s=0,i=this.delim_pointers.length;s<i;s+=1)!1!==(a=this.delim_pointers[s])&&(o[a].parallel_delimiter=", ");for(s=i=e.length-1;-1<s;s+=-1)if(t[r=e[s]])for(a=t[r].blobs.length-1;-1<a;a+=-1)(n=t[r].blobs[a])[0].blobs=n[0].blobs.slice(0,n[1]).concat(n[0].blobs.slice(n[1]+1)),this.state.tmp.has_purged_parallel=!0,n[0]&&n[0].strings&&"string"==typeof n[0].strings.oops&&n[0].parent&&n[0].parent&&(n[0].parent.parent.strings.delimiter=n[0].strings.oops)}},xt.Parallel.prototype.purgeGroupsIfParallel=function(t){for(var e=this.parallel_conditional_blobs_list.length-1;-1<e;e+=-1){for(var i=this.parallel_conditional_blobs_list[e],s=!0,r=0,n=i.conditions.length;r<n;r+=1)if(!i.conditions[r]!=!!t&&("master"!==i.conditions[r]||this.state.registry.registry[i.id].master)&&("servant"!==i.conditions[r]||this.state.registry.registry[i.id].parallel)){s=!1;break}if(s){for(var a=[];i.blobs.length>i.pos;)a.push(i.blobs.pop());for(a.length&&a.pop();a.length;)i.blobs.push(a.pop())}this.parallel_conditional_blobs_list.pop()}},(t.exports=xt).Util={},xt.Util.Match=function(){this.any=function(t,e,r){return function(t,e){for(var i=0,s=r.length;i<s;i+=1){if(r[i](t,e))return!0}return!1}},this.none=function(t,e,r){return function(t,e){for(var i=0,s=r.length;i<s;i+=1){if(r[i](t,e))return!1}return!0}},this.all=function(t,e,r){return function(t,e){for(var i=0,s=r.length;i<s;i+=1){if(!r[i](t,e))return!1}return!0}},this[void 0]=this.all,this.nand=function(t,e,r){return function(t,e){for(var i=0,s=r.length;i<s;i+=1){if(!r[i](t,e))return!0}return!1}}},(t.exports=xt).Transform=function(w){function g(t,e,i){var s="";return w.sys.getHumanForm&&("country"===t?s=(s=w.sys.getHumanForm(e.toLowerCase(),!1,!0)).split("|")[0]:"jurisdiction"===t&&(s=w.sys.getHumanForm(e.toLowerCase(),!1,!0),s=i?"":s.split("|").slice(1).join(", "))),s}function R(t,e,i,s,r,n,a,o){var l,u="",p=xt.FIELD_CATEGORY_REMAP[n];if(!p)return r;var h=n,c=r;t.sys.normalizeAbbrevsKey&&(c=t.sys.normalizeAbbrevsKey(n,r));var f=!1;if("jurisdiction"===h&&c&&(f=-1===c.indexOf(":")),t.sys.getAbbreviation){l=-1<["jurisdiction","country","language-name","language-name-original"].indexOf(h)?"default":i.jurisdiction?i.jurisdiction:"default";var m=t.transform.loadAbbreviation(l,p,c,i.type);if(t.transform.abbrevs[m][p]&&c){var d=t.transform.abbrevs[m][p][c];u="short"===e.strings.form&&d?f?"":d:g(h,c,f)}}return u||t.opt.development_extensions.require_explicit_legal_case_title_short&&"legal_case"===i.type||!s||!i[s]||!a||(u=i[s]),u||t.sys.getAbbreviation||!t.sys.getHumanForm||(u=g(h,c,f)),u||f||t.sys.getHumanForm&&"jurisdiction"===h||(u=r),u}function b(t,e){var i,s=w.opt["default-locale"][0].slice(0,2);if(i=w.opt.development_extensions.strict_text_case_locales?new RegExp("^([a-zA-Z]{2})(?:$|-.*| .*)"):new RegExp("^([a-zA-Z]{2})(?:$|-.*|.*)"),t.language){var r=(""+t.language).match(i);s=r?r[1]:"tlh"}return t.multi&&t.multi&&t.multi.main&&t.multi.main[e]&&(s=t.multi.main[e]),w.opt.development_extensions.strict_text_case_locales&&!w.opt.development_extensions.normalize_lang_keys_to_lowercase||(s=s.toLowerCase()),s}function L(t,e,i,s,r){var n,a,o,l=r,u=!1;if(!t[e])return{name:"",usedOrig:r,token:xt.Util.cloneToken(this)};h={name:"",usedOrig:r,locale:b(t,e)},o=w.opt[i];var p=!1;if("locale-orig"===i)h=r?{name:"",usedOrig:r}:{name:t[e],usedOrig:!1,locale:b(t,e)},u=p=!0;else if(s&&(void 0===o||0===o.length)){var h={name:t[e],usedOrig:!0,locale:b(t,e)};u=p=!0}if(!p){for(var c=0,f=o.length;c<f;c+=1){if(a=(n=o[c]).split(/[\-_]/)[0],n&&t.multi&&t.multi._keys[e]&&t.multi._keys[e][n]){h.name=t.multi._keys[e][n],h.locale=n;break}if(a&&t.multi&&t.multi._keys[e]&&t.multi._keys[e][a]){h.name=t.multi._keys[e][a],h.locale=a;break}}!h.name&&s&&(h={name:t[e],usedOrig:!0,locale:b(t,e)},u=!0)}if(h.token=xt.Util.cloneToken(this),-1<["title","container-title"].indexOf(e)&&!(l||h.token.strings["text-case"]&&"sentence"!==h.token.strings["text-case"]&&"normal"!==h.token.strings["text-case"])){var m=!u&&h.locale,d=e.slice(0,-5),g="sentence"===h.token.strings["text-case"];h.name=xt.titlecaseSentenceOrNormal(w,t,d,m,g),delete h.token.strings["text-case"]}return h}function j(t){var e=t.match(/^!([-,_a-z]+)>>>/);if(e){var i=e[1].split(",");t=t.slice(e[0].length);for(var s=0,r=i.length;s<r;s+=1)-1===w.tmp.done_vars.indexOf(i[s])&&w.tmp.done_vars.push(i[s])}return t}this.abbrevs={},this.abbrevs.default=new w.sys.AbbreviationSegments,this.getTextSubField=L,this.loadAbbreviation=function(t,e,i,s){return t||(t="default"),i?w.sys.getAbbreviation&&((t=w.sys.getAbbreviation(w.opt.styleID,w.transform.abbrevs,t,e,i,s,!0))||(t="default")):(w.transform.abbrevs[t]||(w.transform.abbrevs[t]=new w.sys.AbbreviationSegments),w.transform.abbrevs[t][e]||(w.transform.abbrevs[t][e]={})),t},this.getOutputFunction=function(A,T,t,N,e){var E,k=xt.LangPrefsMap[A[0]];return E=!!k&&w.opt["cite-lang-prefs"][k],function(t,e,i,s){var r,n,a,o,l,u;if(!A[0]||!e[A[0]]&&!e[N])return null;var p={primary:!1,secondary:!1,tertiary:!1};if("_sort"===t.tmp.area.slice(-5))p.primary="locale-sort";else if(E)for(var h=["primary","secondary","tertiary"],c=0,f=h.length;c<f&&!(E.length-1<c);c+=1)E[c]&&(p[h[c]]="locale-"+E[c]);else p.primary="locale-orig";if("title-short"!==A[0]&&("bibliography"===t.tmp.area||"citation"===t.tmp.area&&"note"===t.opt.xclass&&i&&!i.position)||(p.secondary=!1,p.tertiary=!1),t.tmp["publisher-list"])return"publisher"===A[0]?t.tmp["publisher-token"]=this:"publisher-place"===A[0]&&(t.tmp["publisher-place-token"]=this),null;var m=L.call(this,e,A[0],p.primary,!0);r=m.name,n=m.locale;var d,g,b,_=m.token,v=m.usedOrig;if(function(t,e,i,s){var r=t.variables[0];if(w.publisherOutput&&i){if(-1===["publisher","publisher-place"].indexOf(r))return!1;w.publisherOutput[r+"-token"]=t,w.publisherOutput.varlist.push(r);var n=i.split(/;\s*/);n.length===w.publisherOutput[r+"-list"].length&&(w.publisherOutput[r+"-list"]=n);for(var a=0,o=n.length;a<o;a+=1)n[a]=R(w,t,e,!1,n[a],s,!0);return w.tmp[r+"-token"]=t,!0}return!1}(this,e,r,T))return null;if(l=a=!1,p.secondary&&(a=(m=L.call(this,e,A[0],p.secondary,!1,m.usedOrig)).name,o=m.locale,d=m.token),p.tertiary&&(l=(m=L.call(this,e,A[0],p.tertiary,!1,m.usedOrig)).name,u=m.locale,g=m.token),T&&((r=R(t,_,e,N,r,T,!0))&&(r=j(r)),a&&(a=R(t,d,e,!1,a,T,!0)),l&&(l=R(t,g,e,!1,l,T,!0))),"locale-translit"===p.primary&&(b=t.opt.citeAffixes[k][p.primary].prefix),"<i>"===b&&"title"===A[0]&&!v){var y=!1;for(c=0,f=_.decorations.length;c<f;c+=1)"@font-style"===_.decorations[c][0]&&"italic"===_.decorations[c][1]&&(y=!0);y||_.decorations.push(["@font-style","italic"])}if("en"!==n&&"title"===_.strings["text-case"]&&(_.strings["text-case"]="passthrough"),"title"===A[0]&&(r=xt.demoteNoiseWords(t,r,this["leading-noise-words"])),a||l){if(t.output.openLevel("empty"),_.strings.suffix=_.strings.suffix.replace(/[ .,]+$/,""),t.output.append(r,_),a){for(d.strings.prefix=t.opt.citeAffixes[k][p.secondary].prefix,d.strings.suffix=t.opt.citeAffixes[k][p.secondary].suffix,d.strings.prefix||(d.strings.prefix=" "),c=d.decorations.length-1;-1<c;c+=-1)-1<["@quotes/true","@font-style/italic","@font-style/oblique","@font-weight/bold"].indexOf(d.decorations[c].join("/"))&&(d.decorations=d.decorations.slice(0,c).concat(d.decorations.slice(c+1)));"en"!==o&&"title"===d.strings["text-case"]&&(d.strings["text-case"]="passthrough");var x=new xt.Token;x.decorations.push(["@font-style","normal"]),x.decorations.push(["@font-weight","normal"]),t.output.openLevel(x),t.output.append(a,d),t.output.closeLevel();var I=t.output.current.value(),O=t.output.current.value().blobs.length-1;t.parallel.use_parallels&&(t.parallel.cite.front.push(A[0]+":secondary"),t.parallel.cite[A[0]+":secondary"]={blobs:[[I,O]]})}if(l){for(g.strings.prefix=t.opt.citeAffixes[k][p.tertiary].prefix,g.strings.suffix=t.opt.citeAffixes[k][p.tertiary].suffix,g.strings.prefix||(g.strings.prefix=" "),c=g.decorations.length-1;-1<c;c+=-1)-1<["@quotes/true","@font-style/italic","@font-style/oblique","@font-weight/bold"].indexOf(g.decorations[c].join("/"))&&(g.decorations=g.decorations.slice(0,c).concat(g.decorations.slice(c+1)));"en"!==u&&"title"===g.strings["text-case"]&&(g.strings["text-case"]="passthrough");var S=new xt.Token;S.decorations.push(["@font-style","normal"]),S.decorations.push(["@font-weight","normal"]),t.output.openLevel(S),t.output.append(l,g),t.output.closeLevel(),I=t.output.current.value(),O=t.output.current.value().blobs.length-1,t.parallel.use_parallels&&(t.parallel.cite.front.push(A[0]+":tertiary"),t.parallel.cite[A[0]+":tertiary"]={blobs:[[I,O]]})}t.output.closeLevel()}else t.output.append(r,_);return null}},this.quashCheck=j},(t.exports=xt).Token=function(t,e){this.name=t,this.strings={},this.strings.delimiter=void 0,this.strings.prefix="",this.strings.suffix="",this.decorations=[],this.variables=[],this.execs=[],this.tokentype=e,this.evaluator=!1,this.tests=[],this.rawtests=[],this.succeed=!1,this.fail=!1,this.next=!1},xt.Util.cloneToken=function(t){var e,i,s;if("string"==typeof t)return t;for(var r in e=new xt.Token(t.name,t.tokentype),t.strings)t.strings.hasOwnProperty(r)&&(e.strings[r]=t.strings[r]);if(t.decorations)for(e.decorations=[],i=0,s=t.decorations.length;i<s;i+=1)e.decorations.push(t.decorations[i].slice());return t.variables&&(e.variables=t.variables.slice()),t.execs&&(e.execs=t.execs.slice(),e.tests=t.tests.slice(),e.rawtests=t.tests.slice()),e},(t.exports=xt).AmbigConfig=function(){this.maxvals=[],this.minval=1,this.names=[],this.givens=[],this.year_suffix=!1,this.disambiguate=0},(t.exports=xt).Blob=function(t,e,i){var s,r;if(this.levelname=i,e){for(var n in this.strings={prefix:"",suffix:""},e.strings)e.strings.hasOwnProperty(n)&&(this.strings[n]=e.strings[n]);for(this.decorations=[],s=void 0===e.decorations?0:e.decorations.length,r=0;r<s;r+=1)this.decorations.push(e.decorations[r].slice())}else this.strings={},this.strings.prefix="",this.strings.suffix="",this.strings.delimiter="",this.decorations=[];this.blobs="string"==typeof t?t:t?[t]:[],this.alldecor=[this.decorations]},xt.Blob.prototype.push=function(t){if("string"==typeof this.blobs)throw"Attempt to push blob onto string object";!1!==t&&(t.alldecor=t.alldecor.concat(this.alldecor),this.blobs.push(t))},(t.exports=xt).NumericBlob=function(t,e,i,s){this.id=s,this.alldecor=[],this.num=e,this.particle=t,this.blobs=e.toString(),this.status=xt.START,this.strings={},i?(this.gender=i.gender,this.decorations=i.decorations,this.strings.prefix=i.strings.prefix,this.strings.suffix=i.strings.suffix,this.strings["text-case"]=i.strings["text-case"],this.successor_prefix=i.successor_prefix,this.range_prefix=i.range_prefix,this.splice_prefix=i.splice_prefix,this.formatter=i.formatter,this.formatter||(this.formatter=new xt.Output.DefaultFormatter),this.formatter&&(this.type=this.formatter.format(1))):(this.decorations=[],this.strings.prefix="",this.strings.suffix="",this.successor_prefix="",this.range_prefix="",this.splice_prefix="",this.formatter=new xt.Output.DefaultFormatter)},xt.NumericBlob.prototype.setFormatter=function(t){this.formatter=t,this.type=this.formatter.format(1)},xt.Output.DefaultFormatter=function(){},xt.Output.DefaultFormatter.prototype.format=function(t){return t.toString()},xt.NumericBlob.prototype.checkNext=function(t,e){e?(this.status=xt.START,"object"==typeof t&&(t.num===this.num+1?t.status=xt.SUCCESSOR:t.status=xt.SEEN)):t&&t.num&&this.type===t.type&&t.num===this.num+1?this.status===xt.START||this.status===xt.SEEN?t.status=xt.SUCCESSOR:this.status!==xt.SUCCESSOR&&this.status!==xt.SUCCESSOR_OF_SUCCESSOR||(this.range_prefix?(t.status=xt.SUCCESSOR_OF_SUCCESSOR,this.status=xt.SUPPRESS):t.status=xt.SUCCESSOR):(this.status===xt.SUCCESSOR_OF_SUCCESSOR&&(this.status=xt.END),"object"==typeof t&&(t.status=xt.SEEN))},xt.NumericBlob.prototype.checkLast=function(t){return(this.status===xt.SEEN||t.num!==this.num-1&&this.status===xt.SUCCESSOR)&&(this.status=xt.SUCCESSOR,!0)},(t.exports=xt).Util.fixDateNode=function(t,e,i){var s,r,n,a,o,l,u,p,h,c,f,m,d,g=this.cslXml.getAttributeValue(i,"lingo"),b=this.cslXml.getAttributeValue(i,"default-locale");if(this.build.date_key=!0,s=this.cslXml.getAttributeValue(i,"form"),g=b?this.opt["default-locale"][0]:this.cslXml.getAttributeValue(i,"lingo"),!this.getDate(s,b))return t;var _=this.cslXml.getAttributeValue(i,"date-parts");for(var v in r=this.cslXml.getAttributeValue(i,"variable"),p=this.cslXml.getAttributeValue(i,"prefix"),h=this.cslXml.getAttributeValue(i,"suffix"),m=this.cslXml.getAttributeValue(i,"display"),d=this.cslXml.getAttributeValue(i,"cslid"),n=this.cslXml.nodeCopy(this.getDate(s,b)),this.cslXml.setAttribute(n,"lingo",this.opt.lang),this.cslXml.setAttribute(n,"form",s),this.cslXml.setAttribute(n,"date-parts",_),this.cslXml.setAttribute(n,"cslid",d),this.cslXml.setAttribute(n,"variable",r),this.cslXml.setAttribute(n,"default-locale",b),p&&this.cslXml.setAttribute(n,"prefix",p),h&&this.cslXml.setAttribute(n,"suffix",h),m&&this.cslXml.setAttribute(n,"display",m),c=this.cslXml.children(n))a=c[v],"date-part"===this.cslXml.nodename(a)&&(o=this.cslXml.getAttributeValue(a,"name"),b&&this.cslXml.setAttributeOnNodeIdentifiedByNameAttribute(n,"date-part",o,"@default-locale","true"));for(var v in c=this.cslXml.children(i))if(a=c[v],"date-part"===this.cslXml.nodename(a))for(l in o=this.cslXml.getAttributeValue(a,"name"),f=this.cslXml.attributes(a))"@name"!==l&&(g&&g!==this.opt.lang&&-1<["@suffix","@prefix","@form"].indexOf(l)||(u=f[l],this.cslXml.setAttributeOnNodeIdentifiedByNameAttribute(n,"date-part",o,l,u)));if("year"===this.cslXml.getAttributeValue(i,"date-parts"))this.cslXml.deleteNodeByNameAttribute(n,"month"),this.cslXml.deleteNodeByNameAttribute(n,"day");else if("year-month"===this.cslXml.getAttributeValue(i,"date-parts"))this.cslXml.deleteNodeByNameAttribute(n,"day");else if("month-day"===this.cslXml.getAttributeValue(i,"date-parts")){for(var y=this.cslXml.children(n),x=1,I=this.cslXml.numberofnodes(y);x<I;x++)if("year"===this.cslXml.getAttributeValue(y[x],"name")){this.cslXml.setAttribute(y[x-1],"suffix","");break}this.cslXml.deleteNodeByNameAttribute(n,"year")}return this.cslXml.insertChildNodeAfter(t,i,e,n)},(t.exports=xt).dateMacroAsSortKey=function(t,e){xt.dateAsSortKey.call(this,t,e,!0)},xt.dateAsSortKey=function(t,e,i){var s,r,n,a,o,l,u,p=this.variables[0],h="empty";for(i&&t.tmp.extension&&(h="macro-with-date"),void 0===(s=e[p])&&((s={"date-parts":[[0]]}).year||(t.tmp.empty_date=!0)),void 0===this.dateparts&&(this.dateparts=["year","month","day"]),s.raw?s=t.fun.dateparser.parseDateToArray(s.raw):s["date-parts"]&&(s=t.dateParseArray(s)),void 0===s&&(s={}),l=0,u=xt.DATE_PARTS_INTERNAL.length;l<u;l+=1)if(n=0,"_end"===(a=r=xt.DATE_PARTS_INTERNAL[l]).slice(-4)&&(a=a.slice(0,-4)),s[r]&&-1<this.dateparts.indexOf(a)&&(n=s[r]),"year"===r.slice(0,4)){var c="Y";"-"===(o=xt.Util.Dates[a].numeric(t,n))[0]&&(c="X",o=o.slice(1),o=9999-parseInt(o,10)),t.output.append(xt.Util.Dates[r.slice(0,4)].numeric(t,c+o),h)}else(n=xt.Util.Dates[a]["numeric-leading-zeros"](t,n))||(n="00"),t.output.append(n,h)},xt.Engine.prototype.dateParseArray=function(t){var e,i,s,r;for(i in e={},t)if("date-parts"===i){1<(s=t["date-parts"]).length&&s[0].length!==s[1].length&&xt.error("CSL data error: element mismatch in date range input."),r=["","_end"];for(var n=0,a=s.length;n<a;n+=1)for(var o=0,l=xt.DATE_PARTS.length;o<l;o+=1)isNaN(parseInt(s[n][o],10))?e[xt.DATE_PARTS[o]+r[n]]=void 0:e[xt.DATE_PARTS[o]+r[n]]=parseInt(s[n][o],10)}else t.hasOwnProperty(i)&&("literal"===i&&"object"==typeof t.literal&&"string"==typeof t.literal.part?(xt.debug("Warning: fixing up weird literal date value"),e.literal=t.literal.part):e[i]=t[i]);return e},(t.exports=xt).Util.Names={},xt.Util.Names.compareNamesets=xt.NameOutput.prototype._compareNamesets,xt.Util.Names.unInitialize=function(t,e){var i,s,r,n,a;if(!e)return"";for(r=e.split(/(?:\-|\s+)/),n=e.match(/(\-|\s+)/g),a="",i=0,s=r.length;i<s;i+=1)a+=r[i],i<s-1&&(a+=n[i]);return a},xt.Util.Names.initializeWith=function(t,e,i,s){var r,n,a,o,l,u;if(!e)return"";if(i||(i=""),-1<["Lord","Lady"].indexOf(e)||!e.match(xt.STARTSWITH_ROMANESQUE_REGEXP)&&!i.match("%s"))return e;var p=e;if(!1===t.opt["initialize-with-hyphen"]&&(p=p.replace(/\-/g," ")),l=(p=(p=p.replace(/\s*\-\s*/g,"-").replace(/\s+/g," ")).replace(/-([a-z])/g,"–$1")).match(/[\-\s]+/g),0===(u=p.split(/[\-\s]+/)).length)p=l;else for(p=[u[0]],r=1,n=u.length;r<n;r+=1)p.push(l[r-1]),p.push(u[r]);for(r=(u=p).length-1;-1<r;r+=-1)if(u[r]&&-1<u[r].slice(0,-1).indexOf(".")){var h=u.slice(r+1),c=u[r].slice(0,-1).split(".");for(u=u.slice(0,r),a=0,o=c.length;a<o;a+=1)u.push(c[a]+"."),a<c.length-1&&u.push(" ");u=u.concat(h)}return(s?xt.Util.Names.doNormalize(t,u,i):xt.Util.Names.doInitialize(t,u,i)).replace(/\u2013([a-z])/g,"-$1")},xt.Util.Names.doNormalize=function(t,e,i,s){var r,n;i=i||"";var a=[];for(r=0,n=e.length;r<n;r+=1)1<e[r].length&&"."===e[r].slice(-1)?(e[r]=e[r].slice(0,-1),a.push(!0)):1===e[r].length&&e[r].toUpperCase()===e[r]?a.push(!0):a.push(!1);for(r=0,n=e.length;r<n;r+=2)if(a[r]){if(r<e.length-2)e[r+1]="",(i.match(/^[\u0009\u000a\u000b\u000c\u000d\u0020\u00a0]+$/)||(!i||i.slice(-1)&&!i.slice(-1).match(/[\u0009\u000a\u000b\u000c\u000d\u0020\u00a0]/))&&e[r].length&&e[r].match(xt.ALL_ROMANESQUE_REGEXP)&&(1<e[r].length||1<e[r+2].length))&&(e[r+1]=" "),1<e[r+2].length?e[r]=e[r]+i.replace(/\ufeff$/,""):e[r]=e[r]+i;r===e.length-1&&(e[r]=e[r]+i)}return e.join("").replace(/[\u0009\u000a\u000b\u000c\u000d\u0020\ufeff\u00a0]+$/,"").replace(/\s*\-\s*/g,"-").replace(/[\u0009\u000a\u000b\u000c\u000d\u0020]+/g," ")},xt.Util.Names.doInitialize=function(t,e,i,s){var r,n,a,o,l,u,p;for(r=0,n=e.length;r<n;r+=2)if(p=e[r])if(!(a=p.match(xt.NAME_INITIAL_REGEXP))&&!p.match(xt.STARTSWITH_ROMANESQUE_REGEXP)&&1<p.length&&i.match("%s")&&(a=p.match(/(.)(.*)/)),a&&a[1]===a[1].toUpperCase()){var h="";if(a[2]){var c="";for(o=0,l=(u=a[2].split("")).length;o<l;o+=1){var f=u[o];if(f!==f.toUpperCase())break;c+=f}c.length<a[2].length&&(h=c.toLocaleLowerCase())}e[r]=a[1].toLocaleUpperCase()+h,r<n-1?i.match("%s")?e[r]=i.replace("%s",e[r]):-1<e[r+1].indexOf("-")?e[r+1]=i+e[r+1]:e[r+1]=i:i.match("%s")?e[r]=i.replace("%s",e[r]):e.push(i)}else p.match(xt.ROMANESQUE_REGEXP)&&(e[r]=" "+p);var m=e.join("");return m=m.replace(/[\u0009\u000a\u000b\u000c\u000d\u0020\ufeff\u00a0]+$/,"").replace(/\s*\-\s*/g,"-").replace(/[\u0009\u000a\u000b\u000c\u000d\u0020]+/g," ")},xt.Util.Names.getRawName=function(t){var e=[];return t.given&&e.push(t.given),t.family&&e.push(t.family),e.join(" ")},(t.exports=xt).Util.Dates={},xt.Util.Dates.year={},xt.Util.Dates.year.long=function(t,e){return e||(e="boolean"==typeof e?"":0),e.toString()},xt.Util.Dates.year.imperial=function(t,e,i,s){var r="";e||(e="boolean"==typeof e?"":0),i=i?"_end":"";var n=t.tmp.date_object["month"+i];for(n=n?""+n:"1";n.length<2;)n="0"+n;var a=t.tmp.date_object["day"+i];for(a=a?""+a:"1";a.length<2;)a="0"+a;var o,l,u=parseInt(e+n+a,10);if(18680908<=u&&u<19120730?(o="明治",l=1867):19120730<=u&&u<19261225?(o="大正",l=1911):19261225<=u&&u<19890108?(o="昭和",l=1925):19890108<=u&&(o="平成",l=1988),o&&l){var p=o;t.sys.normalizeAbbrevsKey&&(p=t.sys.normalizeAbbrevsKey("number",o)),t.transform.abbrevs.default.number[p]||t.transform.loadAbbreviation("default","number",p),t.transform.abbrevs.default.number[p]&&(o=t.transform.abbrevs.default.number[p]),r=o+(e-l)}return r},xt.Util.Dates.year.short=function(t,e){if((e=e.toString())&&4===e.length)return e.substr(2)},xt.Util.Dates.year.numeric=function(t,e){var i,s;for(e=(s=(e=""+e).match(/([0-9]*)$/))?(i=e.slice(0,-1*s[1].length),s[1]):(i=e,"");e.length<4;)e="0"+e;return i+e},xt.Util.Dates.normalizeMonth=function(t,e){var i;if(t||(t=0),(t=""+t).match(/^[0-9]+$/)||(t=0),t=parseInt(t,10),e){var s={stub:"month-",num:t};s.num<1||20<s.num?s.num=0:16<s.num?(s.stub="season-",s.num=s.num-16):12<s.num&&(s.stub="season-",s.num=s.num-12),i=s}else(t<1||12<t)&&(t=0),i=t;return i},xt.Util.Dates.month={},xt.Util.Dates.month.numeric=function(t,e){return(e=xt.Util.Dates.normalizeMonth(e))||(e=""),e},xt.Util.Dates.month["numeric-leading-zeros"]=function(t,e){if(e=xt.Util.Dates.normalizeMonth(e))for(e=""+e;e.length<2;)e="0"+e;else e="";return e},xt.Util.Dates.month.long=function(t,e,i,s){var r=xt.Util.Dates.normalizeMonth(e,!0);if(e=r.num){for(e=""+e;e.length<2;)e="0"+e;e=t.getTerm(r.stub+e,"long",0,0,!1,s)}else e="";return e},xt.Util.Dates.month.short=function(t,e,i,s){var r=xt.Util.Dates.normalizeMonth(e,!0);if(e=r.num){for(e=""+e;e.length<2;)e="0"+e;e=t.getTerm(r.stub+e,"short",0,0,!1,s)}else e="";return e},xt.Util.Dates.day={},xt.Util.Dates.day.numeric=function(t,e){return e.toString()},xt.Util.Dates.day.long=xt.Util.Dates.day.numeric,xt.Util.Dates.day["numeric-leading-zeros"]=function(t,e){for(e||(e=0),e=e.toString();e.length<2;)e="0"+e;return e.toString()},xt.Util.Dates.day.ordinal=function(t,e,i){return t.fun.ordinalizer.format(e,i)},(t.exports=xt).Util.Sort={},xt.Util.Sort.strip_prepositions=function(t){var e;return"string"==typeof t&&(e=t.toLocaleLowerCase(),e=t.match(/^((a|an|the)\s+)/)),e&&(t=t.substr(e[1].length)),t},(t.exports=xt).Util.substituteStart=function(i,t){var e,s,r,n,a,o,l;n=function(t,e){for(var i=0,s=this.decorations.length;i<s;i+=1)if("@strip-periods"===this.decorations[i][0]&&"true"===this.decorations[i][1]){t.tmp.strip_periods+=1;break}},this.execs.push(n),this.decorations&&(i.opt.development_extensions.csl_reverse_lookup_support||i.sys.csl_reverse_lookup_support)&&(this.decorations.reverse(),this.decorations.push(["@showid","true",this.cslid]),this.decorations.reverse()),l=["number","date","names"],("text"===this.name&&!this.postponed_macro||-1<l.indexOf(this.name))&&(e=function(t,e,i){"author"===t.tmp.element_trace.value()||"names"===this.name?i&&i["author-only"]?t.tmp.element_trace.push("do-not-suppress-me"):i&&i["suppress-author"]:i&&i["author-only"]?t.tmp.element_trace.push("suppress-me"):i&&i["suppress-author"]&&t.tmp.element_trace.push("do-not-suppress-me")},this.execs.push(e)),s=this.strings.cls,this.strings.cls=!1,0===i.build.render_nesting_level&&("bibliography"===i.build.area&&i.bibliography.opt["second-field-align"]?((r=new xt.Token("group",xt.START)).decorations=[["@display","left-margin"]],n=function(t,e){t.tmp.render_seen||(r.strings.first_blob=e.id,t.output.startTag("bib_first",r))},r.execs.push(n),t.push(r)):-1<xt.DISPLAY_CLASSES.indexOf(s)&&((r=new xt.Token("group",xt.START)).decorations=[["@display",s]],n=function(t,e){r.strings.first_blob=e.id,t.output.startTag("bib_first",r)},r.execs.push(n),t.push(r)),i.build.cls=s),i.build.render_nesting_level+=1,1===i.build.substitute_level.value()&&(a=new xt.Token("choose",xt.START),xt.Node.choose.build.call(a,i,t),n=function(t,e){return!!i.tmp.can_substitute.value()},(o=new xt.Token("if",xt.START)).tests.push(n),o.test=i.fun.match.any(this,i,o.tests),t.push(o)),i.sys.variableWrapper&&this.variables_real&&this.variables_real.length&&(n=function(t,e,i){if(!t.tmp.just_looking&&!t.tmp.suppress_decorations){var s=new xt.Token("text",xt.START);s.decorations=[["@showid","true"]],t.output.startTag("variable_entry",s);var r=null;i&&(r=i.position),r||(r=0);var n=0;i&&i.noteIndex&&(n=i.noteIndex);var a=0;i&&i["first-reference-note-number"]&&(a=i["first-reference-note-number"]);var o=0;i&&i["citation-number"]&&(o=i["citation-number"]);var l=0;i&&i.index&&(l=i.index);var u={itemData:e,variableNames:this.variables,context:t.tmp.area,xclass:t.opt.xclass,position:["first","subsequent","ibid","ibid-with-locator"][r],"note-number":n,"first-reference-note-number":a,"citation-number":o,index:l,mode:t.opt.mode};t.output.current.value().params=u}},this.execs.push(n))},xt.Util.substituteEnd=function(t,e){var i,s,r,n,a,l;t.sys.variableWrapper&&(this.hasVariable||this.variables_real&&this.variables_real.length)&&(i=function(t,e){t.tmp.just_looking||t.tmp.suppress_decorations||t.output.endTag("variable_entry")},this.execs.push(i)),i=function(t,e){for(var i=0,s=this.decorations.length;i<s;i+=1)if("@strip-periods"===this.decorations[i][0]&&"true"===this.decorations[i][1]){t.tmp.strip_periods+=-1;break}},this.execs.push(i),t.build.render_nesting_level+=-1,0===t.build.render_nesting_level&&(t.build.cls?(i=function(t,e){t.output.endTag("bib_first")},this.execs.push(i),t.build.cls=!1):"bibliography"===t.build.area&&t.bibliography.opt["second-field-align"]&&(i=function(t,e){t.tmp.render_seen||t.output.endTag("bib_first")},(s=new xt.Token("group",xt.END)).execs.push(i),e.push(s),(r=new xt.Token("group",xt.START)).decorations=[["@display","right-inline"]],i=function(t,e){t.tmp.render_seen||(t.tmp.render_seen=!0,t.output.startTag("bib_other",r))},r.execs.push(i),e.push(r))),1===t.build.substitute_level.value()&&(n=new xt.Token("if",xt.END),e.push(n),a=new xt.Token("choose",xt.END),xt.Node.choose.build.call(a,t,e)),("names"===this.name||"text"===this.name&&"title"!==this.variables_real)&&(new xt.Token("text",xt.SINGLETON),i=function(t,e){if("bibliography"===t.tmp.area&&"string"==typeof t.bibliography.opt["subsequent-author-substitute"]&&(!this.variables_real||e[this.variables_real])&&t.tmp.substituted_variable===this.variables_real){var i,s,r=t.bibliography.opt["subsequent-author-substitute-rule"];if(!t.tmp.suppress_decorations&&t.tmp.subsequent_author_substitute_ok&&t.tmp.rendered_name){if("partial-each"===r||"partial-first"===r){var n=!0,a=[];for(i=0,s=t.tmp.name_node.children.length;i<s;i+=1){var o=t.tmp.rendered_name[i];n&&t.tmp.last_rendered_name&&t.tmp.last_rendered_name.length>i-1&&o&&!o.localeCompare(t.tmp.last_rendered_name[i])?(l=new xt.Blob(t[t.tmp.area].opt["subsequent-author-substitute"]),t.tmp.name_node.children[i].blobs=[l],"partial-first"===r&&(n=!1)):n=!1,a.push(o)}t.tmp.last_rendered_name=a}else if("complete-each"===r){if(a=t.tmp.rendered_name.join(",")){if(t.tmp.last_rendered_name&&!a.localeCompare(t.tmp.last_rendered_name))for(i=0,s=t.tmp.name_node.children.length;i<s;i+=1)l=new xt.Blob(t[t.tmp.area].opt["subsequent-author-substitute"]),t.tmp.name_node.children[i].blobs=[l];t.tmp.last_rendered_name=a}}else{(a=t.tmp.rendered_name.join(","))&&(t.tmp.last_rendered_name&&!a.localeCompare(t.tmp.last_rendered_name)&&(l=new xt.Blob(t[t.tmp.area].opt["subsequent-author-substitute"]),t.tmp.label_blob?t.tmp.name_node.top.blobs=[l,t.tmp.label_blob]:t.tmp.name_node.top.blobs.length?t.tmp.name_node.top.blobs[0].blobs=[l]:t.tmp.name_node.top.blobs=[l],t.tmp.substituted_variable=this.variables_real),t.tmp.last_rendered_name=a)}t.tmp.subsequent_author_substitute_ok=!1}}},this.execs.push(i)),("text"===this.name&&!this.postponed_macro||-1<["number","date","names"].indexOf(this.name))&&(i=function(t,e){t.tmp.element_trace.pop()},this.execs.push(i))},(t.exports=xt).Util.padding=function(t){var e=t.match(/\s*(-{0,1}[0-9]+)/);if(e)for((t=parseInt(e[1],10))<0&&(t=1e20+t),t=""+t;t.length<20;)t="0"+t;return t},xt.Util.LongOrdinalizer=function(){},xt.Util.LongOrdinalizer.prototype.init=function(t){this.state=t},xt.Util.LongOrdinalizer.prototype.format=function(t,e){t<10&&(t="0"+t);var i=xt.Engine.getField(xt.LOOSE,this.state.locale[this.state.opt.lang].terms,"long-ordinal-"+t,"long",0,e);return i||(i=this.state.fun.ordinalizer.format(t,e)),this.state.tmp.cite_renders_content=!0,i},xt.Util.Ordinalizer=function(t){this.state=t,this.suffixes={}},xt.Util.Ordinalizer.prototype.init=function(){if(!this.suffixes[this.state.opt.lang]){this.suffixes[this.state.opt.lang]={};for(var t=0;t<3;t+=1){var e=[void 0,"masculine","feminine"][t];this.suffixes[this.state.opt.lang][e]=[];for(var i=1;i<5;i+=1){var s=this.state.getTerm("ordinal-0"+i,"long",!1,e);if(void 0===s){delete this.suffixes[this.state.opt.lang][e];break}this.suffixes[this.state.opt.lang][e].push(s)}}}},xt.Util.Ordinalizer.prototype.format=function(t,e){var i;i=""+(t=parseInt(t,10));var s="",r=[];if(e&&r.push(e),r.push("neuter"),this.state.locale[this.state.opt.lang].ord["1.0.1"]){var n;s=this.state.getTerm("ordinal",!1,0,e);for(var a=0,o=r.length;a<o;a+=1){n=r[a];var l=this.state.locale[this.state.opt.lang].ord["1.0.1"];if(l["whole-number"][i]&&l["whole-number"][i][n]?s=this.state.getTerm(this.state.locale[this.state.opt.lang].ord["1.0.1"]["whole-number"][i][n],!1,0,e):l["last-two-digits"][i.slice(i.length-2)]&&l["last-two-digits"][i.slice(i.length-2)][n]?s=this.state.getTerm(this.state.locale[this.state.opt.lang].ord["1.0.1"]["last-two-digits"][i.slice(i.length-2)][n],!1,0,e):l["last-digit"][i.slice(i.length-1)]&&l["last-digit"][i.slice(i.length-1)][n]&&(s=this.state.getTerm(this.state.locale[this.state.opt.lang].ord["1.0.1"]["last-digit"][i.slice(i.length-1)][n],!1,0,e)),s)break}}else e||(e=void 0),this.state.fun.ordinalizer.init(),s=t/10%10==1||10<t&&t<20?this.suffixes[this.state.opt.lang][e][3]:t%10==1&&t%100!=11?this.suffixes[this.state.opt.lang][e][0]:t%10==2&&t%100!=12?this.suffixes[this.state.opt.lang][e][1]:t%10==3&&t%100!=13?this.suffixes[this.state.opt.lang][e][2]:this.suffixes[this.state.opt.lang][e][3];return i=i+=s},xt.Util.Romanizer=function(){},xt.Util.Romanizer.prototype.format=function(t){var e,i,s,r,n;if(e="",t<6e3)for((r=t.toString().split("")).reverse(),s=i=0,n=r.length,i=0;i<n;i+=1)s=parseInt(r[i],10),e=xt.ROMAN_NUMERALS[i][s]+e;return e},xt.Util.Suffixator=function(t){t||(t=xt.SUFFIX_CHARS),this.slist=t.split(",")},xt.Util.Suffixator.prototype.format=function(t){var e;t+=1;var i="";do{e=t%26==0?26:t%26;i=this.slist[e-1]+i;t=(t-e)/26}while(0!==t);return i},xt.Engine.prototype.processNumber=function(u,m,d,t){var e,g=this;function b(t,e,i,s){s=s||"";var r={};if(e||xt.STATUTE_SUBDIV_STRINGS_REVERSE[d]||(e="var:"+d),e){var n=e.match(/(\s*)([^\s]+)(\s*)/);r.label=n[2],r.origLabel=t,r.labelSuffix=n[3]?n[3]:"",r.plural=0,r.labelVisibility=!1}n=i.match(/^([0-9]*[a-zA-Z]+0*)?([0-9]+(?:[a-zA-Z]*|[-,a-zA-Z]+))$/);return r.value=n?(r.particle=n[1]?n[1]:"",n[2]):(r.particle="",i),r.joiningSuffix=s.replace(/\s*-\s*/,"-"),r}function l(t,e,i){var s=t[i.pos],r=t[e].value,n="\\-"===s.joiningSuffix;r.particle&&r.particle!==s.particle&&(i.collapsible=!1);var a=r.match(/^[0-9]+([-,:a-zA-Z]*)$/),o=s.value.match(/^[0-9]+([-,:a-zA-Z]*)$/);if(r&&a&&o&&!n||(i.collapsible=!1,r&&o||(i.numeric=!1),n&&i.count--),(a&&a[1]||o&&o[1])&&(i.collapsible=!1),void 0===t[e].collapsible){for(var l=e,u=e+i.count;l<u;l++)isNaN(parseInt(t[l].value))&&!t[l].value.match(/^[ivxlcmIVXLCM]+$/)?t[l].collapsible=!1:t[l].collapsible=!0;i.collapsible=t[e].collapsible}var p=i.collapsible;for(l=i.pos,u=i.pos+i.count;l<u;l++)1<i.count&&p&&(t[l].plural=1),t[l].numeric=i.numeric,t[l].collapsible=i.collapsible}function p(t,e,i){"var:"!==i.label.slice(0,4)&&(0===i.pos?("locator"!==d&&"number"!==d||g.getTerm(xt.STATUTE_SUBDIV_STRINGS[i.label])||(t[i.pos].labelVisibility=!0),-1===["locator","number"].indexOf(d)&&xt.STATUTE_SUBDIV_STRINGS[i.label]!==d&&(t[0].labelVisibility=!0)):t[i.pos].labelVisibility=!0)}function i(t){var e=xt.Util.cloneToken(u),i=new xt.Token;if(!g.tmp.just_looking){for(var s=e.decorations.length-1;-1<s;s--)"@quotes"===e.decorations[s][0]&&(i.decorations=i.decorations.concat(e.decorations.slice(s,s+1)),e.decorations=e.decorations.slice(0,s).concat(e.decorations.slice(s+1)));i.strings.prefix=e.strings.prefix,e.strings.prefix="",i.strings.suffix=e.strings.suffix,e.strings.suffix=""}var r=t.length?t[0].label:null;if(t.length){for(var n=0,a=t.length;n<a;n++){var o=t[n],l=xt.Util.cloneToken(e);l.gender=u.gender,r===o.label&&(l.formatter=u.formatter),o.numeric&&(l.successor_prefix=o.successor_prefix),l.strings.suffix=l.strings.suffix+h(o.joiningSuffix),o.styling=l}g.tmp.just_looking||'"'===t[0].value.slice(0,1)&&'"'===t[t.length-1].value.slice(-1)&&(t[0].value=t[0].value.slice(1),t[t.length-1].value=t[t.length-1].value.slice(0,-1),i.decorations.push(["@quotes",!0]))}return i}function h(t){return t.replace("\\-","-")}function o(t,e,i,s){var r=c(t,e);return function(t,e){var i=!0;if("locator"===t){var s;s=e.origLabel?e.origLabel:e.label,i=!!g.getTerm(xt.STATUTE_SUBDIV_STRINGS[s])}return i}(t,e)&&"-"===i&&s&&((r||-1<["locator","issue","volume","edition","number"].indexOf(t))&&((i=g.getTerm("page-range-delimiter"))||(i="–")),"collection-number"===t&&((i=g.getTerm("year-range-delimiter"))||(i="–"))),i}function c(t,e){return"page"===t||"locator"===t&&(-1<["p."].indexOf(e.label)||-1<["p."].indexOf(e.origLabel))}function a(t,e,i){if(!(e<1)&&2===i.count&&t[e-1].particle===t[e].particle)if("-"===t[e-1].joiningSuffix)if(!g.opt["page-range-format"]&&parseInt(t[e-1].value,10)>parseInt(t[e].value,10))t[e-1].joiningSuffix=o(d,t[e],t[e-1].joiningSuffix,!0);else{var s,r=t[e],n=(s=!c(d,r)||isNaN(parseInt(t[e-1].value))||isNaN(parseInt(t[e].value))?((""+t[e-1].value).match(/^([0-9]+|[ivxlcmIVXLCM]+)$/)&&(""+t[e].value).match(/^([0-9]+|[ivxlcmIVXLCM]+)$/)&&(t[e-1].joiningSuffix=g.getTerm("page-range-delimiter")),t[e-1].value+h(t[e-1].joiningSuffix)+t[e].value):(s=t[e-1].particle+t[e-1].value+" - "+t[e].particle+t[e].value,g.fun.page_mangler(s))).match(/^((?:[0-9]*[a-zA-Z]+0*))?([0-9]+)(\s*[^0-9]+\s*)([-,a-zA-Z]?0*)([0-9]+)$/);if(n){var a=n[3];a=o(d,r,a,t[e].numeric),t[e-1].particle=n[1],t[e-1].value=n[2],t[e-1].joiningSuffix=a,t[e].particle=n[4],t[e].value=n[5]}i.count=0}else i.count=1}function s(t){if(u&&-1!==["page","page-first","chapter-number","collection-number","edition","issue","number","number-of-pages","number-of-volumes","volume","locator"].indexOf(d)){for(var e={count:0,label:null,lastHadRangeDelimiter:!1},i=0,s=t.length;i<s;i++){var r=t[i];if(r.collapsible)e.label===r.label&&"-"===r.joiningSuffix?e.count=1:e.label===r.label&&"-"!==r.joiningSuffix?(e.count++,2===e.count&&a(t,i,e)):e.label!==r.label?(e.label=r.label,e.count=1):(e.count=1,e.label=r.label);else{e.count=0,e.label=null;var n=r.numeric;r.joiningSuffix=o(d,r,r.joiningSuffix,n)}}2===e.count&&a(t,t.length-1,e)}}if(u&&this.tmp.shadow_numbers[d]&&this.tmp.shadow_numbers[d].values.length)return s(I=this.tmp.shadow_numbers[d].values),void(this.tmp.shadow_numbers[d].masterStyling=i(I));if(this.tmp.shadow_numbers[d]||(this.tmp.shadow_numbers[d]={values:[]}),m){var r,n,f,_,v=xt.LangPrefsMap[d];if(v){var y=this.opt["cite-lang-prefs"][v][0];e=(e=this.transform.getTextSubField(m,d,"locale-"+y,!0)).name}else e=m[d];if(e&&this.sys.getAbbreviation){var x=this.transform.loadAbbreviation(m.jurisdiction,"number",e);this.transform.abbrevs[x].number&&(this.transform.abbrevs[x].number[e]?e=this.transform.abbrevs[x].number[e]:void 0!==this.transform.abbrevs[x].number[e]&&delete this.transform.abbrevs[x].number[e])}if(void 0!==e&&("string"==typeof e||"number"==typeof e)){"number"==typeof e&&(e=""+e);var I,O=xt.STATUTE_SUBDIV_STRINGS_REVERSE[d];if(!this.tmp.shadow_numbers.values)!function(t){for(var e=0,i=t.length-1;e<i;e++)!t[e].joiningSuffix&&t[e+1].label&&(t[e].joiningSuffix=" ")}(I=function(t,e){e=e||"";var i=[];if(l=(t=function(t,e){var i=(t=t.trim()).match(/^([^ ]+)/);if(i&&!xt.STATUTE_SUBDIV_STRINGS[i[1]]){var s=null;(s="locator"===d?m.label?xt.STATUTE_SUBDIV_STRINGS_REVERSE[m.label]:"p.":xt.STATUTE_SUBDIV_STRINGS_REVERSE[d])&&(t=s+" "+t)}return t}(t)).match(/(;\s+|,\s+|\s*\\*[\-\u2013]+\s*|\s*&\s*)/g)){for(var s=0,r=(u=t.split(/(?:;\s+|,\s+|\s*\\*[\-\u2013]+\s*|\s*&\s*)/)).length-1;s<r;s++)i.push(u[s]),i.push(l[s]);i.push(u[u.length-1]),i=function(t){for(var e=t.length-2;-1<e;e-=2)"-"===t[e]&&t[e-1].match(/^(?:(?:[a-z]|[a-z][a-z]|[a-z][a-z][a-z]|[a-z][a-z][a-z][a-z])\.  *)*[0-9]+[,a-zA-Z]+$/)&&t[e+1].match(/^[,a-zA-Z]+$/)&&(t[e-1]=t.slice(e-1,e+2).join(""),t=t.slice(0,e).concat(t.slice(e+2)));return t}(i)}else i=[t];var n=[],a=e,o="";for(s=0,r=i.length;s<r;s+=2){var l;if(l=i[s].match(/((?:^| )(?:[a-z]|[a-z][a-z]|[a-z][a-z][a-z]|[a-z][a-z][a-z][a-z])(?:\.| ) *)/g)){for(var u,p=(u=i[s].split(/(?:(?:^| )(?:[a-z]|[a-z][a-z]|[a-z][a-z][a-z]|[a-z][a-z][a-z][a-z])(?:\.| ) *)/)).length-1;0<p;p--)!u[p-1]||u[p].match(/^[0-9]+([-;,:a-zA-Z]*)$/)&&u[p-1].match(/^[0-9]+([-;,:a-zA-Z]*)$/)||(u[p-1]=u[p-1]+l[p-1]+u[p],u=u.slice(0,p).concat(u.slice(p+1)),l=l.slice(0,p-1).concat(l.slice(p)));if(0<l.length){var h=l[0].trim();!xt.STATUTE_SUBDIV_STRINGS[h]||!g.getTerm(xt.STATUTE_SUBDIV_STRINGS[h])||-1===["locator","number"].indexOf(d)&&xt.STATUTE_SUBDIV_STRINGS[h]!==d?0===s&&(l=l.slice(1),u[0]=u[0]+" "+h+" "+u[1],u=u.slice(0,1).concat(u.slice(2))):o=h}p=0;for(var c=u.length;p<c;p++)(u[p]||p===u.length-1)&&(f=o===(a=l[p-1]?l[p-1]:a).trim()?"":o,t=u[p]?u[p].trim():"",p===u.length-1?n.push(b(f,a,t,i[s+1])):n.push(b(f,a,t)))}else{var f;f=o===a.trim()?"":o,n.push(b(f,a,i[s],i[s+1]))}}return n}(e,O)),function(t){if(0!==t.length){for(var e=0,i=1,s=1,r=t.length;s<r;s++){var n=t[s-1],a=t[s];n.label===a.label&&n.particle==n.particle?i++:((o=JSON.parse(JSON.stringify(t[e]))).pos=e,o.count=i,o.numeric=!0,l(t,e,o),0!==s&&n.label===a.label||p(t,0,o),e=s,i=1)}var o;(o=JSON.parse(JSON.stringify(t[e]))).pos=e,o.count=i,o.numeric=!0,l(t,e,o),p(t,0,o),t.length&&t[0].numeric&&"number-of-"===d.slice(0,10)&&1<parseInt(m[d],10)&&(t[0].plural=1)}}(I),this.tmp.shadow_numbers[d].values=I;u&&(s(I),this.tmp.shadow_numbers[d].masterStyling=i(I)),r=this.tmp.shadow_numbers,f=I,_=r[n=d],f.length&&(_.numeric=f[0].numeric,_.collapsible=f[0].collapsible,_.plural=f[0].plural,_.label=xt.STATUTE_SUBDIV_STRINGS[f[0].label],"number"===n&&"issue"===_.label&&g.getTerm("number")&&(_.label="number"))}}},xt.Util.outputNumericField=function(t,e,i){t.output.openLevel(t.tmp.shadow_numbers[e].masterStyling);var s,r=t.tmp.shadow_numbers[e].values,n=r.length?r[0].label:null,a=t.tmp.shadow_numbers[e].labelForm;s=a||"short";for(var o=t.tmp.shadow_numbers[e].labelCapitalizeIfFirst,l=t.tmp.shadow_numbers[e].labelDecorations,u=null,p=0,h=r.length;p<h;p++){var c,f=r[p],m="";f.label&&(c="var:"===f.label.slice(0,4)?f.label.slice(4):xt.STATUTE_SUBDIV_STRINGS[f.label])&&(m=f.label===n?t.getTerm(c,a,f.plural):t.getTerm(c,s,f.plural),o&&(m=xt.Output.Formatters["capitalize-first"](t,m)));var d=-1;m&&(d=m.indexOf("%s"));var g,b=xt.Util.cloneToken(f.styling);if(b.formatter=f.styling.formatter,b.type=f.styling.type,b.num=f.styling.num,b.gender=f.styling.gender,0<d&&d<m.length-2)b.strings.prefix+=m.slice(0,d),b.strings.suffix=m.slice(d+2)+b.strings.suffix;else if(f.labelVisibility)if(m||(m=f.label,c=f.label),0<d){var _=new xt.Token;_.decorations=l,t.output.append(m.slice(0,d),_)}else d!==m.length-2&&-1!==d||t.output.append(m+f.labelSuffix,"empty");if(f.collapsible)void 0===(g=f.value.match(/^[1-9][0-9]*$/)?new xt.NumericBlob(f.particle,parseInt(f.value,10),b,i):new xt.NumericBlob(f.particle,f.value,b,i)).gender&&(g.gender=t.locale[t.opt.lang]["noun-genders"][e]),t.output.append(g,"literal");else t.output.append(f.particle+f.value,b);if(0===d&&d<m.length-2&&(null===u&&(u=c),c!==u||p===r.length-1)){var v=new xt.Token;v.decorations=l,t.output.append(m.slice(d+2),v)}u=c,t.tmp.term_predecessor=!0}t.output.closeLevel()},(t.exports=xt).Util.PageRangeMangler={},xt.Util.PageRangeMangler.getFunction=function(i,s){var e,l,u,n,r,a,o,p,h,c,f,m,d,g,b,_,t,v=i.getTerm(s+"-range-delimiter");e=/([0-9]*[a-zA-Z]+0*)?([0-9]+)\s*(?:\u2013|-)\s*([0-9]*[a-zA-Z]+0*)?([0-9]+)/,n=function(t){for(u=t.length,l=1;l<u;l+=2)"object"==typeof t[l]&&(t[l]=t[l].join(""));var e=t.join("");return e=e.replace(/([^\\])\-/g,"$1"+i.getTerm(s+"-range-delimiter"))},r=function(t){var e,i,s,r="\\s+\\-\\s+",n=new RegExp("([^\\\\])[-"+("-"===v?"":v)+"\\u2013]","g");t=t.replace(n,"$1 - ").replace(/\s+-\s+/g," - ");var a=new RegExp("((?:[0-9]*[a-zA-Z]+0*)?[0-9]+"+r+"(?:[0-9]*[a-zA-Z]+0*)?[0-9]+)","g"),o=new RegExp("(?:[0-9]*[a-zA-Z]+0*)?[0-9]+"+r+"(?:[0-9]*[a-zA-Z]+0*)?[0-9]+");if(e=t.match(a),0===(i=t.split(o)).length)s=e;else for(s=[i[0]],l=1,u=i.length;l<u;l+=1)s.push(e[l-1].replace(/\s*\-\s*/g,"-")),s.push(i[l]);return s},a=function(t){for(c=r(t=""+t),u=c.length,l=1;l<u;l+=2)(f=c[l].match(e))&&(f[3]&&f[1]!==f[3]||(f[4].length<f[2].length&&(f[4]=f[2].slice(0,f[2].length-f[4].length)+f[4]),parseInt(f[2],10)<parseInt(f[4],10)&&(f[3]=v+(f[1]?f[1]:""),c[l]=f.slice(1)))),"string"==typeof c[l]&&(c[l]=c[l].replace(/\-/g,v));return c},o=function(t,e,i){u=t.length;for(var s=1,r=t.length;s<r;s+=2)t[s][3]=p(t[s][1],t[s][3],e,i),t[s][2].slice(1)===t[s][0]&&(t[s][2]=v);return n(t)},p=function(t,e,i,s){if(i||(i=0),m=(""+t).split(""),d=(""+e).split(""),(g=d.slice()).reverse(),m.length===d.length)for(var r=0,n=m.length;r<n;r+=1){if(!(m[r]===d[r]&&g.length>i)){if(i&&s&&3===g.length){var a=m.slice(0,r);a.reverse(),g=g.concat(a)}break}g.pop()}return g.reverse(),g.join("")},h=function(t){for(u=t.length,l=1;l<u;l+=2)"object"==typeof t[l]&&(f=t[l],b=parseInt(f[1],10),_=parseInt(f[3],10),100<b&&b%100&&parseInt(b/100,10)===parseInt(_/100,10)?f[3]=""+_%100:1e4<=b&&(f[3]=""+_%1e3)),f[2].slice(1)===f[0]&&(f[2]=v);return n(t)};var y=function(t,e,i,s){return e(a(t=""+t),i,s)};return i.opt[s+"-range-format"]?"expanded"===i.opt[s+"-range-format"]?t=function(t){return y(t,n)}:"minimal"===i.opt[s+"-range-format"]?t=function(t){return y(t,o)}:"minimal-two"===i.opt[s+"-range-format"]?t=function(t,e){return y(t,o,2,e)}:"chicago"===i.opt[s+"-range-format"]&&(t=function(t){return y(t,h)}):t=function(t){return y(t,n)},t},(t.exports=xt).Util.FlipFlopper=function(x){this.processTags=function(t){var e=t.blobs,i=!1;" "!==e.slice(0,1)||e.match(/^\s+[\'\"]/)||(i=!0);var s=new RegExp("("+xt.ROMANESQUE_REGEXP.source+")’("+xt.ROMANESQUE_REGEXP.source+")","g"),r=function(t){var e=[],i=(t=(t=t.replace(/(<span)\s+(style=\"font-variant:)\s*(small-caps);?\"[^>]*(>)/g,'$1 $2$3;"$4')).replace(/(<span)\s+(class=\"no(?:case|decor)\")[^>]*(>)/g,"$1 $2$3")).match(T.matchAll);if(!i)return{tags:[],strings:[t],forcedSpaces:[]};for(var s=t.split(T.splitAll),r=0,n=i.length-1;r<n;r++)O[i[r]]&&(""===s[r+1]&&-1<['"',"'"].indexOf(i[r+1])?(i[r+1]=" "+i[r+1],e.push(!0)):e.push(!1));return{tags:i,strings:s,forcedSpaces:e}}(e=" "+e.replace(s,"$1'$2"));if(0===r.tags.length)return;for(var n=!1,a=0,o=r.tags.length;a<o;a++){var l=r.tags[a],e=r.strings[a+1];if(E(l,e))r.strings[a+1]=" '"===l?" ’"+r.strings[a+1]:"’"+r.strings[a+1],r.tags[a]="";else{for(var u;c=a,_=b=g=d=m=f=void 0,u=(h=l).match(T.open)?(g=h,b=c,!(_=I[I.length-1])||g.match(_.opener)?(I.push({type:A[g].type,opener:A[g].opener,closer:A[g].closer,pos:b}),!1):(I.pop(),I.push({type:A[g].type,opener:A[g].opener,closer:A[g].closer,pos:b}),{fixtag:_.pos})):(f=h,m=c,(d=I[I.length-1])&&f===d.closer?(I.pop(),"nocase"===d.type&&{nocase:{open:d.pos,close:m}}):d?{fixtag:d.pos}:{fixtag:m});){if(!(-1<Object.keys(u).indexOf("fixtag"))){if(u.nocase){r.tags[u.nocase.open]="",r.tags[u.nocase.close]="";break}break}if(l.match(T.close)&&"'"===l)r.strings[a+1]="’"+r.strings[a+1],r.tags[a]="";else{var p=r.tags[u.fixtag];r.forcedSpaces[u.fixtag-1]&&(p=p.slice(1)),r.strings[u.fixtag+1]=p+r.strings[u.fixtag+1],r.tags[u.fixtag]=""}if(!(0<I.length))break;I.pop()}u&&(u.fixtag||0===u.fixtag)&&(r.strings[a+1]=r.tags[a]+r.strings[a+1],r.tags[a]="")}}var h,c,f,m,d,g,b,_;for(var a=I.length-1;-1<a;a--){var v=I[a].pos,l=r.tags[v];r.strings[v+1]=" '"===l||"'"===l?" ’"+r.strings[v+1]:r.tags[v]+r.strings[v+1],r.tags[v]="",I.pop()}for(var a=r.tags.length-1;-1<a;a--)r.tags[a]||(r.tags=r.tags.slice(0,a).concat(r.tags.slice(a+1)),r.strings[a]=r.strings[a]+r.strings[a+1],r.strings=r.strings.slice(0,a+1).concat(r.strings.slice(a+2)));for(var a=0,o=r.tags.length;a<o;a++){var l=r.tags[a],y=r.forcedSpaces[a-1];-1<[' "'," '",'("',"('"].indexOf(l)&&(n||(S(l),n=!0),y||(r.strings[a]+=l.slice(0,1)))}!function(t,e,i){var f=!0,s=new N(t);t.blobs=[];var r=new function(t){this.stack=[t],this.latest=t,this.addStyling=function(t,e,i){if(f&&(" "===t.slice(0,1)&&(t=t.slice(1))," "===t.slice(0,1)&&(t=t.slice(1)),f=!1),this.latest=this.stack[this.stack.length-1],e){if("string"==typeof this.latest.blobs){var s=new xt.Blob;s.blobs=this.latest.blobs,s.alldecor=this.latest.alldecor.slice(),this.latest.blobs=[s]}var r=new xt.Token,n=new xt.Blob(null,r);if(n.alldecor=this.latest.alldecor.slice(),"@class"===e[0]&&"nodecor"===e[1]){for(var a=[],o={},l=[x[x.tmp.area].opt.layout_decorations].concat(n.alldecor),u=l.length-1;-1<u;u--){var p=l[u];if(p)for(var h=p.length-1;-1<h;h--){var c=p[h];-1<["@font-weight","@font-style","@font-variant"].indexOf(c[0])&&!o[c[0]]&&("normal"!==e[1]&&(n.decorations.push([c[0],"normal"]),a.push([c[0],"normal"])),o[c[0]]=!0)}}n.alldecor.push(a)}else n.decorations.push(e),n.alldecor.push([e]);if(this.latest.blobs.push(n),this.stack.push(n),this.latest=n,t){var r=new xt.Token,n=new xt.Blob(null,r);n.blobs=t,n.alldecor=this.latest.alldecor.slice(),this.latest.blobs.push(n)}}else if(t){var s=new xt.Blob;s.blobs=t,s.alldecor=this.latest.alldecor.slice(),this.latest.blobs.push(s)}},this.popStyling=function(){this.stack.pop()}}(t);if(e.strings.length){var n=e.strings[0];i&&(n=" "+n),r.addStyling(n)}for(var a=0,o=e.tags.length;a<o;a++){var l=e.tags[a],n=e.strings[a+1];l.match(T.open)?(s.set(l),r.addStyling(n,s.pair())):(s.pop(),r.popStyling(),r.addStyling(n))}}(t,r,i)};var I=[],O={'<span class="nocase">':{type:"nocase",opener:'<span class="nocase">',closer:"</span>",attr:null,outer:null,flipflop:null},'<span class="nodecor">':{type:"nodecor",opener:'<span class="nodecor">',closer:"</span>",attr:"@class",outer:"nodecor",flipflop:{nodecor:"nodecor"}},'<span style="font-variant:small-caps;">':{type:"tag",opener:'<span style="font-variant:small-caps;">',closer:"</span>",attr:"@font-variant",outer:"small-caps",flipflop:{"small-caps":"normal",normal:"small-caps"}},"<sc>":{type:"tag",opener:"<sc>",closer:"</sc>",attr:"@font-variant",outer:"small-caps",flipflop:{"small-caps":"normal",normal:"small-caps"}},"<i>":{type:"tag",opener:"<i>",closer:"</i>",attr:"@font-style",outer:"italic",flipflop:{italic:"normal",normal:"italic"}},"<b>":{type:"tag",opener:"<b>",closer:"</b>",attr:"@font-weight",outer:"bold",flipflop:{bold:"normal",normal:"bold"}},"<sup>":{type:"tag",opener:"<sup>",closer:"</sup>",attr:"@vertical-align",outer:"sup",flipflop:{sub:"sup",sup:"sup"}},"<sub>":{type:"tag",opener:"<sub>",closer:"</sub>",attr:"@vertical-align",outer:"sub",flipflop:{sup:"sub",sub:"sub"}},' "':{type:"quote",opener:' "',closer:'"',attr:"@quotes",outer:"true",flipflop:{true:"inner",inner:"true",false:"true"}}," '":{type:"quote",opener:" '",closer:"'",attr:"@quotes",outer:"inner",flipflop:{true:"inner",inner:"true",false:"true"}}};O['("']=O[' "'],O["('"]=O[" '"];var t=x.getTerm("open-quote"),e=x.getTerm("close-quote"),i=x.getTerm("open-inner-quote"),s=x.getTerm("close-inner-quote");t&&e&&-1===[' "'," '",'"',"'"].indexOf(t)&&(O[t]=JSON.parse(JSON.stringify(O[' "'])),O[t].opener=t,O[t].closer=e),i&&s&&-1===[' "'," '",'"',"'"].indexOf(i)&&(O[i]=JSON.parse(JSON.stringify(O[" '"])),O[i].opener=i,O[i].closer=s);(function(){for(var t={},e=Object.keys(O),i=0,s=e.length;i<s;i++){var r=e[i];"quote"===O[r].type&&(t[O[r].closer]=O[r])}})(),function(){for(var t={},e=Object.keys(O),i=0,s=e.length;i<s;i++){var r=e[i];if("nocase"!==O[r].type){var n=O[r].attr,a=O[r].outer,o=O[r].flipflop[O[r].outer];t[n+"/"+a]=O[r],t[n+"/"+o]=O[r]}}}();function S(t){O[t].outer="true",O[{" '":' "',' "':" '",'("':"('","('":'("'}[t]].outer="inner"}function n(t){for(var e=[],i=Object.keys(O),s=0,r=i.length;s<r;s++){var n=i[s];"quote"===O[t].type&&O[t]||e.push(n)}var a=O[t];return a.opener=new RegExp("^(?:"+e.map(function(t){return t.replace("(","\\(")}).join("|")+")"),a}var A=function(){for(var t={},e=Object.keys(O),i=0,s=e.length;i<s;i++){var r=e[i];t[r]=n(r)}return t}(),T=function(){var t=[],e=[],i={};for(var s in A)t.push(s),i[A[s].closer]=!0;for(var r=Object.keys(i),n=0,a=r.length;n<a;n++){var o=r[n];e.push(o)}var l=t.concat(e).map(function(t){return t.replace("(","\\(")}).join("|");return{matchAll:new RegExp("((?:"+l+"))","g"),splitAll:new RegExp("(?:"+l+")","g"),open:new RegExp("(^(?:"+t.map(function(t){return t.replace("(","\\(")}).join("|")+")$)"),close:new RegExp("(^(?:"+e.join("|")+")$)")}}();var N=function(l){this.set=function(t){for(var e=O[t].attr,i=null,s=u.length-1;-1<s;s--){var r=u[s];if(r[0]===e){i=r;break}}if(!i){var n=[x[x.tmp.area].opt.layout_decorations].concat(l.alldecor);t:for(var s=n.length-1;-1<s;s--){var a=n[s];if(a)for(var o=a.length-1;-1<o;o--){var r=a[o];if(r[0]===e){i=r;break t}}}}i=i?[e,O[t].flipflop[i[1]]]:[e,O[t].outer];u.push(i)},this.pair=function(){return u[u.length-1]},this.pop=function(){u.pop()};var u=[]};function E(t,e){if("'"===t){if(e&&e.match(/^[^\,\.\?\:\;\ ]/))return!0}else if(" '"===t&&e&&e.match(/^[\ ]/))return!0;return!1}},(t.exports=xt).Output.Formatters=new function(){this.passthrough=function(t,e){return e},this.lowercase=function(t,e){return i({quoteState:null,capitaliseWords:function(t){for(var e=t.split(" "),i=0,s=e.length;i<s;i++){var r=e[i];r&&(e[i]=r.toLowerCase())}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:null},e)},this.uppercase=function(t,e){return i({quoteState:null,capitaliseWords:function(t){for(var e=t.split(" "),i=0,s=e.length;i<s;i++){var r=e[i];r&&(e[i]=r.toUpperCase())}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:null},e)},this.sentence=function(t,e){var n={quoteState:[],capitaliseWords:function(t){for(var e=t.split(" "),i=0,s=e.length;i<s;i++){var r=e[i];r&&(n.isFirst?(e[i]=d(r),n.isFirst=!1):e[i]=r.toLowerCase())}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:!0};return i(n,e)},this.title=function(t,e){var l={quoteState:[],capitaliseWords:function(t,e,i){if(t.trim()){for(var s=t.split(/[ \u00A0]+/),r=f.split(t),s=r.strings,n=0,a=s.length;n<a;n++){var o=s[n];o&&(1<o.length&&!o.toLowerCase().match(l.skipWordsRex)?s[n]=d(s[n]):n===s.length-1&&"-"===i?s[n]=d(s[n]):l.isFirst?s[n]=d(s[n]):l.afterPunct&&(s[n]=d(s[n])),l.afterPunct=!1,l.isFirst=!1,l.lastWordPos={strings:e,words:n})}t=f.join(r)}return t},skipWordsRex:t.locale[t.opt.lang].opts["skip-words-regexp"],tagState:[],afterPunct:!1,isFirst:!0};return i(l,e)},this["capitalize-first"]=function(t,e){var n={quoteState:[],capitaliseWords:function(t){for(var e=t.split(" "),i=0,s=e.length;i<s;i++){var r=e[i];if(r&&n.isFirst){e[i]=d(r),n.isFirst=!1;break}}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:!0};return i(n,e)},this["capitalize-all"]=function(t,e){return i({quoteState:[],capitaliseWords:function(t){for(var e=t.split(" "),i=0,s=e.length;i<s;i++){var r=e[i];r&&(e[i]=d(r))}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:null},e)};var c=new xt.Doppeler('(?:‘|’|“|”| "| \'|"|\'|[-–—/.,;?!:]|\\[|\\]|\\(|\\)|<span style="font-variant: small-caps;">|<span class="no(?:case|decor)">|</span>|</?(?:i|sc|b|sub|sup)>)',function(t){return t.replace(/(<span)\s+(class=\"no(?:case|decor)\")[^>]*(>)/g,"$1 $2$3").replace(/(<span)\s+(style=\"font-variant:)\s*(small-caps);?(\")[^>]*(>)/g,"$1 $2 $3;$4$5")}),f=new xt.Doppeler("(?:[   -​ 　]+)"),m={'<span style="font-variant: small-caps;">':"</span>",'<span class="nocase">':"</span>",'<span class="nodecor">':"</span>"};function d(t,e){var i=t.match(/(^\s*)((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(.*)/);return!i||i[2].match(/^[\u0370-\u03FF]$/)&&!i[3]?t:i[1]+i[2].toUpperCase()+i[3]}function i(n,t){if(!t)return"";n.doppel=c.split(t);var a={' "':{opener:" '",closer:'"'}," '":{opener:' "',closer:"'"},"‘":{opener:"‘",closer:"’"},"“":{opener:"“",closer:"”"}};function e(t,e){var i,s,r=t.match(/(^(?:\u2018|\u2019|\u201C|\u201D|\"|\')|(?: \"| \')$)/);if(r)return i=r[1],s=e,-1<["“","‘",' "'," '"].indexOf(i)?function(t,e){if(0===n.quoteState.length||t===n.quoteState[n.quoteState.length-1].opener)return n.quoteState.push({opener:a[t].opener,closer:a[t].closer,pos:e}),!1;var i=n.quoteState[n.quoteState.length-1].pos;return n.quoteState.pop(),n.quoteState.push({opener:a[t].opener,closer:a[t].closer,positions:e}),i}(i,s):function(t,e){if(!(0<n.quoteState.length&&t===n.quoteState[n.quoteState.length-1].closer))return e;n.quoteState.pop()}(i,s)}n.doppel.strings.length&&n.doppel.strings[0].trim()&&(n.doppel.strings[0]=n.capitaliseWords(n.doppel.strings[0],0,n.doppel.tags[0]));for(var i=0,s=n.doppel.tags.length;i<s;i++){var r=n.doppel.tags[i],o=n.doppel.strings[i+1];if(null!==n.tagState&&(m[r]?n.tagState.push(m[r]):n.tagState.length&&r===n.tagState[n.tagState.length-1]&&n.tagState.pop()),null!==n.afterPunct&&r.match(/[\!\?\:]$/)&&(n.afterPunct=!0),0===n.tagState.length?n.doppel.strings[i+1]=n.capitaliseWords(o,i+1,n.doppel,n.doppel.tags[i+1]):n.doppel.strings[i+1].trim()&&(n.lastWordPos=null),null!==n.quoteState)if((u=e(r,i))||0===u){var l=n.doppel.origStrings[u+1].slice(0,1);n.doppel.strings[u+1]=l+n.doppel.strings[u+1].slice(1),n.lastWordPos=null}n.isFirst&&o.trim()&&(n.isFirst=!1),n.afterPunct&&o.trim()&&(n.afterPunct=!1)}if(n.quoteState)for(i=0,s=n.quoteState.length;i<s;i++){var u;if(void 0!==(u=n.quoteState[i].pos)){l=n.doppel.origStrings[u+1].slice(0,1);n.doppel.strings[u+1]=l+n.doppel.strings[u+1].slice(1)}}if(n.lastWordPos){var p=f.split(n.doppel.strings[n.lastWordPos.strings]),h=d(p.strings[n.lastWordPos.words]);p.strings[n.lastWordPos.words]=h,n.doppel.strings[n.lastWordPos.strings]=f.join(p)}return c.join(n.doppel)}},(t.exports=xt).Output.Formats=function(){},xt.Output.Formats.prototype.html={text_escape:function(t){return t||(t=""),t.replace(/&/g,"&#38;").replace(/</g,"&#60;").replace(/>/g,"&#62;").replace(/\s\s/g,"  ").replace(xt.SUPERSCRIPTS_REGEXP,function(t){return"<sup>"+xt.SUPERSCRIPTS[t]+"</sup>"})},bibstart:'<div class="csl-bib-body">\n',bibend:"</div>","@font-style/italic":"<i>%%STRING%%</i>","@font-style/oblique":"<em>%%STRING%%</em>","@font-style/normal":'<span style="font-style:normal;">%%STRING%%</span>',"@font-variant/small-caps":'<span style="font-variant:small-caps;">%%STRING%%</span>',"@passthrough/true":xt.Output.Formatters.passthrough,"@font-variant/normal":'<span style="font-variant:normal;">%%STRING%%</span>',"@font-weight/bold":"<b>%%STRING%%</b>","@font-weight/normal":'<span style="font-weight:normal;">%%STRING%%</span>',"@font-weight/light":!1,"@text-decoration/none":'<span style="text-decoration:none;">%%STRING%%</span>',"@text-decoration/underline":'<span style="text-decoration:underline;">%%STRING%%</span>',"@vertical-align/sup":"<sup>%%STRING%%</sup>","@vertical-align/sub":"<sub>%%STRING%%</sub>","@vertical-align/baseline":'<span style="baseline">%%STRING%%</span>',"@strip-periods/true":xt.Output.Formatters.passthrough,"@strip-periods/false":xt.Output.Formatters.passthrough,"@quotes/true":function(t,e){return void 0===e?t.getTerm("open-quote"):t.getTerm("open-quote")+e+t.getTerm("close-quote")},"@quotes/inner":function(t,e){return void 0===e?"’":t.getTerm("open-inner-quote")+e+t.getTerm("close-inner-quote")},"@quotes/false":!1,"@cite/entry":function(t,e){return console.log("citation entry"),t.sys.wrapCitationEntry(e,this.item_id,this.locator_txt,this.suffix_txt)},"@bibliography/entry":function(t,e){var i="";return t.sys.embedBibliographyEntry&&(i=t.sys.embedBibliographyEntry(this.item_id)+"\n"),'  <div class="csl-entry">'+e+"</div>\n"+i},"@display/block":function(t,e){return'\n\n    <div class="csl-block">'+e+"</div>\n"},"@display/left-margin":function(t,e){return'\n    <div class="csl-left-margin">'+e+"</div>"},"@display/right-inline":function(t,e){return'<div class="csl-right-inline">'+e+"</div>\n  "},"@display/indent":function(t,e){return'<div class="csl-indent">'+e+"</div>\n  "},"@showid/true":function(t,e,i){if(t.tmp.just_looking||t.tmp.suppress_decorations)return e;if(i)return'<span class="'+t.opt.nodenames[i]+'" cslid="'+i+'">'+e+"</span>";if(this.params&&"string"==typeof e){var s="";if(e){var r=e.match(xt.VARIABLE_WRAPPER_PREPUNCT_REX);s=r[1],e=r[2]}var n="";return e&&-1<xt.SWAPPING_PUNCTUATION.indexOf(e.slice(-1))&&(n=e.slice(-1),e=e.slice(0,-1)),t.sys.variableWrapper(this.params,s,e,n)}return e},"@URL/true":function(t,e){return'<a href="'+e+'">'+e+"</a>"},"@DOI/true":function(t,e){var i=e;return e.match(/^https?:\/\//)||(i="https://doi.org/"+e),'<a href="'+i+'">'+e+"</a>"}},xt.Output.Formats.prototype.text={text_escape:function(t){return t||(t=""),t},bibstart:"",bibend:"","@font-style/italic":!1,"@font-style/oblique":!1,"@font-style/normal":!1,"@font-variant/small-caps":!1,"@passthrough/true":xt.Output.Formatters.passthrough,"@font-variant/normal":!1,"@font-weight/bold":!1,"@font-weight/normal":!1,"@font-weight/light":!1,"@text-decoration/none":!1,"@text-decoration/underline":!1,"@vertical-align/baseline":!1,"@vertical-align/sup":!1,"@vertical-align/sub":!1,"@strip-periods/true":xt.Output.Formatters.passthrough,"@strip-periods/false":xt.Output.Formatters.passthrough,"@quotes/true":function(t,e){return void 0===e?t.getTerm("open-quote"):t.getTerm("open-quote")+e+t.getTerm("close-quote")},"@quotes/inner":function(t,e){return void 0===e?"’":t.getTerm("open-inner-quote")+e+t.getTerm("close-inner-quote")},"@quotes/false":!1,"@cite/entry":function(t,e){return t.sys.wrapCitationEntry(e,this.item_id,this.locator_txt,this.suffix_txt)},"@bibliography/entry":function(t,e){return e+"\n"},"@display/block":function(t,e){return"\n"+e},"@display/left-margin":function(t,e){return e},"@display/right-inline":function(t,e){return e},"@display/indent":function(t,e){return"\n    "+e},"@showid/true":function(t,e,i){return e},"@URL/true":function(t,e){return e},"@DOI/true":function(t,e){return e}},xt.Output.Formats.prototype.rtf={text_escape:function(t){return t||(t=""),t.replace(/([\\{}])/g,"\\$1").replace(xt.SUPERSCRIPTS_REGEXP,function(t){return"\\super "+xt.SUPERSCRIPTS[t]+"\\nosupersub{}"}).replace(/[\u007F-\uFFFF]/g,function(t){return"\\uc0\\u"+t.charCodeAt(0).toString()+"{}"}).split("\t").join("\\tab{}")},"@passthrough/true":xt.Output.Formatters.passthrough,"@font-style/italic":"{\\i{}%%STRING%%}","@font-style/normal":"{\\i0{}%%STRING%%}","@font-style/oblique":"{\\i{}%%STRING%%}","@font-variant/small-caps":"{\\scaps %%STRING%%}","@font-variant/normal":"{\\scaps0{}%%STRING%%}","@font-weight/bold":"{\\b{}%%STRING%%}","@font-weight/normal":"{\\b0{}%%STRING%%}","@font-weight/light":!1,"@text-decoration/none":!1,"@text-decoration/underline":"{\\ul{}%%STRING%%}","@vertical-align/baseline":!1,"@vertical-align/sup":"\\super %%STRING%%\\nosupersub{}","@vertical-align/sub":"\\sub %%STRING%%\\nosupersub{}","@strip-periods/true":xt.Output.Formatters.passthrough,"@strip-periods/false":xt.Output.Formatters.passthrough,"@quotes/true":function(t,e){return void 0===e?xt.Output.Formats.rtf.text_escape(t.getTerm("open-quote")):xt.Output.Formats.rtf.text_escape(t.getTerm("open-quote"))+e+xt.Output.Formats.rtf.text_escape(t.getTerm("close-quote"))},"@quotes/inner":function(t,e){return void 0===e?xt.Output.Formats.rtf.text_escape("’"):xt.Output.Formats.rtf.text_escape(t.getTerm("open-inner-quote"))+e+xt.Output.Formats.rtf.text_escape(t.getTerm("close-inner-quote"))},"@quotes/false":!1,bibstart:"{\\rtf ",bibend:"}","@display/block":"\\line{}%%STRING%%\\line\r\n","@cite/entry":function(t,e){return t.sys.wrapCitationEntry(e,this.item_id,this.locator_txt,this.suffix_txt)},"@bibliography/entry":function(t,e){return e},"@display/left-margin":function(t,e){return e+"\\tab "},"@display/right-inline":function(t,e){return e+"\r\n"},"@display/indent":function(t,e){return"\n\\tab "+e+"\\line\r\n"},"@showid/true":function(t,e,i){if(t.tmp.just_looking||t.tmp.suppress_decorations)return e;var s="";if(e){var r=e.match(xt.VARIABLE_WRAPPER_PREPUNCT_REX);s=r[1],e=r[2]}var n="";return e&&-1<xt.SWAPPING_PUNCTUATION.indexOf(e.slice(-1))&&(n=e.slice(-1),e=e.slice(0,-1)),t.sys.variableWrapper(this.params,s,e,n)},"@URL/true":function(t,e){return e},"@DOI/true":function(t,e){return e}},xt.Output.Formats=new xt.Output.Formats,(t.exports=xt).Registry=function(t){this.debug=!1,this.state=t,this.registry={},this.reflist=[],this.refhash={},this.namereg=new xt.Registry.NameReg(t),this.citationreg=new xt.Registry.CitationReg(t),this.authorstrings={},this.mylist=[],this.myhash={},this.deletes=[],this.inserts=[],this.uncited={},this.refreshes={},this.akeys={},this.oldseq={},this.return_data={},this.ambigcites={},this.ambigresets={},this.sorter=new xt.Registry.Comparifier(t,"bibliography_sort"),this.getSortedIds=function(){for(var t=[],e=0,i=this.reflist.length;e<i;e+=1)t.push(""+this.reflist[e].id);return t},this.getSortedRegistryItems=function(){for(var t=[],e=0,i=this.reflist.length;e<i;e+=1)t.push(this.reflist[e]);return t}},xt.Registry.prototype.init=function(t,e){if(this.oldseq={},e){this.uncited={};for(var i=0,s=t.length;i<s;i+=1)this.myhash[t[i]]||this.mylist.push(""+t[i]),this.uncited[t[i]]=!0,this.myhash[t[i]]=!0}else{for(var r in this.uncited)t.push(r);var n={};for(i=t.length-1;-1<i;i+=-1)n[t[i]]?t=t.slice(0,i).concat(t.slice(i+1)):n[t[i]]=!0;this.mylist=t,this.myhash=n}this.refreshes={},this.touched={},this.ambigsTouched={},this.ambigresets={}},xt.Registry.prototype.dopurge=function(t){for(var e=this.mylist.length-1;-1<e;e+=-1)this.citationreg.citationsByItemId&&(this.citationreg.citationsByItemId[this.mylist[e]]||t[this.mylist[e]]||(delete this.myhash[this.mylist[e]],this.mylist=this.mylist.slice(0,e).concat(this.mylist.slice(e+1))));this.dodeletes(this.myhash)},xt.Registry.prototype.dodeletes=function(t){var e,i,s,r,n,a,o;if("string"==typeof t){var l=t;(t={})[l]=!0}for(var l in this.registry)if(!t[l]){if(this.uncited[l])continue;for(n in this.namereg.delitems(l))this.refreshes[n]=!0;for(e=this.registry[l].ambig,-1<(a=this.ambigcites[e].indexOf(l))&&(r=this.ambigcites[e].slice(),this.ambigcites[e]=r.slice(0,a).concat(r.slice(a+1,r.length)),this.ambigresets[e]=this.ambigcites[e].length),s=this.ambigcites[e].length,i=0;i<s;i+=1)o=""+this.ambigcites[e][i],this.refreshes[o]=!0;if(this.registry[l].siblings)if(1==this.registry[l].siblings.length){var u=this.registry[l].siblings[0];this.registry[u].master=!0,this.registry[u].siblings.pop(),this.registry[u].parallel=!1}else if(1<this.registry[l].siblings.length){var p=[l];if(this.registry[l].master){var h=this.registry[l].siblings[0],c=this.registry[h];c.master=!0,c.parallel=!1,p.push(h);for(var f=0,m=this.registry[l].siblings.length;f<m;f+=1)this.registry[this.registry[l].siblings[f]].parallel=h}var d=[];for(f=this.registry[l].siblings.length-1;-1<f;f+=-1){var g=this.registry[l].siblings.pop();-1===p.indexOf(g)&&d.push(g)}for(f=d.length-1;-1<f;f+=-1)this.registry[l].siblings.push(d[f])}for(var b=this.reflist.length-1;-1<b;b--)this.reflist[b].id===l&&(this.reflist=this.reflist.slice(0,b).concat(this.reflist.slice(b+1)));delete this.registry[l],delete this.refhash[l],this.return_data.bibchange=!0}},xt.Registry.prototype.doinserts=function(t){var e,i,s,r,n;"string"==typeof t&&(t=[t]);for(var a=0,o=t.length;a<o;a+=1)e=t[a],this.registry[e]||(i=this.state.retrieveItem(e),s=xt.getAmbiguousCite.call(this.state,i),this.ambigsTouched[s]=!0,i.legislation_id||(this.akeys[s]=!0),r={id:""+e,seq:0,offset:0,sortkeys:!1,ambig:!1,rendered:!1,disambig:!1,ref:i,newItem:!0},this.registry[e]=r,this.citationreg.citationsByItemId&&this.citationreg.citationsByItemId[e]&&(this.registry[e]["first-reference-note-number"]=this.citationreg.citationsByItemId[e][0].properties.noteIndex),n=xt.getAmbigConfig.call(this.state),this.registerAmbigToken(s,e,n),this.touched[e]=!0,this.return_data.bibchange=!0)},xt.Registry.prototype.rebuildlist=function(t){var e,i,s,r;if(t)for(this.reflist=[],e=this.mylist.length,i=0;i<e;i+=1)s=this.mylist[i],r=this.registry[s],this.reflist.push(r),this.oldseq[s]=this.registry[s].seq,this.registry[s].seq=i+1;else for(this.reflist_inserts=[],e=this.mylist.length,i=0;i<e;i+=1)s=this.mylist[i],(r=this.registry[s]).newItem&&this.reflist_inserts.push(r),this.oldseq[s]=this.registry[s].seq,this.registry[s].seq=i+1},xt.Registry.prototype.dorefreshes=function(){var t;for(var e in this.refreshes)if(t=this.registry[e]){t.sortkeys=void 0,n=this.state.retrieveItem(e);var i=t.ambig;for(var s in void 0===i&&(this.state.tmp.disambig_settings=!1,i=xt.getAmbiguousCite.call(this.state,n),a=xt.getAmbigConfig.call(this.state),this.registerAmbigToken(i,e,a)),this.ambigresets)if(1===this.ambigresets[s]){var r=this.ambigcites[i][0],n=this.state.retrieveItem(r);this.registry[r].disambig=new xt.AmbigConfig,this.state.tmp.disambig_settings=!1;i=xt.getAmbiguousCite.call(this.state,n);var a=xt.getAmbigConfig.call(this.state);this.registerAmbigToken(i,r,a)}this.state.tmp.taintedItemIDs[e]=!0,this.ambigsTouched[i]=!0,n.legislation_id||(this.akeys[i]=!0),this.touched[e]=!0}},xt.Registry.prototype.setdisambigs=function(){var t;for(t in this.ambigsTouched)this.state.disambiguate.run(t);this.ambigsTouched={},this.akeys={}},xt.Registry.prototype.renumber=function(){var t,e,i;for(t=this.reflist.length,e=0;e<t;e+=1)(i=this.reflist[e]).seq=e+1,this.state.opt.update_mode===xt.NUMERIC&&i.seq!=this.oldseq[i.id]&&(this.state.tmp.taintedItemIDs[i.id]=!0),this.state.opt.bib_mode===xt.NUMERIC&&i.seq!=this.oldseq[i.id]&&(this.return_data.bibchange=!0);this.state.opt.citation_number_sort_direction===xt.DESCENDING&&this.state.opt.citation_number_sort_used&&this.reflist.reverse()},xt.Registry.prototype.setsortkeys=function(){for(var t=0,e=this.mylist.length;t<e;t+=1){var i=this.mylist[t];(this.touched[i]||this.state.tmp.taintedItemIDs[i]||!this.registry[i].sortkeys)&&(this.registry[i].sortkeys=xt.getSortKeys.call(this.state,this.state.retrieveItem(i),"bibliography_sort"))}},xt.Registry.prototype._insertItem=function(t,e){return e.splice(this._locationOf(t,e)+1,0,t),e},xt.Registry.prototype._locationOf=function(t,e,i,s){if(0===e.length)return-1;var r=(i=i||0)+(s=s||e.length)>>1,n=this.sorter.compareKeys(t,e[r]);if(s-i<=1)return-1==n?r-1:r;switch(n){case-1:return this._locationOf(t,e,i,r);case 0:return r;case 1:return this._locationOf(t,e,r,s)}},xt.Registry.prototype.sorttokens=function(t){var e,i,s;if(!t){for(this.reflist_inserts=[],e=this.mylist.length,s=0;s<e;s+=1)i=this.mylist[s],(o=this.registry[i]).newItem&&this.reflist_inserts.push(o);for(var r in this.state.tmp.taintedItemIDs)if(this.registry[r]&&!this.registry[r].newItem)for(var n=this.reflist.length-1;-1<n;n--)this.reflist[n].id===r&&(this.reflist_inserts.push(this.reflist[n]),this.reflist=this.reflist.slice(0,n).concat(this.reflist.slice(n+1)));n=0;for(var a=this.reflist_inserts.length;n<a;n++){var o;delete(o=this.reflist_inserts[n]).newItem,this.reflist=this._insertItem(o,this.reflist)}for(s=0;s<e;s+=1)i=this.mylist[s],o=this.registry[i],this.registry[i].seq=s+1}},xt.Registry.Comparifier=function(t,e){var s,r,n,i,a=xt.getSortCompare(t.opt["default-locale-sort"]);s=t[e].opt.sort_directions,this.compareKeys=function(t,e){for(r=t.sortkeys?t.sortkeys.length:0,n=0;n<r;n+=1){var i=0;if(0<(i=t.sortkeys[n]===e.sortkeys[n]?0:void 0===t.sortkeys[n]?s[n][1]:void 0===e.sortkeys[n]?s[n][0]:a(t.sortkeys[n],e.sortkeys[n])))return s[n][1];if(i<0)return s[n][0]}return t.seq>e.seq?1:t.seq<e.seq?-1:0},i=this.compareKeys,this.compareCompositeKeys=function(t,e){return i(t[1],e[1])}},xt.Registry.prototype.compareRegistryTokens=function(t,e){return t.seq>e.seq?1:t.seq<e.seq?-1:0},xt.Registry.prototype.registerAmbigToken=function(t,e,i){if(this.registry[e]&&this.registry[e].disambig&&this.registry[e].disambig.names)for(var s=0,r=i.names.length;s<r;s+=1){if(i.names[s]!==this.registry[e].disambig.names[s])this.state.tmp.taintedItemIDs[e]=!0;else if(i.givens[s])for(var n=0,a=i.givens[s].length;n<a;n+=1){i.givens[s][n]!==this.registry[e].disambig.givens[s][n]&&(this.state.tmp.taintedItemIDs[e]=!0)}}this.ambigcites[t]||(this.ambigcites[t]=[]),-1===this.ambigcites[t].indexOf(""+e)&&this.ambigcites[t].push(""+e),this.registry[e].ambig=t,this.registry[e].disambig=xt.cloneAmbigConfig(i)},xt.getSortKeys=function(t,e){var i,s,r,n,a,o;for(i=this.tmp.area,s=this.tmp.root,r=this.tmp.extension,n=xt.Util.Sort.strip_prepositions,this.tmp.area=e,this.tmp.root=-1<e.indexOf("_")?e.slice(0,-5):e,this.tmp.extension="_sort",this.tmp.disambig_override=!0,this.tmp.disambig_request=!1,this.parallel.use_parallels=(!0===this.parallel.use_parallels||null===this.parallel.use_parallels)&&null,this.tmp.suppress_decorations=!0,xt.getCite.call(this,t),this.tmp.suppress_decorations=!1,this.parallel.use_parallels=null===this.parallel.use_parallels,this.tmp.disambig_override=!1,a=this[e].keys.length,o=0;o<a;o+=1)this[e].keys[o]=n(this[e].keys[o]);return this.tmp.area=i,this.tmp.root=s,this.tmp.extension=r,this[e].keys},(t.exports=xt).Registry.NameReg=function(u){var p,h,c,l,f,m,r,d,t,e,i,g;this.state=u,this.namereg={},this.nameind={},this.nameindpkeys={},this.itemkeyreg={},r=function(t){return t||(t=""),t.replace(/\./g," ").replace(/\s+/g," ").replace(/\s+$/,"")},d=function(t,e,i){p=r(i.family);var s=(c=r(i.given)).match(/[,\!]* ([^,]+)$/);s&&s[1]===s[1].toLowerCase()&&(c=c.replace(/[,\!]* [^,]+$/,"")),h=xt.Util.Names.initializeWith(t,c,"%s"),"by-cite"===t.citation.opt["givenname-disambiguation-rule"]&&(p=""+e+p)},t=function(t,e,i,s,r,n){var a;if("bibliography"===u.tmp.area.slice(0,12)&&!r)return"string"==typeof n?1:2;e=u.nameOutput.getName(e,"locale-translit",!0).name,d(this.state,""+t,e),a=2,l=u.opt["disambiguate-add-givenname"];var o=f=u.citation.opt["givenname-disambiguation-rule"];return"by-cite"===f&&(f="all-names"),"short"===r?a=0:"string"==typeof n&&(a=1),void 0===this.namereg[p]||void 0===this.namereg[p].ikey[h]?a:"by-cite"===o&&a<=s?s:l?"string"==typeof f&&"primary-name"===f.slice(0,12)&&0<i?a:(f&&"all-names"!==f&&"primary-name"!==f?"all-names-with-initials"!==f&&"primary-name-with-initials"!==f||(a=1<this.namereg[p].count?1:0):(1<this.namereg[p].count&&(a=1),(this.namereg[p].ikey&&1<this.namereg[p].ikey[h].count||1<this.namereg[p].count&&"string"!=typeof n)&&(a=2)),u.registry.registry[t]?a:"short"==r?0:"string"==typeof n?1:void 0):a},e=function(t){var e,i,s,r,n;"string"!=typeof t&&"number"!=typeof t||(t=[""+t]);for(i=t.length,e=0;e<i;e+=1)if(r=""+t[e],this.nameind[r]){for(n in this.nameind[r])if(this.nameind[r].hasOwnProperty(n)){var a=n.split("::");if(p=a[0],h=a[1],c=a[2],void 0===this.namereg[p])continue;if(m=this.namereg[p].items,c&&this.namereg[p].ikey[h]&&this.namereg[p].ikey[h].skey[c]&&(-1<(s=(g=this.namereg[p].ikey[h].skey[c].items).indexOf(""+r))&&(this.namereg[p].ikey[h].skey[c].items=g.slice(0,s).concat(g.slice([s+1]))),0===this.namereg[p].ikey[h].skey[c].items.length&&(delete this.namereg[p].ikey[h].skey[c],this.namereg[p].ikey[h].count+=-1,this.namereg[p].ikey[h].count<2)))for(var o=0,l=this.namereg[p].ikey[h].items.length;o<l;o+=1)u.tmp.taintedItemIDs[this.namereg[p].ikey[h].items[o]]=!0;if(h&&this.namereg[p].ikey[h]&&(-1<(s=this.namereg[p].ikey[h].items.indexOf(""+r))&&(m=this.namereg[p].ikey[h].items.slice(),this.namereg[p].ikey[h].items=m.slice(0,s).concat(m.slice([s+1]))),0===this.namereg[p].ikey[h].items.length&&(delete this.namereg[p].ikey[h],this.namereg[p].count+=-1,this.namereg[p].count<2)))for(o=0,l=this.namereg[p].items.length;o<l;o+=1)u.tmp.taintedItemIDs[this.namereg[p].items[o]]=!0;p&&(-1<(s=this.namereg[p].items.indexOf(""+r))&&(m=this.namereg[p].items.slice(),this.namereg[p].items=m.slice(0,s).concat(m.slice([s+1],m.length))),this.namereg[p].items.length<2&&delete this.namereg[p]),delete this.nameind[r][n]}delete this.nameind[r],delete this.nameindpkeys[r]}return{}},i=function(t,e,i){if(e=u.nameOutput.getName(e,"locale-translit",!0).name,!u.citation.opt["givenname-disambiguation-rule"]||"primary-"!==u.citation.opt["givenname-disambiguation-rule"].slice(0,8)||0===i){if(d(this.state,""+t,e),p&&(void 0===this.namereg[p]?(this.namereg[p]={},this.namereg[p].count=0,this.namereg[p].ikey={},this.namereg[p].items=[t]):-1===this.namereg[p].items.indexOf(t)&&this.namereg[p].items.push(t)),p&&h)if(void 0===this.namereg[p].ikey[h]){if(this.namereg[p].ikey[h]={},this.namereg[p].ikey[h].count=0,this.namereg[p].ikey[h].skey={},this.namereg[p].ikey[h].items=[t],this.namereg[p].count+=1,2===this.namereg[p].count)for(var s=0,r=this.namereg[p].items.length;s<r;s+=1)u.tmp.taintedItemIDs[this.namereg[p].items[s]]=!0}else-1===this.namereg[p].ikey[h].items.indexOf(t)&&this.namereg[p].ikey[h].items.push(t);if(p&&h&&c)if(void 0===this.namereg[p].ikey[h].skey[c]){if(this.namereg[p].ikey[h].skey[c]={},this.namereg[p].ikey[h].skey[c].items=[t],this.namereg[p].ikey[h].count+=1,2===this.namereg[p].ikey[h].count)for(s=0,r=this.namereg[p].ikey[h].items.length;s<r;s+=1)u.tmp.taintedItemIDs[this.namereg[p].ikey[h].items[s]]=!0}else-1===this.namereg[p].ikey[h].skey[c].items.indexOf(t)&&this.namereg[p].ikey[h].skey[c].items.push(t);void 0===this.nameind[t]&&(this.nameind[t]={},this.nameindpkeys[t]={}),p&&(this.nameind[t][p+"::"+h+"::"+c]=!0,this.nameindpkeys[t][p]=this.namereg[p])}},this.addname=i,this.delitems=e,this.evalname=t},(t.exports=xt).Registry.CitationReg=function(t){this.citationById={},this.citationByIndex=[]},(t.exports=xt).Disambiguation=function(t){this.state=t,this.sys=this.state.sys,this.registry=t.registry.registry,this.ambigcites=t.registry.ambigcites,this.configModes(),this.debug=!1},xt.Disambiguation.prototype.run=function(t){this.modes.length&&(this.akey=t,this.initVars(t)&&this.runDisambig())},xt.Disambiguation.prototype.runDisambig=function(){var t;for(this.initGivens=!0;this.lists.length;){for(this.gnameset=0,this.gname=0,this.clashes=[1,0];this.lists[0][1].length;)this.listpos=0,this.base||(this.base=this.lists[0][0]),t=this.incrementDisambig(),this.scanItems(this.lists[0]),this.evalScan(t);this.lists=this.lists.slice(1)}},xt.Disambiguation.prototype.scanItems=function(t){var e;this.Item=t[1][0],this.ItemCite=xt.getAmbiguousCite.call(this.state,this.Item,this.base,!0),this.scanlist=t[1],this.partners=[],this.partners.push(this.Item),this.nonpartners=[];for(var i=0,s=1,r=t[1].length;s<r;s+=1){e=t[1][s];var n=xt.getAmbiguousCite.call(this.state,e,this.base,!0);this.ItemCite===n?(i+=1,this.partners.push(e)):this.nonpartners.push(e)}this.clashes[0]=this.clashes[1],this.clashes[1]=i},xt.Disambiguation.prototype.evalScan=function(t){this[this.modes[this.modeindex]](t),t&&(this.modeindex<this.modes.length-1?this.modeindex+=1:this.lists[this.listpos+1]=[this.base,[]])},xt.Disambiguation.prototype.disNames=function(t){if(0===this.clashes[1]&&1===this.nonpartners.length)this.captureStepToBase(),this.state.registry.registerAmbigToken(this.akey,""+this.nonpartners[0].id,this.betterbase),this.state.registry.registerAmbigToken(this.akey,""+this.partners[0].id,this.betterbase),this.lists[this.listpos]=[this.betterbase,[]];else if(0===this.clashes[1])this.captureStepToBase(),this.state.registry.registerAmbigToken(this.akey,""+this.partners[0].id,this.betterbase),this.lists[this.listpos]=[this.betterbase,this.nonpartners],this.nonpartners.length&&(this.initGivens=!0);else if(1===this.nonpartners.length)this.captureStepToBase(),this.state.registry.registerAmbigToken(this.akey,""+this.nonpartners[0].id,this.betterbase),this.lists[this.listpos]=[this.betterbase,this.partners];else if(this.clashes[1]<this.clashes[0])this.captureStepToBase(),this.lists[this.listpos]=[this.betterbase,this.partners],this.lists.push([this.betterbase,this.nonpartners]);else if(t&&(this.lists[this.listpos]=[this.betterbase,this.nonpartners],this.lists.push([this.betterbase,this.partners]),this.modeindex===this.modes.length-1)){for(var e=0,i=this.partners.length;e<i;e+=1)this.state.registry.registerAmbigToken(this.akey,""+this.partners[e].id,this.betterbase);this.lists[this.listpos]=[this.betterbase,[]]}},xt.Disambiguation.prototype.disExtraText=function(){var t=!1;if(0===this.clashes[1]&&this.nonpartners.length<2&&(t=!0),t||this.base.disambiguate&&this.state.tmp.disambiguate_count===this.state.tmp.disambiguate_maxMax){if(t||this.state.tmp.disambiguate_count===this.state.tmp.disambiguate_maxMax)if(t||this.modeindex===this.modes.length-1){var e=this.lists[this.listpos][0];for(i=0,s=this.lists[this.listpos][1].length;i<s;i+=1)this.state.tmp.taintedItemIDs[this.lists[this.listpos][1][i].id]=!0,this.state.registry.registerAmbigToken(this.akey,""+this.lists[this.listpos][1][i].id,e);this.lists[this.listpos]=[this.betterbase,[]]}else{this.modeindex=this.modes.length-1,(e=this.lists[this.listpos][0]).disambiguate=!0;for(i=0,s=this.lists[this.listpos][1].length;i<s;i+=1)this.state.tmp.taintedItemIDs[this.lists[this.listpos][1][i].id]=!0,this.state.registry.registerAmbigToken(this.akey,""+this.lists[this.listpos][1][i].id,e)}}else if(this.modeindex=0,this.base.disambiguate=this.state.tmp.disambiguate_count,this.betterbase.disambiguate=this.state.tmp.disambiguate_count,this.base.disambiguate)this.disNames();else{this.initGivens=!0,this.base.disambiguate=1;for(var i=0,s=this.lists[this.listpos][1].length;i<s;i+=1)this.state.tmp.taintedItemIDs[this.lists[this.listpos][1][i].id]=!0}},xt.Disambiguation.prototype.disYears=function(){var t;t=[];var e=this.lists[this.listpos][0];if(this.clashes[1])for(var i=0,s=this.state.registry.mylist.length;i<s;i+=1)for(var r=this.state.registry.mylist[i],n=0,a=this.lists[this.listpos][1].length;n<a;n+=1){var o;if((o=this.lists[this.listpos][1][n]).id==r){t.push(this.registry[o.id]);break}}t.sort(this.state.registry.sorter.compareKeys);for(var l=0,u=t.length;l<u;l+=1){e.year_suffix=""+l;var p=this.state.registry.registry[t[l].id].disambig;this.state.registry.registerAmbigToken(this.akey,""+t[l].id,e),xt.ambigConfigDiff(p,e)&&(this.state.tmp.taintedItemIDs[t[l].id]=!0)}this.lists[this.listpos]=[this.betterbase,[]]},xt.Disambiguation.prototype.incrementDisambig=function(){if(this.initGivens)return this.initGivens=!1;var t=!1,e=!0;if("disNames"===this.modes[this.modeindex]){e=!1,"number"!=typeof this.givensMax&&(e=!0);var i=!1;"number"!=typeof this.namesMax&&(i=!0),"number"==typeof this.givensMax&&(this.base.givens.length&&this.base.givens[this.gnameset][this.gname]<this.givensMax?this.base.givens[this.gnameset][this.gname]+=1:e=!0),"number"==typeof this.namesMax&&e&&(this.state.opt["disambiguate-add-names"]?(i=!1,this.gname<this.namesMax?(this.base.names[this.gnameset]+=1,this.gname+=1):i=!0):i=!0),"number"==typeof this.namesetsMax&&i&&this.gnameset<this.namesetsMax&&(this.gnameset+=1,this.base.names[this.gnameset]=1,this.gname=0),"number"==typeof this.namesetsMax&&-1!==this.namesetsMax&&this.gnameset!==this.namesetsMax||this.state.opt["disambiguate-add-names"]&&"number"==typeof this.namesMax&&this.gname!==this.namesMax||"number"==typeof this.givensMax&&void 0!==this.base.givens[this.gnameset]&&void 0!==this.base.givens[this.gnameset][this.gname]&&this.base.givens[this.gnameset][this.gname]!==this.givensMax||(t=!0)}else"disExtraText"===this.modes[this.modeindex]&&(this.base.disambiguate+=1,this.betterbase.disambiguate+=1);return t},xt.Disambiguation.prototype.initVars=function(t){var e,i,s;if(this.lists=[],this.base=!1,this.betterbase=!1,this.akey=t,this.maxNamesByItemId={},i=[],!(e=this.ambigcites[t])||!e.length)return!1;var r=this.state.retrieveItem(""+e[0]);if(this.getCiteData(r),this.base=xt.getAmbigConfig.call(this.state),e&&1<e.length){i.push([this.maxNamesByItemId[r.id],r]);for(var n=1,a=e.length;n<a;n+=1)r=this.state.retrieveItem(""+e[n]),this.getCiteData(r,this.base),i.push([this.maxNamesByItemId[r.id],r]);i.sort(function(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1].id>e[1].id?1:t[1].id<e[1].id?-1:0}),s=[];for(var n=0,a=i.length;n<a;n+=1)s.push(i[n][1]);this.lists.push([this.base,s]),this.Item=this.lists[0][1][0]}else this.Item=this.state.retrieveItem(""+e[0]);return this.modeindex=0,this.state.citation.opt["disambiguate-add-names"],this.namesMax=this.maxNamesByItemId[this.Item.id][0],this.padBase(this.base),this.padBase(this.betterbase),this.base.year_suffix=!1,this.base.disambiguate=!1,this.betterbase.year_suffix=!1,this.betterbase.disambiguate=!1,"by-cite"===this.state.citation.opt["givenname-disambiguation-rule"]&&this.state.opt["disambiguate-add-givenname"]&&(this.givensMax=2),!0},xt.Disambiguation.prototype.padBase=function(t){for(var e=0,i=t.names.length;e<i;e+=1){t.givens[e]||(t.givens[e]=[]);for(var s=0,r=t.names[e];s<r;s+=1)t.givens[e][s]||(t.givens[e][s]=0)}},xt.Disambiguation.prototype.configModes=function(){var t,e;this.modes=[],t=this.state.opt["disambiguate-add-givenname"],e=this.state.citation.opt["givenname-disambiguation-rule"],(this.state.opt["disambiguate-add-names"]||t&&"by-cite"===e)&&this.modes.push("disNames"),this.state.opt.has_disambiguate&&this.modes.push("disExtraText"),this.state.opt["disambiguate-add-year-suffix"]&&this.modes.push("disYears")},xt.Disambiguation.prototype.getCiteData=function(t,e){if(!this.maxNamesByItemId[t.id]){xt.getAmbiguousCite.call(this.state,t,e),e=xt.getAmbigConfig.call(this.state),this.maxNamesByItemId[t.id]=xt.getMaxVals.call(this.state),this.state.registry.registry[t.id].disambig.givens=this.state.tmp.disambig_settings.givens.slice();for(var i=0,s=this.state.registry.registry[t.id].disambig.givens.length;i<s;i+=1)this.state.registry.registry[t.id].disambig.givens[i]=this.state.tmp.disambig_settings.givens[i].slice();this.namesetsMax=this.state.registry.registry[t.id].disambig.names.length-1,this.base||(this.base=e,this.betterbase=xt.cloneAmbigConfig(e)),e.names.length<this.base.names.length&&(this.base=e);for(i=0,s=e.names.length;i<s;i+=1)e.names[i]>this.base.names[i]&&(this.base.givens[i]=e.givens[i].slice(),this.base.names[i]=e.names[i],this.betterbase.names=this.base.names.slice(),this.betterbase.givens=this.base.givens.slice(),this.padBase(this.base),this.padBase(this.betterbase));this.betterbase.givens=this.base.givens.slice();for(var r=0,n=this.base.givens.length;r<n;r+=1)this.betterbase.givens[r]=this.base.givens[r].slice()}},xt.Disambiguation.prototype.captureStepToBase=function(){"by-cite"===this.state.citation.opt["givenname-disambiguation-rule"]&&this.base.givens&&this.base.givens.length&&void 0!==this.base.givens[this.gnameset][this.gname]&&(this.betterbase.givens[this.gnameset][this.gname]=this.base.givens[this.gnameset][this.gname]),this.betterbase.names[this.gnameset]=this.base.names[this.gnameset]},(t.exports=xt).Engine.prototype.getJurisdictionList=function(t){for(var e=[],i=t.split(":"),s=i.length;0<s;s--)e.push(i.slice(0,s).join(":"));return-1===e.indexOf("us")&&e.push("us"),e},xt.Engine.prototype.retrieveAllStyleModules=function(t){for(var e={},i=this.locale[this.opt.lang].opts["jurisdiction-preference"],s=(i=[""].concat(i=i||[])).length-1;-1<s;s--)for(var r=i[s],n=0,a=t.length;n<a;n++){var o=t[n];if(!this.opt.jurisdictions_seen[o]){var l=this.sys.retrieveStyleModule(o,r);(!l&&!r||l)&&(this.opt.jurisdictions_seen[o]=!0),l&&(e[o]=l)}}return e},(t.exports=xt).ParticleList=[["'s",s=[[null,[0,1]]]],["'s-",s],["'t",s],["a",s],["aan 't",r=[[null,[0,2]]]],["aan de",r],["aan den",r],["aan der",r],["aan het",r],["aan t",r],["aan",s],["ad-",a=[[null,[0,1]],[[0,1],null]]],["adh-",a],["af",a],["al",a],["al-",a],["am de",r],["am",s],["an-",a],["ar-",a],["as-",a],["ash-",a],["at-",a],["ath-",a],["auf dem",u=[[[0,2],null],[null,[0,2]]]],["auf den",u],["auf der",u],["auf ter",r],["auf",l=[[[0,1],null],[null,[0,1]]]],["aus 'm",u],["aus dem",u],["aus den",u],["aus der",u],["aus m",u],["aus",l],["aus'm",u],["az-",a],["aš-",a],["aḍ-",a],["aḏ-",a],["aṣ-",a],["aṭ-",a],["aṯ-",a],["aẓ-",a],["ben",s],["bij 't",r],["bij de",r],["bij den",r],["bij het",r],["bij t",r],["bij",s],["bin",s],["boven d",r],["boven d'",r],["d",s],["d'",a],["da",a],["dal",s],["dal'",s],["dall'",s],["dalla",s],["das",a],["de die le",n=[[null,[0,3]]]],["de die",r],["de l",r],["de l'",r],["de la",p=[[null,[0,2]],[[0,1],[1,2]]]],["de las",p],["de le",r],["de li",o=[[null,[0,2]],[[0,2],null]]],["de van der",n],["de",a],["de'",a],["deca",s],["degli",a],["dei",a],["del",a],["dela",i=[[[0,1],null]]],["dell'",a],["della",a],["delle",a],["dello",a],["den",a],["der",a],["des",a],["di",a],["die le",r],["do",s],["don",s],["dos",a],["du",a],["ed-",a],["edh-",a],["el",a],["el-",a],["en-",a],["er-",a],["es-",a],["esh-",a],["et-",a],["eth-",a],["ez-",a],["eš-",a],["eḍ-",a],["eḏ-",a],["eṣ-",a],["eṭ-",a],["eṯ-",a],["eẓ-",a],["het",s],["i",s],["il",i],["im",s],["in 't",r],["in de",r],["in den",r],["in der",o],["in het",r],["in t",r],["in",s],["l",s],["l'",s],["la",s],["las",s],["le",s],["les",a],["lo",a],["los",s],["lou",s],["of",s],["onder 't",r],["onder de",r],["onder den",r],["onder het",r],["onder t",r],["onder",s],["op 't",r],["op de",o],["op den",r],["op der",r],["op gen",r],["op het",r],["op t",r],["op ten",r],["op",s],["over 't",r],["over de",r],["over den",r],["over het",r],["over t",r],["over",s],["s",s],["s'",s],["sen",i],["t",s],["te",s],["ten",s],["ter",s],["tho",s],["thoe",s],["thor",s],["to",s],["toe",s],["tot",s],["uijt 't",r],["uijt de",r],["uijt den",r],["uijt te de",n],["uijt ten",r],["uijt",s],["uit 't",r],["uit de",r],["uit den",r],["uit het",r],["uit t",r],["uit te de",n],["uit ten",r],["uit",s],["unter",s],["v",s],["v.",s],["v.d.",s],["van 't",r],["van de l",n],["van de l'",n],["van de",r],["van de",r],["van den",r],["van der",r],["van gen",r],["van het",r],["van la",r],["van t",r],["van ter",r],["van van de",n],["van",a],["vander",s],["vd",s],["ver",s],["vom und zum",[[[0,3],null]]],["vom",a],["von 't",r],["von dem",u],["von den",u],["von der",u],["von t",r],["von und zu",[[[0,3],null],[null,[0,3]]]],["von zu",u],["von",l],["voor 't",r],["voor de",r],["voor den",r],["voor in 't",n],["voor in t",n],["voor",s],["vor der",u],["vor",l],["z",i],["ze",i],["zu",l],["zum",a],["zur",a]],xt.parseParticles=function(){function p(t,e,i){var s=t;t=i?t.toLowerCase():t;var r,n,a=[];r=e?(t=t.split("").reverse().join(""),xt.PARTICLE_GIVEN_REGEXP):xt.PARTICLE_FAMILY_REGEXP;for(var o=t.match(r);o;){var l,u=e?o[1].split("").reverse().join(""):o[1];if(!(n=!!(l=!!(l=!!o&&u)&&u.replace(/^[-\'\u02bb\u2019\s]*(.).*$/,"$1"))&&l.toUpperCase()!==l))break;s=e?(a.push(s.slice(-1*u.length)),s.slice(0,-1*u.length)):(a.push(s.slice(0,u.length)),s.slice(u.length)),o=(t=o[2]).match(r)}if(e){t=t.split("").reverse().join(""),a.reverse();for(var p=1,h=a.length;p<h;p++)" "==a[p].slice(0,1)&&(a[p-1]+=" ");for(p=0,h=a.length;p<h;p++)" "==a[p].slice(0,1)&&(a[p]=a[p].slice(1));t=s.slice(0,t.length)}else t=s.slice(-1*t.length);return[n,t,a]}return function(t){(a=p(t.family))[0];var e=a[1],i=a[2];t.family=e;var s,r,n=(s=i.join(""),r=s.slice(-1),s=s.trim()," "===r&&-1<["'","’"].indexOf(s.slice(-1))&&(s+=" "),s);n&&(t["non-dropping-particle"]=n),function(t){if(!t.suffix&&t.given){var e=t.given.match(/(\s*,!*\s*)/);if(e){var i=t.given.indexOf(e[1]),s=t.given.slice(i+e[1].length),r=t.given.slice(i,i+e[1].length).replace(/\s*/g,"");"et al"!==s.replace(/\./g,"")||t["dropping-particle"]?(2===r.length&&(t["comma-suffix"]=!0),t.suffix=s):(t["dropping-particle"]=s,t["comma-dropping-particle"]=","),t.given=t.given.slice(0,i)}}}(t);(a=p(t.given,!0))[0];var a,o=a[1],l=a[2];t.given=o;var u=l.join("").trim();u&&(t["dropping-particle"]=u)}}(),t.exports=xt}),Te=(Ae.CSL,{f:Object.getOwnPropertySymbols}),Ne=Object.assign,Ee=!Ne||_(function(){var t={},e={},i=Symbol(),s="abcdefghijklmnopqrst";return t[i]=7,s.split("").forEach(function(t){e[t]=t}),7!=Ne({},t)[i]||Object.keys(Ne({},e)).join("")!=s})?function(t,e){for(var i=Lt(t),s=arguments.length,r=1,n=Te.f,a=c.f;r<s;)for(var o,l=f(arguments[r++]),u=n?at(l).concat(n(l)):at(l),p=u.length,h=0;h<p;)a.call(l,o=u[h++])&&(i[o]=l[o]);return i}:Ne;Y(Y.S+Y.F,"Object",{assign:Ee});var ke=function(){function t(t){var e=t.citationItems,i=t.properties,s=t.id,r=t.processor;this.value=null,this.processor=null,this.citationItems=e,this.properties=i||{},this.properties.noteIndex=this.properties.noteIndex||0,this.id=s,this.processor=r}var e=t.prototype;return e.rerender=function(){if(this.properties["in-narrative"]){var t=this.clone();t.properties["in-narrative"]=!1,t.citationItems=[{id:this.citationItems[0].id,"author-only":!0}];var e=this.processor.preview(t);t.citationItems=[Object.assign({},this.citationItems[0],{"suppress-author":!0})],this.value=[e,this.processor.preview(t)].join(" ").trim()}else this.value=this.processor.preview(this);return this},e.clone=function(){return new t({id:this.id,citationItems:this.citationItems,processor:this.processor,properties:Object.assign({},this.properties)})},t}(),we={f:Ct},Re=W.f,Le=function(t){var e=j.Symbol||(j.Symbol=d.Symbol||{});"_"==t.charAt(0)||t in e||Re(e,t,{value:we.f(t)})};Le("asyncIterator");var je=t(function(t){var i=U("meta"),e=W.f,s=0,r=Object.isExtensible||function(){return!0},n=!_(function(){return r(Object.preventExtensions({}))}),a=function(t){e(t,i,{value:{i:"O"+ ++s,w:{}}})},o=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!p(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!l(t,i)){if(!r(t))return"F";if(!e)return"E";a(t)}return t[i].i},getWeak:function(t,e){if(!l(t,i)){if(!r(t))return!0;if(!e)return!1;a(t)}return t[i].w},onFreeze:function(t){return n&&o.NEED&&r(t)&&!l(t,i)&&a(t),t}}}),Ce=(je.KEY,je.NEED,je.fastKey,je.getWeak,je.onFreeze,G.f),Pe={}.toString,De="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ue={f:function(t){return De&&"[object Window]"==Pe.call(t)?function(t){try{return Ce(t)}catch(t){return De.slice()}}(t):Ce(m(t))}},Me=je.KEY,Be=O.f,Xe=W.f,Fe=Ue.f,ze=d.Symbol,Ve=d.JSON,qe=Ve&&Ve.stringify,Ge="prototype",$e=Ct("_hidden"),We=Ct("toPrimitive"),Ke={}.propertyIsEnumerable,He=C("symbol-registry"),Qe=C("symbols"),Je=C("op-symbols"),Ye=Object[Ge],Ze="function"==typeof ze,ti=d.QObject,ei=!ti||!ti[Ge]||!ti[Ge].findChild,ii=s&&_(function(){return 7!=mt(Xe({},"a",{get:function(){return Xe(this,"a",{value:7}).a}})).a})?function(t,e,i){var s=Be(Ye,e);s&&delete Ye[e],Xe(t,e,i),s&&t!==Ye&&Xe(Ye,e,s)}:Xe,si=function(t){var e=Qe[t]=mt(ze[Ge]);return e._k=t,e},ri=Ze&&"symbol"==typeof ze.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof ze},ni=function(t,e,i){return t===Ye&&ni(Je,e,i),a(t),e=b(e,!0),a(i),l(Qe,e)?(i.enumerable?(l(t,$e)&&t[$e][e]&&(t[$e][e]=!1),i=mt(i,{enumerable:I(0,!1)})):(l(t,$e)||Xe(t,$e,I(1,{})),t[$e][e]=!0),ii(t,e,i)):Xe(t,e,i)},ai=function(t,e){a(t);for(var i,s=function(t){var e=at(t),i=Te.f;if(i)for(var s,r=i(t),n=c.f,a=0;r.length>a;)n.call(t,s=r[a++])&&e.push(s);return e}(e=m(e)),r=0,n=s.length;r<n;)ni(t,i=s[r++],e[i]);return t},oi=function(t){var e=Ke.call(this,t=b(t,!0));return!(this===Ye&&l(Qe,t)&&!l(Je,t))&&(!(e||!l(this,t)||!l(Qe,t)||l(this,$e)&&this[$e][t])||e)},li=function(t,e){if(t=m(t),e=b(e,!0),t!==Ye||!l(Qe,e)||l(Je,e)){var i=Be(t,e);return!i||!l(Qe,e)||l(t,$e)&&t[$e][e]||(i.enumerable=!0),i}},ui=function(t){for(var e,i=Fe(m(t)),s=[],r=0;i.length>r;)l(Qe,e=i[r++])||e==$e||e==Me||s.push(e);return s},pi=function(t){for(var e,i=t===Ye,s=Fe(i?Je:m(t)),r=[],n=0;s.length>n;)!l(Qe,e=s[n++])||i&&!l(Ye,e)||r.push(Qe[e]);return r};Ze||(H((ze=function(){if(this instanceof ze)throw TypeError("Symbol is not a constructor!");var e=U(0<arguments.length?arguments[0]:void 0),i=function(t){this===Ye&&i.call(Je,t),l(this,$e)&&l(this[$e],e)&&(this[$e][e]=!1),ii(this,e,I(1,t))};return s&&ei&&ii(Ye,e,{configurable:!0,set:i}),si(e)})[Ge],"toString",function(){return this._k}),O.f=li,W.f=ni,G.f=Ue.f=ui,c.f=oi,Te.f=pi,s&&H(Ye,"propertyIsEnumerable",oi,!0),we.f=function(t){return si(Ct(t))}),Y(Y.G+Y.W+Y.F*!Ze,{Symbol:ze});for(var hi="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ci=0;hi.length>ci;)Ct(hi[ci++]);for(var fi=at(Ct.store),mi=0;fi.length>mi;)Le(fi[mi++]);Y(Y.S+Y.F*!Ze,"Symbol",{for:function(t){return l(He,t+="")?He[t]:He[t]=ze(t)},keyFor:function(t){if(!ri(t))throw TypeError(t+" is not a symbol!");for(var e in He)if(He[e]===t)return e},useSetter:function(){ei=!0},useSimple:function(){ei=!1}}),Y(Y.S+Y.F*!Ze,"Object",{create:function(t,e){return void 0===e?mt(t):ai(mt(t),e)},defineProperty:ni,defineProperties:ai,getOwnPropertyDescriptor:li,getOwnPropertyNames:ui,getOwnPropertySymbols:pi}),Ve&&Y(Y.S+Y.F*(!Ze||_(function(){var t=ze();return"[null]"!=qe([t])||"{}"!=qe({a:t})||"{}"!=qe(Object(t))})),"JSON",{stringify:function(t){for(var e,i,s=[t],r=1;arguments.length>r;)s.push(arguments[r++]);if(i=e=s[1],(p(e)||void 0!==t)&&!ri(t))return jt(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!ri(e))return e}),s[1]=e,qe.apply(Ve,s)}}),ze[Ge][We]||K(ze[Ge],We,ze[Ge].valueOf),ie(ze,"Symbol"),ie(Math,"Math",!0),ie(d.JSON,"JSON",!0);Y(Y.P,"String",{repeat:function(t){var e=String(h(this)),i="",s=E(t);if(s<0||s==1/0)throw RangeError("Count can't be negative");for(;0<s;(s>>>=1)&&(e+=e))1&s&&(i+=e);return i}});var di=Ct("match"),gi=function(t){var e;return p(t)&&(void 0!==(e=t[di])?!!e:"RegExp"==o(t))},bi=Ct("match"),_i="startsWith",vi=""[_i];Y(Y.P+Y.F*function(e){var i=/./;try{"/./"[e](i)}catch(t){try{return i[bi]=!1,!"/./"[e](i)}catch(t){}}return!0}(_i),"String",{startsWith:function(t){var e=function(t,e,i){if(gi(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(h(t))}(this,t,_i),i=w(Math.min(1<arguments.length?arguments[1]:void 0,e.length)),s=String(t);return vi?vi.call(e,s,i):e.slice(i,i+s.length)===s}});var yi=function(e,t,i){var s=Ct(e),r=i(h,s,""[e]),n=r[0],a=r[1];_(function(){var t={};return t[s]=function(){return 7},7!=""[e](t)})&&(H(String.prototype,e,n),K(RegExp.prototype,s,2==t?function(t,e){return a.call(t,this,e)}:function(t){return a.call(t,this)}))};yi("match",1,function(s,r,t){return[function(t){var e=s(this),i=null==t?void 0:t[r];return void 0!==i?i.call(t,e):new RegExp(t)[r](String(e))},t]}),yi("split",2,function(r,n,a){var f=gi,m=a,d=[].push,t="split",g="length";if("c"=="abbc"[t](/(b)*/)[1]||4!="test"[t](/(?:)/,-1)[g]||2!="ab"[t](/(?:ab)*/)[g]||4!="."[t](/(.?)(.?)/)[g]||1<"."[t](/()()/)[g]||""[t](/.?/)[g]){var b=void 0===/()??/.exec("")[1];a=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!f(t))return m.call(i,t,e);var s,r,n,a,o,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,h=void 0===e?4294967295:e>>>0,c=new RegExp(t.source,u+"g");for(b||(s=new RegExp("^"+c.source+"$(?!\\s)",u));(r=c.exec(i))&&!(p<(n=r.index+r[0][g])&&(l.push(i.slice(p,r.index)),!b&&1<r[g]&&r[0].replace(s,function(){for(o=1;o<arguments[g]-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),1<r[g]&&r.index<i[g]&&d.apply(l,r.slice(1)),a=r[0][g],p=n,l[g]>=h));)c.lastIndex===r.index&&c.lastIndex++;return p===i[g]?!a&&c.test("")||l.push(""):l.push(i.slice(p)),l[g]>h?l.slice(0,h):l}}else"0"[t](void 0,0)[g]&&(a=function(t,e){return void 0===t&&0===e?[]:m.call(this,t,e)});return[function(t,e){var i=r(this),s=null==t?void 0:t[n];return void 0!==s?s.call(t,i,e):a.call(String(i),t,e)},a]});var xi=Symbol("title"),Ii=function(){function t(t){var e=t.title,i=void 0!==e&&e,s=t.processor;this.value=null,this.processor=null,this.ids=[],this.title=i,this.processor=s}return t.prototype.rerender=function(){var t=this.processor.makeBibliography(),e=t.start,i=t.data,s=t.end,r=t.ids;return this.ids=r,this.title&&(e+="html"===this.processor.format?function(t,e,i){var s,r=t.split(/(?=[#.])/);r[0].charAt(0).match(/[#.]/)?s="div":(s=r[0],r=r.slice(1));var n,a=[];r.forEach(function(t){return t.startsWith(".")?a.push(t.substr(1)):n=t.substr(1)});var o="<"+s+(n?' id="'+n+'"':"")+(a.length?' class="'+a.join(" ")+'"':"")+">",l="</"+s+">\n";return" ".repeat(i)+o+e+l}("h2.csl-bib-title",this.title,2):this.title+"\n\n"),this.value=[e].concat(i,[s]).join(""),this},Se(t,[{key:"title",get:function(){var t=this[xi];return t&&!0===t&&(t=this.processor.term({name:"reference",plural:1!==this.ids.length,capitalize:!0})),t},set:function(t){this[xi]=t}}]),t}();return function(){function t(t){var e=t.items,i=t.style,s=t.locale,r=t.format,n=void 0===r?"text":r;this.citations=[],this.noCites=[];var a={};e.forEach(function(t){return a[t.id]=t});var o={retrieveItem:function(t){return a[t]},retrieveLocale:function(){return s}};this.engine=new Ae.Engine(o,i),this.engine.opt.development_extensions.wrap_url_and_doi=!0,this.format=n}var e=t.prototype;return e.process=function(t){var i=this,e=t.clone(),s=this.engine.processCitationCluster(e,this.citations.map(function(t){return[t.id,t.properties.noteIndex]}),[]);return t.processor=this,t.id=e.citationID,this.citations.push(t),s[1].forEach(function(t){var e=t[0];return i.citations[e].rerender()}),t},e.preview=function(e){var t=this.citations.findIndex(function(t){return t.id===e.id}),i=this.citations.map(function(t){return[t.id,t.properties.noteIndex]}),s=e.clone();return this.engine.previewCitationCluster(s,i.slice(0,t),i.slice(t),this.format)},e.term=function(t){var e=t.name,i=t.plural,s=void 0!==i&&i,r=t.capitalize,n=void 0!==r&&r,a=this.engine.getTerm(e,null,Number(s));return n?a.charAt(0).toUpperCase()+a.substr(1):a},e.makeBibliography=function(){var t=this.engine.makeBibliography(),e=t[0],i=t[1];return{start:e.bibstart,data:i,end:e.bibend,ids:e.entry_ids}},e.cite=function(t){return this.process(new ke(t))},e.noCite=function(t){this.noCites=this.noCites.concat(t),this.engine.updateUncitedItems(t)},e.bibliography=function(t){var e=(void 0===t?{}:t).title;return new Ii({title:e,processor:this}).rerender()},Se(t,[{key:"format",get:function(){return this._format},set:function(t){this.engine.setOutputFormat(t),this._format=t}}]),t}()});
